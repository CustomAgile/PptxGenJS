{"version":3,"file":"pptxgen.gulp.js","sources":["../core-enums.ts","../gen-utils.ts","../gen-tables.ts","../gen-xml.ts","../gen-objects.ts","../slide.ts","../gen-charts.ts","../gen-media.ts","../pptxgen.ts"],"sourcesContent":["/**\n * PptxGenJS Enums\n * NOTE: `enum` wont work for objects, so use `Object.freeze`\n */\n\nimport { BorderProps } from './core-interfaces'\n\n// CONST\nexport const EMU: number = 914400 // One (1) inch (OfficeXML measures in EMU (English Metric Units))\nexport const ONEPT: number = 12700 // One (1) point (pt)\nexport const CRLF: string = '\\r\\n' // AKA: Chr(13) & Chr(10)\nexport const LAYOUT_IDX_SERIES_BASE: number = 2147483649\nexport const REGEX_HEX_COLOR: RegExp = /^[0-9a-fA-F]{6}$/\nexport const LINEH_MODIFIER = 1.67 // AKA: Golden Ratio Typography\n\nexport const DEF_BULLET_MARGIN = 27\nexport const DEF_CELL_BORDER: BorderProps = { type: 'solid', color: '666666', pt: 1 }\nexport const DEF_CELL_MARGIN_PT: [number, number, number, number] = [3, 3, 3, 3] // TRBL-style\nexport const DEF_CHART_GRIDLINE = { color: '888888', style: 'solid', size: 1 }\nexport const DEF_FONT_COLOR: string = '000000'\nexport const DEF_FONT_SIZE: number = 12\nexport const DEF_FONT_TITLE_SIZE: number = 18\nexport const DEF_PRES_LAYOUT = 'LAYOUT_16x9'\nexport const DEF_PRES_LAYOUT_NAME = 'DEFAULT'\nexport const DEF_SHAPE_LINE_COLOR = '333333'\nexport const DEF_SHAPE_SHADOW = { type: 'outer', blur: 3, offset: 23000 / 12700, angle: 90, color: '000000', opacity: 0.35, rotateWithShape: true }\nexport const DEF_SLIDE_BKGD = 'FFFFFF'\nexport const DEF_SLIDE_MARGIN_IN: [number, number, number, number] = [0.5, 0.5, 0.5, 0.5] // TRBL-style\nexport const DEF_TEXT_SHADOW = { type: 'outer', blur: 8, offset: 4, angle: 270, color: '000000', opacity: 0.75 }\nexport const DEF_TEXT_GLOW = { size: 8, color: 'FFFFFF', opacity: 0.75 }\n\nexport const AXIS_ID_VALUE_PRIMARY: string = '2094734552'\nexport const AXIS_ID_VALUE_SECONDARY: string = '2094734553'\nexport const AXIS_ID_CATEGORY_PRIMARY: string = '2094734554'\nexport const AXIS_ID_CATEGORY_SECONDARY: string = '2094734555'\nexport const AXIS_ID_SERIES_PRIMARY: string = '2094734556'\n\nexport type JSZIP_OUTPUT_TYPE = 'arraybuffer' | 'base64' | 'binarystring' | 'blob' | 'nodebuffer' | 'uint8array'\nexport type WRITE_OUTPUT_TYPE = JSZIP_OUTPUT_TYPE | 'STREAM'\nexport type CHART_NAME = 'area' | 'bar' | 'bar3D' | 'bubble' | 'doughnut' | 'line' | 'pie' | 'radar' | 'scatter'\nexport type SCHEME_COLORS = 'tx1' | 'tx2' | 'bg1' | 'bg2' | 'accent1' | 'accent2' | 'accent3' | 'accent4' | 'accent5' | 'accent6'\n\nexport const LETTERS: Array<string> = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('')\nexport const BARCHART_COLORS: Array<string> = [\n\t'C0504D',\n\t'4F81BD',\n\t'9BBB59',\n\t'8064A2',\n\t'4BACC6',\n\t'F79646',\n\t'628FC6',\n\t'C86360',\n\t'C0504D',\n\t'4F81BD',\n\t'9BBB59',\n\t'8064A2',\n\t'4BACC6',\n\t'F79646',\n\t'628FC6',\n\t'C86360',\n]\nexport const PIECHART_COLORS: Array<string> = [\n\t'5DA5DA',\n\t'FAA43A',\n\t'60BD68',\n\t'F17CB0',\n\t'B2912F',\n\t'B276B2',\n\t'DECF3F',\n\t'F15854',\n\t'A7A7A7',\n\t'5DA5DA',\n\t'FAA43A',\n\t'60BD68',\n\t'F17CB0',\n\t'B2912F',\n\t'B276B2',\n\t'DECF3F',\n\t'F15854',\n\t'A7A7A7',\n]\nexport enum TEXT_HALIGN {\n\t'left' = 'left',\n\t'center' = 'center',\n\t'right' = 'right',\n\t'justify' = 'justify',\n}\nexport enum TEXT_VALIGN {\n\t'b' = 'b',\n\t'ctr' = 'ctr',\n\t't' = 't',\n}\n\nexport const SLDNUMFLDID: string = '{F7021451-1387-4CA6-816F-3879F97B5CBC}'\n\n// ENUM\n// TODO: 3.5 or v4.0: rationalize ts-def exported enum names/case!\n// NOTE: First tsdef enum named correctly (shapes -> 'Shape', colors -> 'Color'), etc.\nexport enum OutputType {\n\t'arraybuffer' = 'arraybuffer',\n\t'base64' = 'base64',\n\t'binarystring' = 'binarystring',\n\t'blob' = 'blob',\n\t'nodebuffer' = 'nodebuffer',\n\t'uint8array' = 'uint8array',\n}\nexport enum ChartType {\n\t'area' = 'area',\n\t'bar' = 'bar',\n\t'bar3d' = 'bar3D',\n\t'bubble' = 'bubble',\n\t'doughnut' = 'doughnut',\n\t'line' = 'line',\n\t'pie' = 'pie',\n\t'radar' = 'radar',\n\t'scatter' = 'scatter',\n}\nexport enum ShapeType {\n\t'accentBorderCallout1' = 'accentBorderCallout1',\n\t'accentBorderCallout2' = 'accentBorderCallout2',\n\t'accentBorderCallout3' = 'accentBorderCallout3',\n\t'accentCallout1' = 'accentCallout1',\n\t'accentCallout2' = 'accentCallout2',\n\t'accentCallout3' = 'accentCallout3',\n\t'actionButtonBackPrevious' = 'actionButtonBackPrevious',\n\t'actionButtonBeginning' = 'actionButtonBeginning',\n\t'actionButtonBlank' = 'actionButtonBlank',\n\t'actionButtonDocument' = 'actionButtonDocument',\n\t'actionButtonEnd' = 'actionButtonEnd',\n\t'actionButtonForwardNext' = 'actionButtonForwardNext',\n\t'actionButtonHelp' = 'actionButtonHelp',\n\t'actionButtonHome' = 'actionButtonHome',\n\t'actionButtonInformation' = 'actionButtonInformation',\n\t'actionButtonMovie' = 'actionButtonMovie',\n\t'actionButtonReturn' = 'actionButtonReturn',\n\t'actionButtonSound' = 'actionButtonSound',\n\t'arc' = 'arc',\n\t'bentArrow' = 'bentArrow',\n\t'bentUpArrow' = 'bentUpArrow',\n\t'bevel' = 'bevel',\n\t'blockArc' = 'blockArc',\n\t'borderCallout1' = 'borderCallout1',\n\t'borderCallout2' = 'borderCallout2',\n\t'borderCallout3' = 'borderCallout3',\n\t'bracePair' = 'bracePair',\n\t'bracketPair' = 'bracketPair',\n\t'callout1' = 'callout1',\n\t'callout2' = 'callout2',\n\t'callout3' = 'callout3',\n\t'can' = 'can',\n\t'chartPlus' = 'chartPlus',\n\t'chartStar' = 'chartStar',\n\t'chartX' = 'chartX',\n\t'chevron' = 'chevron',\n\t'chord' = 'chord',\n\t'circularArrow' = 'circularArrow',\n\t'cloud' = 'cloud',\n\t'cloudCallout' = 'cloudCallout',\n\t'corner' = 'corner',\n\t'cornerTabs' = 'cornerTabs',\n\t'cube' = 'cube',\n\t'curvedDownArrow' = 'curvedDownArrow',\n\t'curvedLeftArrow' = 'curvedLeftArrow',\n\t'curvedRightArrow' = 'curvedRightArrow',\n\t'curvedUpArrow' = 'curvedUpArrow',\n\t'decagon' = 'decagon',\n\t'diagStripe' = 'diagStripe',\n\t'diamond' = 'diamond',\n\t'dodecagon' = 'dodecagon',\n\t'donut' = 'donut',\n\t'doubleWave' = 'doubleWave',\n\t'downArrow' = 'downArrow',\n\t'downArrowCallout' = 'downArrowCallout',\n\t'ellipse' = 'ellipse',\n\t'ellipseRibbon' = 'ellipseRibbon',\n\t'ellipseRibbon2' = 'ellipseRibbon2',\n\t'flowChartAlternateProcess' = 'flowChartAlternateProcess',\n\t'flowChartCollate' = 'flowChartCollate',\n\t'flowChartConnector' = 'flowChartConnector',\n\t'flowChartDecision' = 'flowChartDecision',\n\t'flowChartDelay' = 'flowChartDelay',\n\t'flowChartDisplay' = 'flowChartDisplay',\n\t'flowChartDocument' = 'flowChartDocument',\n\t'flowChartExtract' = 'flowChartExtract',\n\t'flowChartInputOutput' = 'flowChartInputOutput',\n\t'flowChartInternalStorage' = 'flowChartInternalStorage',\n\t'flowChartMagneticDisk' = 'flowChartMagneticDisk',\n\t'flowChartMagneticDrum' = 'flowChartMagneticDrum',\n\t'flowChartMagneticTape' = 'flowChartMagneticTape',\n\t'flowChartManualInput' = 'flowChartManualInput',\n\t'flowChartManualOperation' = 'flowChartManualOperation',\n\t'flowChartMerge' = 'flowChartMerge',\n\t'flowChartMultidocument' = 'flowChartMultidocument',\n\t'flowChartOfflineStorage' = 'flowChartOfflineStorage',\n\t'flowChartOffpageConnector' = 'flowChartOffpageConnector',\n\t'flowChartOnlineStorage' = 'flowChartOnlineStorage',\n\t'flowChartOr' = 'flowChartOr',\n\t'flowChartPredefinedProcess' = 'flowChartPredefinedProcess',\n\t'flowChartPreparation' = 'flowChartPreparation',\n\t'flowChartProcess' = 'flowChartProcess',\n\t'flowChartPunchedCard' = 'flowChartPunchedCard',\n\t'flowChartPunchedTape' = 'flowChartPunchedTape',\n\t'flowChartSort' = 'flowChartSort',\n\t'flowChartSummingJunction' = 'flowChartSummingJunction',\n\t'flowChartTerminator' = 'flowChartTerminator',\n\t'folderCorner' = 'folderCorner',\n\t'frame' = 'frame',\n\t'funnel' = 'funnel',\n\t'gear6' = 'gear6',\n\t'gear9' = 'gear9',\n\t'halfFrame' = 'halfFrame',\n\t'heart' = 'heart',\n\t'heptagon' = 'heptagon',\n\t'hexagon' = 'hexagon',\n\t'homePlate' = 'homePlate',\n\t'horizontalScroll' = 'horizontalScroll',\n\t'irregularSeal1' = 'irregularSeal1',\n\t'irregularSeal2' = 'irregularSeal2',\n\t'leftArrow' = 'leftArrow',\n\t'leftArrowCallout' = 'leftArrowCallout',\n\t'leftBrace' = 'leftBrace',\n\t'leftBracket' = 'leftBracket',\n\t'leftCircularArrow' = 'leftCircularArrow',\n\t'leftRightArrow' = 'leftRightArrow',\n\t'leftRightArrowCallout' = 'leftRightArrowCallout',\n\t'leftRightCircularArrow' = 'leftRightCircularArrow',\n\t'leftRightRibbon' = 'leftRightRibbon',\n\t'leftRightUpArrow' = 'leftRightUpArrow',\n\t'leftUpArrow' = 'leftUpArrow',\n\t'lightningBolt' = 'lightningBolt',\n\t'line' = 'line',\n\t'lineInv' = 'lineInv',\n\t'mathDivide' = 'mathDivide',\n\t'mathEqual' = 'mathEqual',\n\t'mathMinus' = 'mathMinus',\n\t'mathMultiply' = 'mathMultiply',\n\t'mathNotEqual' = 'mathNotEqual',\n\t'mathPlus' = 'mathPlus',\n\t'moon' = 'moon',\n\t'nonIsoscelesTrapezoid' = 'nonIsoscelesTrapezoid',\n\t'noSmoking' = 'noSmoking',\n\t'notchedRightArrow' = 'notchedRightArrow',\n\t'octagon' = 'octagon',\n\t'parallelogram' = 'parallelogram',\n\t'pentagon' = 'pentagon',\n\t'pie' = 'pie',\n\t'pieWedge' = 'pieWedge',\n\t'plaque' = 'plaque',\n\t'plaqueTabs' = 'plaqueTabs',\n\t'plus' = 'plus',\n\t'quadArrow' = 'quadArrow',\n\t'quadArrowCallout' = 'quadArrowCallout',\n\t'rect' = 'rect',\n\t'ribbon' = 'ribbon',\n\t'ribbon2' = 'ribbon2',\n\t'rightArrow' = 'rightArrow',\n\t'rightArrowCallout' = 'rightArrowCallout',\n\t'rightBrace' = 'rightBrace',\n\t'rightBracket' = 'rightBracket',\n\t'round1Rect' = 'round1Rect',\n\t'round2DiagRect' = 'round2DiagRect',\n\t'round2SameRect' = 'round2SameRect',\n\t'roundRect' = 'roundRect',\n\t'rtTriangle' = 'rtTriangle',\n\t'smileyFace' = 'smileyFace',\n\t'snip1Rect' = 'snip1Rect',\n\t'snip2DiagRect' = 'snip2DiagRect',\n\t'snip2SameRect' = 'snip2SameRect',\n\t'snipRoundRect' = 'snipRoundRect',\n\t'squareTabs' = 'squareTabs',\n\t'star10' = 'star10',\n\t'star12' = 'star12',\n\t'star16' = 'star16',\n\t'star24' = 'star24',\n\t'star32' = 'star32',\n\t'star4' = 'star4',\n\t'star5' = 'star5',\n\t'star6' = 'star6',\n\t'star7' = 'star7',\n\t'star8' = 'star8',\n\t'stripedRightArrow' = 'stripedRightArrow',\n\t'sun' = 'sun',\n\t'swooshArrow' = 'swooshArrow',\n\t'teardrop' = 'teardrop',\n\t'trapezoid' = 'trapezoid',\n\t'triangle' = 'triangle',\n\t'upArrow' = 'upArrow',\n\t'upArrowCallout' = 'upArrowCallout',\n\t'upDownArrow' = 'upDownArrow',\n\t'upDownArrowCallout' = 'upDownArrowCallout',\n\t'uturnArrow' = 'uturnArrow',\n\t'verticalScroll' = 'verticalScroll',\n\t'wave' = 'wave',\n\t'wedgeEllipseCallout' = 'wedgeEllipseCallout',\n\t'wedgeRectCallout' = 'wedgeRectCallout',\n\t'wedgeRoundRectCallout' = 'wedgeRoundRectCallout',\n}\nexport enum SchemeColor {\n\t'text1' = 'tx1',\n\t'text2' = 'tx2',\n\t'background1' = 'bg1',\n\t'background2' = 'bg2',\n\t'accent1' = 'accent1',\n\t'accent2' = 'accent2',\n\t'accent3' = 'accent3',\n\t'accent4' = 'accent4',\n\t'accent5' = 'accent5',\n\t'accent6' = 'accent6',\n}\nexport enum AlignH {\n\t'left' = 'left',\n\t'center' = 'center',\n\t'right' = 'right',\n\t'justify' = 'justify',\n}\nexport enum AlignV {\n\t'top' = 'top',\n\t'middle' = 'middle',\n\t'bottom' = 'bottom',\n}\n\nexport enum SHAPE_TYPE {\n\tACTION_BUTTON_BACK_OR_PREVIOUS = 'actionButtonBackPrevious',\n\tACTION_BUTTON_BEGINNING = 'actionButtonBeginning',\n\tACTION_BUTTON_CUSTOM = 'actionButtonBlank',\n\tACTION_BUTTON_DOCUMENT = 'actionButtonDocument',\n\tACTION_BUTTON_END = 'actionButtonEnd',\n\tACTION_BUTTON_FORWARD_OR_NEXT = 'actionButtonForwardNext',\n\tACTION_BUTTON_HELP = 'actionButtonHelp',\n\tACTION_BUTTON_HOME = 'actionButtonHome',\n\tACTION_BUTTON_INFORMATION = 'actionButtonInformation',\n\tACTION_BUTTON_MOVIE = 'actionButtonMovie',\n\tACTION_BUTTON_RETURN = 'actionButtonReturn',\n\tACTION_BUTTON_SOUND = 'actionButtonSound',\n\tARC = 'arc',\n\tBALLOON = 'wedgeRoundRectCallout',\n\tBENT_ARROW = 'bentArrow',\n\tBENT_UP_ARROW = 'bentUpArrow',\n\tBEVEL = 'bevel',\n\tBLOCK_ARC = 'blockArc',\n\tCAN = 'can',\n\tCHART_PLUS = 'chartPlus',\n\tCHART_STAR = 'chartStar',\n\tCHART_X = 'chartX',\n\tCHEVRON = 'chevron',\n\tCHORD = 'chord',\n\tCIRCULAR_ARROW = 'circularArrow',\n\tCLOUD = 'cloud',\n\tCLOUD_CALLOUT = 'cloudCallout',\n\tCORNER = 'corner',\n\tCORNER_TABS = 'cornerTabs',\n\tCROSS = 'plus',\n\tCUBE = 'cube',\n\tCURVED_DOWN_ARROW = 'curvedDownArrow',\n\tCURVED_DOWN_RIBBON = 'ellipseRibbon',\n\tCURVED_LEFT_ARROW = 'curvedLeftArrow',\n\tCURVED_RIGHT_ARROW = 'curvedRightArrow',\n\tCURVED_UP_ARROW = 'curvedUpArrow',\n\tCURVED_UP_RIBBON = 'ellipseRibbon2',\n\tDECAGON = 'decagon',\n\tDIAGONAL_STRIPE = 'diagStripe',\n\tDIAMOND = 'diamond',\n\tDODECAGON = 'dodecagon',\n\tDONUT = 'donut',\n\tDOUBLE_BRACE = 'bracePair',\n\tDOUBLE_BRACKET = 'bracketPair',\n\tDOUBLE_WAVE = 'doubleWave',\n\tDOWN_ARROW = 'downArrow',\n\tDOWN_ARROW_CALLOUT = 'downArrowCallout',\n\tDOWN_RIBBON = 'ribbon',\n\tEXPLOSION1 = 'irregularSeal1',\n\tEXPLOSION2 = 'irregularSeal2',\n\tFLOWCHART_ALTERNATE_PROCESS = 'flowChartAlternateProcess',\n\tFLOWCHART_CARD = 'flowChartPunchedCard',\n\tFLOWCHART_COLLATE = 'flowChartCollate',\n\tFLOWCHART_CONNECTOR = 'flowChartConnector',\n\tFLOWCHART_DATA = 'flowChartInputOutput',\n\tFLOWCHART_DECISION = 'flowChartDecision',\n\tFLOWCHART_DELAY = 'flowChartDelay',\n\tFLOWCHART_DIRECT_ACCESS_STORAGE = 'flowChartMagneticDrum',\n\tFLOWCHART_DISPLAY = 'flowChartDisplay',\n\tFLOWCHART_DOCUMENT = 'flowChartDocument',\n\tFLOWCHART_EXTRACT = 'flowChartExtract',\n\tFLOWCHART_INTERNAL_STORAGE = 'flowChartInternalStorage',\n\tFLOWCHART_MAGNETIC_DISK = 'flowChartMagneticDisk',\n\tFLOWCHART_MANUAL_INPUT = 'flowChartManualInput',\n\tFLOWCHART_MANUAL_OPERATION = 'flowChartManualOperation',\n\tFLOWCHART_MERGE = 'flowChartMerge',\n\tFLOWCHART_MULTIDOCUMENT = 'flowChartMultidocument',\n\tFLOWCHART_OFFLINE_STORAGE = 'flowChartOfflineStorage',\n\tFLOWCHART_OFFPAGE_CONNECTOR = 'flowChartOffpageConnector',\n\tFLOWCHART_OR = 'flowChartOr',\n\tFLOWCHART_PREDEFINED_PROCESS = 'flowChartPredefinedProcess',\n\tFLOWCHART_PREPARATION = 'flowChartPreparation',\n\tFLOWCHART_PROCESS = 'flowChartProcess',\n\tFLOWCHART_PUNCHED_TAPE = 'flowChartPunchedTape',\n\tFLOWCHART_SEQUENTIAL_ACCESS_STORAGE = 'flowChartMagneticTape',\n\tFLOWCHART_SORT = 'flowChartSort',\n\tFLOWCHART_STORED_DATA = 'flowChartOnlineStorage',\n\tFLOWCHART_SUMMING_JUNCTION = 'flowChartSummingJunction',\n\tFLOWCHART_TERMINATOR = 'flowChartTerminator',\n\tFOLDED_CORNER = 'folderCorner',\n\tFRAME = 'frame',\n\tFUNNEL = 'funnel',\n\tGEAR_6 = 'gear6',\n\tGEAR_9 = 'gear9',\n\tHALF_FRAME = 'halfFrame',\n\tHEART = 'heart',\n\tHEPTAGON = 'heptagon',\n\tHEXAGON = 'hexagon',\n\tHORIZONTAL_SCROLL = 'horizontalScroll',\n\tISOSCELES_TRIANGLE = 'triangle',\n\tLEFT_ARROW = 'leftArrow',\n\tLEFT_ARROW_CALLOUT = 'leftArrowCallout',\n\tLEFT_BRACE = 'leftBrace',\n\tLEFT_BRACKET = 'leftBracket',\n\tLEFT_CIRCULAR_ARROW = 'leftCircularArrow',\n\tLEFT_RIGHT_ARROW = 'leftRightArrow',\n\tLEFT_RIGHT_ARROW_CALLOUT = 'leftRightArrowCallout',\n\tLEFT_RIGHT_CIRCULAR_ARROW = 'leftRightCircularArrow',\n\tLEFT_RIGHT_RIBBON = 'leftRightRibbon',\n\tLEFT_RIGHT_UP_ARROW = 'leftRightUpArrow',\n\tLEFT_UP_ARROW = 'leftUpArrow',\n\tLIGHTNING_BOLT = 'lightningBolt',\n\tLINE_CALLOUT_1 = 'borderCallout1',\n\tLINE_CALLOUT_1_ACCENT_BAR = 'accentCallout1',\n\tLINE_CALLOUT_1_BORDER_AND_ACCENT_BAR = 'accentBorderCallout1',\n\tLINE_CALLOUT_1_NO_BORDER = 'callout1',\n\tLINE_CALLOUT_2 = 'borderCallout2',\n\tLINE_CALLOUT_2_ACCENT_BAR = 'accentCallout2',\n\tLINE_CALLOUT_2_BORDER_AND_ACCENT_BAR = 'accentBorderCallout2',\n\tLINE_CALLOUT_2_NO_BORDER = 'callout2',\n\tLINE_CALLOUT_3 = 'borderCallout3',\n\tLINE_CALLOUT_3_ACCENT_BAR = 'accentCallout3',\n\tLINE_CALLOUT_3_BORDER_AND_ACCENT_BAR = 'accentBorderCallout3',\n\tLINE_CALLOUT_3_NO_BORDER = 'callout3',\n\tLINE_CALLOUT_4 = 'borderCallout3',\n\tLINE_CALLOUT_4_ACCENT_BAR = 'accentCallout3',\n\tLINE_CALLOUT_4_BORDER_AND_ACCENT_BAR = 'accentBorderCallout3',\n\tLINE_CALLOUT_4_NO_BORDER = 'callout3',\n\tLINE = 'line',\n\tLINE_INVERSE = 'lineInv',\n\tMATH_DIVIDE = 'mathDivide',\n\tMATH_EQUAL = 'mathEqual',\n\tMATH_MINUS = 'mathMinus',\n\tMATH_MULTIPLY = 'mathMultiply',\n\tMATH_NOT_EQUAL = 'mathNotEqual',\n\tMATH_PLUS = 'mathPlus',\n\tMOON = 'moon',\n\tNON_ISOSCELES_TRAPEZOID = 'nonIsoscelesTrapezoid',\n\tNOTCHED_RIGHT_ARROW = 'notchedRightArrow',\n\tNO_SYMBOL = 'noSmoking',\n\tOCTAGON = 'octagon',\n\tOVAL = 'ellipse',\n\tOVAL_CALLOUT = 'wedgeEllipseCallout',\n\tPARALLELOGRAM = 'parallelogram',\n\tPENTAGON = 'homePlate',\n\tPIE = 'pie',\n\tPIE_WEDGE = 'pieWedge',\n\tPLAQUE = 'plaque',\n\tPLAQUE_TABS = 'plaqueTabs',\n\tQUAD_ARROW = 'quadArrow',\n\tQUAD_ARROW_CALLOUT = 'quadArrowCallout',\n\tRECTANGLE = 'rect',\n\tRECTANGULAR_CALLOUT = 'wedgeRectCallout',\n\tREGULAR_PENTAGON = 'pentagon',\n\tRIGHT_ARROW = 'rightArrow',\n\tRIGHT_ARROW_CALLOUT = 'rightArrowCallout',\n\tRIGHT_BRACE = 'rightBrace',\n\tRIGHT_BRACKET = 'rightBracket',\n\tRIGHT_TRIANGLE = 'rtTriangle',\n\tROUNDED_RECTANGLE = 'roundRect',\n\tROUNDED_RECTANGULAR_CALLOUT = 'wedgeRoundRectCallout',\n\tROUND_1_RECTANGLE = 'round1Rect',\n\tROUND_2_DIAG_RECTANGLE = 'round2DiagRect',\n\tROUND_2_SAME_RECTANGLE = 'round2SameRect',\n\tSMILEY_FACE = 'smileyFace',\n\tSNIP_1_RECTANGLE = 'snip1Rect',\n\tSNIP_2_DIAG_RECTANGLE = 'snip2DiagRect',\n\tSNIP_2_SAME_RECTANGLE = 'snip2SameRect',\n\tSNIP_ROUND_RECTANGLE = 'snipRoundRect',\n\tSQUARE_TABS = 'squareTabs',\n\tSTAR_10_POINT = 'star10',\n\tSTAR_12_POINT = 'star12',\n\tSTAR_16_POINT = 'star16',\n\tSTAR_24_POINT = 'star24',\n\tSTAR_32_POINT = 'star32',\n\tSTAR_4_POINT = 'star4',\n\tSTAR_5_POINT = 'star5',\n\tSTAR_6_POINT = 'star6',\n\tSTAR_7_POINT = 'star7',\n\tSTAR_8_POINT = 'star8',\n\tSTRIPED_RIGHT_ARROW = 'stripedRightArrow',\n\tSUN = 'sun',\n\tSWOOSH_ARROW = 'swooshArrow',\n\tTEAR = 'teardrop',\n\tTRAPEZOID = 'trapezoid',\n\tUP_ARROW = 'upArrow',\n\tUP_ARROW_CALLOUT = 'upArrowCallout',\n\tUP_DOWN_ARROW = 'upDownArrow',\n\tUP_DOWN_ARROW_CALLOUT = 'upDownArrowCallout',\n\tUP_RIBBON = 'ribbon2',\n\tU_TURN_ARROW = 'uturnArrow',\n\tVERTICAL_SCROLL = 'verticalScroll',\n\tWAVE = 'wave',\n}\nexport type SHAPE_NAME =\n\t| 'actionButtonBackPrevious'\n\t| 'actionButtonBeginning'\n\t| 'actionButtonBlank'\n\t| 'actionButtonDocument'\n\t| 'actionButtonEnd'\n\t| 'actionButtonForwardNext'\n\t| 'actionButtonHelp'\n\t| 'actionButtonHome'\n\t| 'actionButtonInformation'\n\t| 'actionButtonMovie'\n\t| 'actionButtonReturn'\n\t| 'actionButtonSound'\n\t| 'arc'\n\t| 'wedgeRoundRectCallout'\n\t| 'bentArrow'\n\t| 'bentUpArrow'\n\t| 'bevel'\n\t| 'blockArc'\n\t| 'can'\n\t| 'chartPlus'\n\t| 'chartStar'\n\t| 'chartX'\n\t| 'chevron'\n\t| 'chord'\n\t| 'circularArrow'\n\t| 'cloud'\n\t| 'cloudCallout'\n\t| 'corner'\n\t| 'cornerTabs'\n\t| 'plus'\n\t| 'cube'\n\t| 'curvedDownArrow'\n\t| 'ellipseRibbon'\n\t| 'curvedLeftArrow'\n\t| 'curvedRightArrow'\n\t| 'curvedUpArrow'\n\t| 'ellipseRibbon2'\n\t| 'decagon'\n\t| 'diagStripe'\n\t| 'diamond'\n\t| 'dodecagon'\n\t| 'donut'\n\t| 'bracePair'\n\t| 'bracketPair'\n\t| 'doubleWave'\n\t| 'downArrow'\n\t| 'downArrowCallout'\n\t| 'ribbon'\n\t| 'irregularSeal1'\n\t| 'irregularSeal2'\n\t| 'flowChartAlternateProcess'\n\t| 'flowChartPunchedCard'\n\t| 'flowChartCollate'\n\t| 'flowChartConnector'\n\t| 'flowChartInputOutput'\n\t| 'flowChartDecision'\n\t| 'flowChartDelay'\n\t| 'flowChartMagneticDrum'\n\t| 'flowChartDisplay'\n\t| 'flowChartDocument'\n\t| 'flowChartExtract'\n\t| 'flowChartInternalStorage'\n\t| 'flowChartMagneticDisk'\n\t| 'flowChartManualInput'\n\t| 'flowChartManualOperation'\n\t| 'flowChartMerge'\n\t| 'flowChartMultidocument'\n\t| 'flowChartOfflineStorage'\n\t| 'flowChartOffpageConnector'\n\t| 'flowChartOr'\n\t| 'flowChartPredefinedProcess'\n\t| 'flowChartPreparation'\n\t| 'flowChartProcess'\n\t| 'flowChartPunchedTape'\n\t| 'flowChartMagneticTape'\n\t| 'flowChartSort'\n\t| 'flowChartOnlineStorage'\n\t| 'flowChartSummingJunction'\n\t| 'flowChartTerminator'\n\t| 'folderCorner'\n\t| 'frame'\n\t| 'funnel'\n\t| 'gear6'\n\t| 'gear9'\n\t| 'halfFrame'\n\t| 'heart'\n\t| 'heptagon'\n\t| 'hexagon'\n\t| 'horizontalScroll'\n\t| 'triangle'\n\t| 'leftArrow'\n\t| 'leftArrowCallout'\n\t| 'leftBrace'\n\t| 'leftBracket'\n\t| 'leftCircularArrow'\n\t| 'leftRightArrow'\n\t| 'leftRightArrowCallout'\n\t| 'leftRightCircularArrow'\n\t| 'leftRightRibbon'\n\t| 'leftRightUpArrow'\n\t| 'leftUpArrow'\n\t| 'lightningBolt'\n\t| 'borderCallout1'\n\t| 'accentCallout1'\n\t| 'accentBorderCallout1'\n\t| 'callout1'\n\t| 'borderCallout2'\n\t| 'accentCallout2'\n\t| 'accentBorderCallout2'\n\t| 'callout2'\n\t| 'borderCallout3'\n\t| 'accentCallout3'\n\t| 'accentBorderCallout3'\n\t| 'callout3'\n\t| 'borderCallout3'\n\t| 'accentCallout3'\n\t| 'accentBorderCallout3'\n\t| 'callout3'\n\t| 'line'\n\t| 'lineInv'\n\t| 'mathDivide'\n\t| 'mathEqual'\n\t| 'mathMinus'\n\t| 'mathMultiply'\n\t| 'mathNotEqual'\n\t| 'mathPlus'\n\t| 'moon'\n\t| 'nonIsoscelesTrapezoid'\n\t| 'notchedRightArrow'\n\t| 'noSmoking'\n\t| 'octagon'\n\t| 'ellipse'\n\t| 'wedgeEllipseCallout'\n\t| 'parallelogram'\n\t| 'homePlate'\n\t| 'pie'\n\t| 'pieWedge'\n\t| 'plaque'\n\t| 'plaqueTabs'\n\t| 'quadArrow'\n\t| 'quadArrowCallout'\n\t| 'rect'\n\t| 'wedgeRectCallout'\n\t| 'pentagon'\n\t| 'rightArrow'\n\t| 'rightArrowCallout'\n\t| 'rightBrace'\n\t| 'rightBracket'\n\t| 'rtTriangle'\n\t| 'roundRect'\n\t| 'wedgeRoundRectCallout'\n\t| 'round1Rect'\n\t| 'round2DiagRect'\n\t| 'round2SameRect'\n\t| 'smileyFace'\n\t| 'snip1Rect'\n\t| 'snip2DiagRect'\n\t| 'snip2SameRect'\n\t| 'snipRoundRect'\n\t| 'squareTabs'\n\t| 'star10'\n\t| 'star12'\n\t| 'star16'\n\t| 'star24'\n\t| 'star32'\n\t| 'star4'\n\t| 'star5'\n\t| 'star6'\n\t| 'star7'\n\t| 'star8'\n\t| 'stripedRightArrow'\n\t| 'sun'\n\t| 'swooshArrow'\n\t| 'teardrop'\n\t| 'trapezoid'\n\t| 'upArrow'\n\t| 'upArrowCallout'\n\t| 'upDownArrow'\n\t| 'upDownArrowCallout'\n\t| 'ribbon2'\n\t| 'uturnArrow'\n\t| 'verticalScroll'\n\t| 'wave'\n\nexport enum CHART_TYPE {\n\t'AREA' = 'area',\n\t'BAR' = 'bar',\n\t'BAR3D' = 'bar3D',\n\t'BUBBLE' = 'bubble',\n\t'DOUGHNUT' = 'doughnut',\n\t'LINE' = 'line',\n\t'PIE' = 'pie',\n\t'RADAR' = 'radar',\n\t'SCATTER' = 'scatter',\n}\n\nexport enum SCHEME_COLOR_NAMES {\n\t'TEXT1' = 'tx1',\n\t'TEXT2' = 'tx2',\n\t'BACKGROUND1' = 'bg1',\n\t'BACKGROUND2' = 'bg2',\n\t'ACCENT1' = 'accent1',\n\t'ACCENT2' = 'accent2',\n\t'ACCENT3' = 'accent3',\n\t'ACCENT4' = 'accent4',\n\t'ACCENT5' = 'accent5',\n\t'ACCENT6' = 'accent6',\n}\n\nexport enum MASTER_OBJECTS {\n\t'chart' = 'chart',\n\t'image' = 'image',\n\t'line' = 'line',\n\t'rect' = 'rect',\n\t'text' = 'text',\n\t'placeholder' = 'placeholder',\n}\n\nexport enum SLIDE_OBJECT_TYPES {\n\t'chart' = 'chart',\n\t'hyperlink' = 'hyperlink',\n\t'image' = 'image',\n\t'media' = 'media',\n\t'online' = 'online',\n\t'placeholder' = 'placeholder',\n\t'table' = 'table',\n\t'tablecell' = 'tablecell',\n\t'text' = 'text',\n\t'notes' = 'notes',\n}\nexport enum PLACEHOLDER_TYPES {\n\t'title' = 'title',\n\t'body' = 'body',\n\t'image' = 'pic',\n\t'chart' = 'chart',\n\t'table' = 'tbl',\n\t'media' = 'media',\n}\n\n/**\n * NOTE: 20170304: BULLET_TYPES: Only default is used so far. I'd like to combine the two pieces of code that use these before implementing these as options\n * Since we close <p> within the text object bullets, its slightly more difficult than combining into a func and calling to get the paraProp\n * and i'm not sure if anyone will even use these... so, skipping for now.\n */\nexport enum BULLET_TYPES {\n\t'DEFAULT' = '&#x2022;',\n\t'CHECK' = '&#x2713;',\n\t'STAR' = '&#x2605;',\n\t'TRIANGLE' = '&#x25B6;',\n}\n\n// IMAGES (base64)\nexport const IMG_BROKEN =\n\t'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAB3CAYAAAD1oOVhAAAGAUlEQVR4Xu2dT0xcRRzHf7tAYSsc0EBSIq2xEg8mtTGebVzEqOVIolz0siRE4gGTStqKwdpWsXoyGhMuyAVJOHBgqyvLNgonDkabeCBYW/8kTUr0wsJC+Wfm0bfuvn37Znbem9mR9303mJnf/Pb7ed95M7PDI5JIJPYJV5EC7e3t1N/fT62trdqViQCIu+bVgpIHEo/Hqbe3V/sdYVKHyWSSZmZm8ilVA0oeyNjYmEnaVC2Xvr6+qg5fAOJAz4DU1dURGzFSqZRVqtMpAFIGyMjICC0vL9PExIRWKADiAYTNshYWFrRCARAOEFZcCKWtrY0GBgaUTYkBRACIE4rKZwqACALR5RQAqQCIDqcASIVAVDsFQCSAqHQKgEgCUeUUAPEBRIVTAMQnEBvK5OQkbW9vk991CoAEAMQJxc86BUACAhKUUwAkQCBBOAVAAgbi1ykAogCIH6cAiCIgsk4BEIVAZJwCIIqBVLqiBxANQFgXS0tLND4+zl08AogmIG5OSSQS1gGKwgtANAIRcQqAaAbCe6YASBWA2E6xDyeyDUl7+AKQMkDYYevm5mZHabA/Li4uUiaTsYLau8QA4gLE/hU7wajyYtv1hReDAiAOxQcHBymbzark4BkbQKom/X8dp9Npmpqasn4BIAYAYSnYp+4BBEAMUcCwNOCQsAKZnp62NtQOw8WmwT09PUo+ijaHsOMx7GppaaH6+nolH0Z10K2tLVpdXbW6UfV3mNqBdHd3U1NTk2rtlMRfW1uj2dlZAFGirkRQAJEQTWUTAFGprkRsAJEQTWUTAFGprkRsAJEQTWUTAFGprkRsAJEQTWUTAFGprkRsAJEQTWUTAFGprkRsAJEQTWUTAGHqrm8caPzQ0WC1logbeiC7X3xJm0PvUmRzh45cuki1588FAmVn9BO6P3yF9utrqGH0MtW82S8UN9RA9v/4k7InjhcJFTs/TLVXLwmJV67S7vD7tHF5pKi46fYdosdOcOOGG8j1OcqefbFEJD9Q3GCwDhqT31HklS4A8VRgfYM2Op6k3bt/BQJl58J7lPvwg5JYNccepaMry0LPqFA7hCm39+NNyp2J0172b19QysGINj5CsRtpij57musOViH0QPJQXn6J9u7dlYJSFkbrMYolrwvDAJAC+WWdEpQz7FTgECeUCpzi6YxvvqXoM6eEhqnCSgDikEzUKUE7Aw7xuHctKB5OYU3dZlNR9syQdAaAcAYTC0pXF+39c09o2Ik+3EqxVKqiB7hbYAxZkk4pbBaEM+AQofv+wTrFwylBOQNABIGwavdfe4O2pg5elO+86l99nY58/VUF0byrYsjiSFluNlXYrOHcBar7+EogUADEQ0YRGHbzoKAASBkg2+9cpM1rV0tK2QOcXW7bLEFAARAXIF4w2DrDWoeUWaf4hQIgDiA8GPZ2iNfi0Q8UACkAIgrDbrJ385eDxaPLLrEsFAB5oG6lMPJQPLZZZKAACBGVhcG2Q+bmuLu2nk55e4jqPv1IeEoceiBeX7s2zCa5MAqdstl91vfXwaEGsv/rb5TtOFk6tWXOuJGh6KmnhO9sayrMninPx103JBtXblHkice58cINZP4Hyr5wpkgkdiChEmc4FWazLzenNKa/p0jncwDiqcD6BuWePk07t1asatZGoYQzSqA4nFJ7soNiP/+EUyfc25GI2GG53dHPrKo1g/1Cw4pIXLrzO+1c+/wg7tBbFDle/EbQcjFCPWQJCau5EoBoFpzXHYDwFNJcDiCaBed1ByA8hTSXA4hmwXndAQhPIc3lAKJZcF53AMJTSHM5gGgWnNcdgPAU0lwOIJoF53UHIDyFNJcfSiCdnZ0Ui8U0SxlMd7lcjubn561gh+Y1scFIU/0o/3sgeLO12E2k7UXKYumgFoAYdg8ACIAYpoBh6cAhAGKYAoalA4cAiGEKGJYOHAIghilgWDpwCIAYpoBh6cAhAGKYAoalA4cAiGEKGJYOHAIghilgWDpwCIAYpoBh6ZQ4JB6PKzviYthnNy4d9h+1M5mMlVckkUjsG5dhiBMCEMPg/wuOfrZZ/RSywQAAAABJRU5ErkJggg=='\n\nexport const IMG_PLAYBTN =\n\t'data:image/png;base64,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'\n","/**\n * PptxGenJS: Utility Methods\n */\n\nimport { EMU, REGEX_HEX_COLOR, DEF_FONT_COLOR, ONEPT, SchemeColor, SCHEME_COLORS } from './core-enums'\nimport { IChartOpts, PresLayout, TextGlowProps, PresSlide, ShapeFillProps, Color, ShapeLineProps } from './core-interfaces'\n\n/**\n * Convert string percentages to number relative to slide size\n * @param {number|string} size - numeric (\"5.5\") or percentage (\"90%\")\n * @param {'X' | 'Y'} xyDir - direction\n * @param {PresLayout} layout - presentation layout\n * @returns {number} calculated size\n */\nexport function getSmartParseNumber(size: number | string, xyDir: 'X' | 'Y', layout: PresLayout): number {\n\t// FIRST: Convert string numeric value if reqd\n\tif (typeof size === 'string' && !isNaN(Number(size))) size = Number(size)\n\n\t// CASE 1: Number in inches\n\t// Assume any number less than 100 is inches\n\tif (typeof size === 'number' && size < 100) return inch2Emu(size)\n\n\t// CASE 2: Number is already converted to something other than inches\n\t// Assume any number greater than 100 is not inches! Just return it (its EMU already i guess??)\n\tif (typeof size === 'number' && size >= 100) return size\n\n\t// CASE 3: Percentage (ex: '50%')\n\tif (typeof size === 'string' && size.indexOf('%') > -1) {\n\t\tif (xyDir && xyDir === 'X') return Math.round((parseFloat(size) / 100) * layout.width)\n\t\tif (xyDir && xyDir === 'Y') return Math.round((parseFloat(size) / 100) * layout.height)\n\n\t\t// Default: Assume width (x/cx)\n\t\treturn Math.round((parseFloat(size) / 100) * layout.width)\n\t}\n\n\t// LAST: Default value\n\treturn 0\n}\n\n/**\n * Basic UUID Generator Adapted\n * @link https://stackoverflow.com/questions/105034/create-guid-uuid-in-javascript#answer-2117523\n * @param {string} uuidFormat - UUID format\n * @returns {string} UUID\n */\nexport function getUuid(uuidFormat: string): string {\n\treturn uuidFormat.replace(/[xy]/g, function (c) {\n\t\tlet r = (Math.random() * 16) | 0,\n\t\t\tv = c === 'x' ? r : (r & 0x3) | 0x8\n\t\treturn v.toString(16)\n\t})\n}\n\n/**\n * TODO: What does this method do again??\n * shallow mix, returns new object\n */\nexport function getMix(o1: any | IChartOpts, o2: any | IChartOpts, etc?: any) {\n\tlet objMix = {}\n\tfor (let i = 0; i <= arguments.length; i++) {\n\t\tlet oN = arguments[i]\n\t\tif (oN)\n\t\t\tObject.keys(oN).forEach(key => {\n\t\t\t\tobjMix[key] = oN[key]\n\t\t\t})\n\t}\n\treturn objMix\n}\n\n/**\n * Replace special XML characters with HTML-encoded strings\n * @param {string} xml - XML string to encode\n * @returns {string} escaped XML\n */\nexport function encodeXmlEntities(xml: string): string {\n\t// NOTE: Dont use short-circuit eval here as value c/b \"0\" (zero) etc.!\n\tif (typeof xml === 'undefined' || xml == null) return ''\n\treturn xml.toString().replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&apos;')\n}\n\n/**\n * Convert inches into EMU\n * @param {number|string} inches - as string or number\n * @returns {number} EMU value\n */\nexport function inch2Emu(inches: number | string): number {\n\t// FIRST: Provide Caller Safety: Numbers may get conv<->conv during flight, so be kind and do some simple checks to ensure inches were passed\n\t// Any value over 100 damn sure isnt inches, must be EMU already, so just return it\n\tif (typeof inches === 'number' && inches > 100) return inches\n\tif (typeof inches === 'string') inches = Number(inches.replace(/in*/gi, ''))\n\treturn Math.round(EMU * inches)\n}\n\n/**\n * Convert `pt` into points (using `ONEPT`)\n *\n * @param {number|string} pt\n * @returns {number} value in points (`ONEPT`)\n */\nexport function valToPts(pt: number | string): number {\n\tlet points = Number(pt) || 0\n\treturn isNaN(points) ? 0 : Math.round(points * ONEPT)\n}\n\n/**\n * Convert degrees (0..360) to PowerPoint `rot` value\n *\n * @param {number} d - degrees\n * @returns {number} rot - value\n */\nexport function convertRotationDegrees(d: number): number {\n\td = d || 0\n\treturn (d > 360 ? d - 360 : d) * 60000\n}\n\n/**\n * Converts component value to hex value\n * @param {number} c - component color\n * @returns {string} hex string\n */\nexport function componentToHex(c: number): string {\n\tlet hex = c.toString(16)\n\treturn hex.length === 1 ? '0' + hex : hex\n}\n\n/**\n * Converts RGB colors from css selectors to Hex for Presentation colors\n * @param {number} r - red value\n * @param {number} g - green value\n * @param {number} b - blue value\n * @returns {string} XML string\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n\treturn (componentToHex(r) + componentToHex(g) + componentToHex(b)).toUpperCase()\n}\n\n/**\n * Create either a `a:schemeClr` - (scheme color) or `a:srgbClr` (hexa representation).\n * @param {string|SCHEME_COLORS} colorStr - hexa representation (eg. \"FFFF00\") or a scheme color constant (eg. pptx.SchemeColor.ACCENT1)\n * @param {string} innerElements - additional elements that adjust the color and are enclosed by the color element\n * @returns {string} XML string\n */\nexport function createColorElement(colorStr: string | SCHEME_COLORS, innerElements?: string): string {\n\tlet colorVal = (colorStr || '').replace('#', '')\n\tlet isHexaRgb = REGEX_HEX_COLOR.test(colorVal)\n\n\tif (\n\t\t!isHexaRgb &&\n\t\tcolorVal !== SchemeColor.background1 &&\n\t\tcolorVal !== SchemeColor.background2 &&\n\t\tcolorVal !== SchemeColor.text1 &&\n\t\tcolorVal !== SchemeColor.text2 &&\n\t\tcolorVal !== SchemeColor.accent1 &&\n\t\tcolorVal !== SchemeColor.accent2 &&\n\t\tcolorVal !== SchemeColor.accent3 &&\n\t\tcolorVal !== SchemeColor.accent4 &&\n\t\tcolorVal !== SchemeColor.accent5 &&\n\t\tcolorVal !== SchemeColor.accent6\n\t) {\n\t\tconsole.warn(`\"${colorVal}\" is not a valid scheme color or hexa RGB! \"${DEF_FONT_COLOR}\" is used as a fallback. Pass 6-digit RGB or 'pptx.SchemeColor' values`)\n\t\tcolorVal = DEF_FONT_COLOR\n\t}\n\n\tlet tagName = isHexaRgb ? 'srgbClr' : 'schemeClr'\n\tlet colorAttr = 'val=\"' + (isHexaRgb ? colorVal.toUpperCase() : colorVal) + '\"'\n\n\treturn innerElements ? `<a:${tagName} ${colorAttr}>${innerElements}</a:${tagName}>` : `<a:${tagName} ${colorAttr}/>`\n}\n\n/**\n * Creates `a:glow` element\n * @param {TextGlowProps} options glow properties\n * @param {TextGlowProps} defaults defaults for unspecified properties in `opts`\n * @see http://officeopenxml.com/drwSp-effects.php\n *\t{ size: 8, color: 'FFFFFF', opacity: 0.75 };\n */\nexport function createGlowElement(options: TextGlowProps, defaults: TextGlowProps): string {\n\tlet strXml = '',\n\t\topts = getMix(defaults, options),\n\t\tsize = opts['size'] * ONEPT,\n\t\tcolor = opts['color'],\n\t\topacity = opts['opacity'] * 100000\n\n\tstrXml += `<a:glow rad=\"${size}\">`\n\tstrXml += createColorElement(color, `<a:alpha val=\"${opacity}\"/>`)\n\tstrXml += `</a:glow>`\n\n\treturn strXml\n}\n\n/**\n * Create color selection\n * @param {shapeFill} ShapeFillProps - options\n * @param {string} backColor - color string\n * @returns {string} XML string\n */\nexport function genXmlColorSelection(shapeFill: Color | ShapeFillProps | ShapeLineProps, backColor?: string): string {\n\tlet colorVal = ''\n\tlet fillType = 'solid'\n\tlet internalElements = ''\n\tlet outText = ''\n\n\tif (backColor && typeof backColor === 'string') {\n\t\toutText += `<p:bg><p:bgPr>${genXmlColorSelection(backColor.replace('#', ''))}<a:effectLst/></p:bgPr></p:bg>`\n\t}\n\n\tif (shapeFill) {\n\t\tif (typeof shapeFill === 'string') colorVal = shapeFill\n\t\telse {\n\t\t\tif (shapeFill.type) fillType = shapeFill.type\n\t\t\tif (shapeFill.color) colorVal = shapeFill.color\n\t\t\tif (shapeFill.alpha) internalElements += `<a:alpha val=\"${100 - shapeFill.alpha}000\"/>` // @deprecated v3.3.0\n\t\t\tif (shapeFill.transparency) internalElements += `<a:alpha val=\"${100 - shapeFill.transparency}000\"/>`\n\t\t}\n\n\t\tswitch (fillType) {\n\t\t\tcase 'solid':\n\t\t\t\toutText += `<a:solidFill>${createColorElement(colorVal, internalElements)}</a:solidFill>`\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\toutText += '' // @note need a statement as having only \"break\" is removed by rollup, then tiggers \"no-default\" js-linter\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\treturn outText\n}\n\n/**\n * Get a new rel ID (rId) for charts, media, etc.\n * @param {PresSlide} target - the slide to use\n * @returns {number} count of all current rels plus 1 for the caller to use as its \"rId\"\n */\nexport function getNewRelId(target: PresSlide): number {\n\treturn target._rels.length + target._relsChart.length + target._relsMedia.length + 1\n}\n","/**\n * PptxGenJS: Table Generation\n */\n\nimport { CRLF, DEF_FONT_SIZE, DEF_SLIDE_MARGIN_IN, EMU, LINEH_MODIFIER, ONEPT, SLIDE_OBJECT_TYPES } from './core-enums'\nimport PptxGenJS from './pptxgen'\nimport { PresLayout, SlideLayout, TableCell, TableToSlidesProps, TableRow, TableRowSlide, TableCellProps } from './core-interfaces'\nimport { inch2Emu, rgbToHex, valToPts } from './gen-utils'\n\n/**\n * Break text paragraphs into lines based upon table column width (e.g.: Magic Happens Here(tm))\n * @param {TableCell} cell - table cell\n * @param {number} colWidth - table column width\n * @return {string[]} XML\n */\nfunction parseTextToLines(cell: TableCell, colWidth: number): string[] {\n\tlet CHAR = 2.2 + (cell.options && cell.options.autoPageCharWeight ? cell.options.autoPageCharWeight : 0) // Character Constant (An approximation of the Golden Ratio)\n\tlet CPL = (colWidth * EMU) / (((cell.options && cell.options.fontSize) || DEF_FONT_SIZE) / CHAR) // Chars-Per-Line\n\tlet arrLines = []\n\tlet strCurrLine = ''\n\n\t// A: Allow a single space/whitespace as cell text (user-requested feature)\n\tif (cell.text && cell.text.toString().trim().length === 0) return [' ']\n\n\t// B: Remove leading/trailing spaces\n\tlet inStr = (cell.text || '').toString().trim()\n\n\t// C: Build line array\n\tinStr.split('\\n').forEach(line => {\n\t\tline.split(' ').forEach(word => {\n\t\t\tif (strCurrLine.length + word.length + 1 < CPL) {\n\t\t\t\tstrCurrLine += word + ' '\n\t\t\t} else {\n\t\t\t\tif (strCurrLine) arrLines.push(strCurrLine)\n\t\t\t\tstrCurrLine = word + ' '\n\t\t\t}\n\t\t})\n\n\t\t// All words for this line have been exhausted, flush buffer to new line, clear line var\n\t\tif (strCurrLine) arrLines.push(strCurrLine.trim() + CRLF)\n\t\tstrCurrLine = ''\n\t})\n\n\t// D: Remove trailing linebreak\n\tarrLines[arrLines.length - 1] = arrLines[arrLines.length - 1].trim()\n\n\treturn arrLines\n}\n\n/**\n * Takes an array of table rows and breaks into an array of slides, which contain the calculated amount of table rows that fit on that slide\n * @param {TableCell[][]} tableRows - HTMLElementID of the table\n * @param {ITableToSlidesOpts} tabOpts - array of options (e.g.: tabsize)\n * @param {PresLayout} presLayout - Presentation layout\n * @param {SlideLayout} masterSlide - master slide (if any)\n * @return {TableRowSlide[]} array of table rows\n */\nexport function getSlidesForTableRows(tableRows: TableCell[][] = [], tabOpts: TableToSlidesProps = {}, presLayout: PresLayout, masterSlide?: SlideLayout): TableRowSlide[] {\n\tlet arrInchMargins = DEF_SLIDE_MARGIN_IN,\n\t\temuTabCurrH = 0,\n\t\temuSlideTabW = EMU * 1,\n\t\temuSlideTabH = EMU * 1,\n\t\tnumCols = 0,\n\t\ttableRowSlides = [\n\t\t\t{\n\t\t\t\trows: [] as TableRow[],\n\t\t\t},\n\t\t]\n\n\tif (tabOpts.verbose) {\n\t\tconsole.log(`-- VERBOSE MODE ----------------------------------`)\n\t\tconsole.log(`.. (PARAMETERS)`)\n\t\tconsole.log(`presLayout.height ......... = ${presLayout.height / EMU}`)\n\t\tconsole.log(`tabOpts.h ................. = ${tabOpts.h}`)\n\t\tconsole.log(`tabOpts.w ................. = ${tabOpts.w}`)\n\t\tconsole.log(`tabOpts.colW .............. = ${tabOpts.colW}`)\n\t\tconsole.log(`tabOpts.slideMargin ....... = ${tabOpts.slideMargin || ''}`)\n\t\tconsole.log(`.. (/PARAMETERS)`)\n\t}\n\n\t// STEP 1: Calculate margins\n\t{\n\t\t// Important: Use default size as zero cell margin is causing our tables to be too large and touch bottom of slide!\n\t\tif (!tabOpts.slideMargin && tabOpts.slideMargin !== 0) tabOpts.slideMargin = DEF_SLIDE_MARGIN_IN[0]\n\n\t\tif (masterSlide && typeof masterSlide._margin !== 'undefined') {\n\t\t\tif (Array.isArray(masterSlide._margin)) arrInchMargins = masterSlide._margin\n\t\t\telse if (!isNaN(Number(masterSlide._margin)))\n\t\t\t\tarrInchMargins = [Number(masterSlide._margin), Number(masterSlide._margin), Number(masterSlide._margin), Number(masterSlide._margin)]\n\t\t} else if (tabOpts.slideMargin || tabOpts.slideMargin === 0) {\n\t\t\tif (Array.isArray(tabOpts.slideMargin)) arrInchMargins = tabOpts.slideMargin\n\t\t\telse if (!isNaN(tabOpts.slideMargin)) arrInchMargins = [tabOpts.slideMargin, tabOpts.slideMargin, tabOpts.slideMargin, tabOpts.slideMargin]\n\t\t}\n\n\t\tif (tabOpts.verbose) console.log('arrInchMargins ......... = ' + arrInchMargins.toString())\n\t}\n\n\t// STEP 2: Calculate number of columns\n\t{\n\t\t// NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\n\t\t// ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\n\t\tlet firstRow = tableRows[0] || []\n\t\tfirstRow.forEach(cell => {\n\t\t\tif (!cell) cell = { _type: SLIDE_OBJECT_TYPES.tablecell }\n\t\t\tlet cellOpts = cell.options || null\n\t\t\tnumCols += Number(cellOpts && cellOpts.colspan ? cellOpts.colspan : 1)\n\t\t})\n\n\t\tif (tabOpts.verbose) console.log('numCols ................ = ' + numCols)\n\t}\n\n\t// STEP 3: Calculate tabOpts.w if tabOpts.colW was provided\n\tif (!tabOpts.w && tabOpts.colW) {\n\t\tif (Array.isArray(tabOpts.colW))\n\t\t\ttabOpts.colW.forEach(val => {\n\t\t\t\ttypeof tabOpts.w !== 'number' ? (tabOpts.w = 0 + val) : (tabOpts.w += val)\n\t\t\t})\n\t\telse {\n\t\t\ttabOpts.w = tabOpts.colW * numCols\n\t\t}\n\t}\n\n\t// STEP 4: Calculate usable space/table size (now that total usable space is known)\n\t{\n\t\temuSlideTabW =\n\t\t\ttypeof tabOpts.w === 'number'\n\t\t\t\t? inch2Emu(tabOpts.w)\n\t\t\t\t: presLayout.width - inch2Emu((typeof tabOpts.x === 'number' ? tabOpts.x : arrInchMargins[1]) + arrInchMargins[3])\n\n\t\tif (tabOpts.verbose) console.log('emuSlideTabW (in) ...... = ' + (emuSlideTabW / EMU).toFixed(1))\n\t}\n\n\t// STEP 5: Calculate column widths if not provided (emuSlideTabW will be used below to determine lines-per-col)\n\tif (!tabOpts.colW || !Array.isArray(tabOpts.colW)) {\n\t\tif (tabOpts.colW && !isNaN(Number(tabOpts.colW))) {\n\t\t\tlet arrColW = []\n\t\t\tlet firstRow = tableRows[0] || []\n\t\t\tfirstRow.forEach(() => arrColW.push(tabOpts.colW))\n\t\t\ttabOpts.colW = []\n\t\t\tarrColW.forEach(val => {\n\t\t\t\tif (Array.isArray(tabOpts.colW)) tabOpts.colW.push(val)\n\t\t\t})\n\t\t}\n\t\t// No column widths provided? Then distribute cols.\n\t\telse {\n\t\t\ttabOpts.colW = []\n\t\t\tfor (let iCol = 0; iCol < numCols; iCol++) {\n\t\t\t\ttabOpts.colW.push(emuSlideTabW / EMU / numCols)\n\t\t\t}\n\t\t}\n\t}\n\n\t// STEP 6: **MAIN** Iterate over rows, add table content, create new slides as rows overflow\n\tlet iRow = 0\n\twhile (tableRows.length > 0) {\n\t\tlet row = tableRows.shift()\n\t\tiRow++\n\n\t\t// A: Row variables\n\t\tlet maxLineHeight = 0\n\t\tlet linesRow: TableCell[] = []\n\t\tlet maxCellMarTopEmu = 0\n\t\tlet maxCellMarBtmEmu = 0\n\n\t\t// B: Create new row in data model\n\t\tlet currSlide = tableRowSlides[tableRowSlides.length - 1]\n\t\tlet newRowSlide = []\n\t\trow.forEach(cell => {\n\t\t\tnewRowSlide.push({\n\t\t\t\ttype: SLIDE_OBJECT_TYPES.tablecell,\n\t\t\t\ttext: '',\n\t\t\t\toptions: cell.options,\n\t\t\t})\n\n\t\t\tif (cell.options.margin && cell.options.margin[0] && valToPts(cell.options.margin[0]) > maxCellMarTopEmu) maxCellMarTopEmu = valToPts(cell.options.margin[0])\n\t\t\telse if (tabOpts.margin && tabOpts.margin[0] && valToPts(tabOpts.margin[0]) > maxCellMarTopEmu) maxCellMarTopEmu = valToPts(tabOpts.margin[0])\n\t\t\tif (cell.options.margin && cell.options.margin[2] && valToPts(cell.options.margin[2]) > maxCellMarBtmEmu) maxCellMarBtmEmu = valToPts(cell.options.margin[2])\n\t\t\telse if (tabOpts.margin && tabOpts.margin[2] && valToPts(tabOpts.margin[2]) > maxCellMarBtmEmu) maxCellMarBtmEmu = valToPts(tabOpts.margin[2])\n\t\t})\n\n\t\t// C: Calc usable vertical space/table height. Set default value first, adjust below when necessary.\n\t\temuSlideTabH =\n\t\t\ttabOpts.h && typeof tabOpts.h === 'number'\n\t\t\t\t? tabOpts.h\n\t\t\t\t: presLayout.height - inch2Emu(arrInchMargins[0] + arrInchMargins[2]) - (tabOpts.y && typeof tabOpts.y === 'number' ? tabOpts.y : 0)\n\t\tif (tabOpts.verbose) console.log('emuSlideTabH (in) ...... = ' + (emuSlideTabH / EMU).toFixed(1))\n\n\t\t// D: RULE: Use margins for starting point after the initial Slide, not `opt.y` (ISSUE#43, ISSUE#47, ISSUE#48)\n\t\tif (tableRowSlides.length > 1 && typeof tabOpts.autoPageSlideStartY === 'number') {\n\t\t\temuSlideTabH = tabOpts.h && typeof tabOpts.h === 'number' ? tabOpts.h : presLayout.height - inch2Emu(tabOpts.autoPageSlideStartY + arrInchMargins[2])\n\t\t} else if (tableRowSlides.length > 1 && typeof tabOpts.newSlideStartY === 'number') {\n\t\t\t// @deprecated v3.3.0\n\t\t\temuSlideTabH = tabOpts.h && typeof tabOpts.h === 'number' ? tabOpts.h : presLayout.height - inch2Emu(tabOpts.newSlideStartY + arrInchMargins[2])\n\t\t} else if (tableRowSlides.length > 1 && typeof tabOpts.y === 'number') {\n\t\t\temuSlideTabH = presLayout.height - inch2Emu((tabOpts.y / EMU < arrInchMargins[0] ? tabOpts.y / EMU : arrInchMargins[0]) + arrInchMargins[2])\n\t\t\t// Use whichever is greater: area between margins or the table H provided (dont shrink usable area - the whole point of over-riding X on paging is to *increarse* usable space)\n\t\t\tif (typeof tabOpts.h === 'number' && emuSlideTabH < tabOpts.h) emuSlideTabH = tabOpts.h\n\t\t} else if (typeof tabOpts.h === 'number' && typeof tabOpts.y === 'number')\n\t\t\temuSlideTabH = tabOpts.h ? tabOpts.h : presLayout.height - inch2Emu((tabOpts.y / EMU || arrInchMargins[0]) + arrInchMargins[2])\n\t\t//if (tabOpts.verbose) console.log(`- SLIDE [${tableRowSlides.length}]: emuSlideTabH .. = ${(emuSlideTabH / EMU).toFixed(1)}`)\n\n\t\t// E: **BUILD DATA SET** | Iterate over cells: split text into lines[], set `lineHeight`\n\t\trow.forEach((cell, iCell) => {\n\t\t\tlet newCell: TableCell = {\n\t\t\t\t_type: SLIDE_OBJECT_TYPES.tablecell,\n\t\t\t\t_lines: [],\n\t\t\t\t_lineHeight: inch2Emu(\n\t\t\t\t\t((cell.options && cell.options.fontSize ? cell.options.fontSize : tabOpts.fontSize ? tabOpts.fontSize : DEF_FONT_SIZE) *\n\t\t\t\t\t\t(LINEH_MODIFIER + (tabOpts.autoPageLineWeight ? tabOpts.autoPageLineWeight : 0))) /\n\t\t\t\t\t\t100\n\t\t\t\t),\n\t\t\t\ttext: '',\n\t\t\t\toptions: cell.options,\n\t\t\t}\n\t\t\t//if (tabOpts.verbose) console.log(`- CELL [${iCell}]: newCell.lineHeight ..... = ${(newCell.lineHeight / EMU).toFixed(2)}`)\n\n\t\t\t// 1: Exempt cells with `rowspan` from increasing lineHeight (or we could create a new slide when unecessary!)\n\t\t\tif (newCell.options.rowspan) newCell._lineHeight = 0\n\n\t\t\t// 2: The parseTextToLines method uses `autoPageCharWeight`, so inherit from table options\n\t\t\tnewCell.options.autoPageCharWeight = tabOpts.autoPageCharWeight ? tabOpts.autoPageCharWeight : null\n\n\t\t\t// 3: **MAIN** Parse cell contents into lines based upon col width, font, etc\n\t\t\tlet totalColW = tabOpts.colW[iCell]\n\t\t\tif (cell.options.colspan && Array.isArray(tabOpts.colW)) {\n\t\t\t\ttotalColW = tabOpts.colW.filter((_cell, idx) => idx >= iCell && idx < idx + cell.options.colspan).reduce((prev, curr) => prev + curr)\n\t\t\t}\n\t\t\tnewCell._lines = parseTextToLines(cell, totalColW / ONEPT)\n\n\t\t\t// 4: Add to array\n\t\t\tlinesRow.push(newCell)\n\t\t})\n\n\t\t// F: Start row height with margins\n\t\tif (tabOpts.verbose) console.log(`- SLIDE [${tableRowSlides.length}]: ROW [${iRow}]: maxCellMarTopEmu=${maxCellMarTopEmu} / maxCellMarBtmEmu=${maxCellMarBtmEmu}`)\n\t\temuTabCurrH += maxCellMarTopEmu + maxCellMarBtmEmu\n\n\t\t// G: Only create a new row if there is room, otherwise, it'll be an empty row as \"A:\" below will create a new Slide before loop can populate this row\n\t\tif (emuTabCurrH + maxLineHeight <= emuSlideTabH) currSlide.rows.push(newRowSlide)\n\n\t\t/* H: **PAGE DATA SET**\n\t\t * Add text one-line-a-time to this row's cells until: lines are exhausted OR table height limit is hit\n\t\t * Design: Building cells L-to-R/loop style wont work as one could be 100 lines and another 1 line.\n\t\t * Therefore, build the whole row, 1-line-at-a-time, spanning all columns.\n\t\t * That way, when the vertical size limit is hit, all lines pick up where they need to on the subsequent slide.\n\t\t */\n\t\tif (tabOpts.verbose) console.log(`- SLIDE [${tableRowSlides.length}]: ROW [${iRow}]: START...`)\n\t\twhile (linesRow.filter(cell => cell._lines.length > 0).length > 0) {\n\t\t\t// A: Add new Slide if there is no more space to fix 1 new line\n\t\t\tif (emuTabCurrH + maxLineHeight > emuSlideTabH) {\n\t\t\t\tif (tabOpts.verbose)\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t`** NEW SLIDE CREATED *****************************************` +\n\t\t\t\t\t\t\t` (why?): ${(emuTabCurrH / EMU).toFixed(2)}+${(maxLineHeight / EMU).toFixed(2)} > ${emuSlideTabH / EMU}`\n\t\t\t\t\t)\n\n\t\t\t\t// 1: Add a new slide\n\t\t\t\ttableRowSlides.push({\n\t\t\t\t\trows: [] as TableRow[],\n\t\t\t\t})\n\n\t\t\t\t// 2: Reset current table height for new Slide\n\t\t\t\temuTabCurrH = 0 // This row's emuRowH w/b added below\n\n\t\t\t\t// 3: Handle repeat headers option /or/ Add new empty row to continue current lines into\n\t\t\t\tif ((tabOpts.addHeaderToEach || tabOpts.autoPageRepeatHeader) && tabOpts._arrObjTabHeadRows) {\n\t\t\t\t\t// A: Add remaining cell lines\n\t\t\t\t\tlet newRowSlide = []\n\t\t\t\t\tlinesRow.forEach(cell => {\n\t\t\t\t\t\tnewRowSlide.push({\n\t\t\t\t\t\t\ttype: SLIDE_OBJECT_TYPES.tablecell,\n\t\t\t\t\t\t\ttext: cell._lines.join(''),\n\t\t\t\t\t\t\toptions: cell.options,\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\ttableRows.unshift(newRowSlide)\n\n\t\t\t\t\t// B: Add header row(s)\n\t\t\t\t\tlet tableHeadRows: TableCell[][] = []\n\t\t\t\t\ttabOpts._arrObjTabHeadRows.forEach(row => {\n\t\t\t\t\t\tlet newHeadRow = []\n\t\t\t\t\t\trow.forEach(cell => newHeadRow.push(cell))\n\t\t\t\t\t\ttableHeadRows.push(newHeadRow)\n\t\t\t\t\t})\n\t\t\t\t\ttableRows = [...tableHeadRows, ...tableRows]\n\n\t\t\t\t\t// C:\n\t\t\t\t\tbreak\n\t\t\t\t} else {\n\t\t\t\t\t// A: Add new row to new slide\n\t\t\t\t\tlet currSlide = tableRowSlides[tableRowSlides.length - 1]\n\t\t\t\t\tlet newRowSlide = []\n\t\t\t\t\trow.forEach(cell => {\n\t\t\t\t\t\tnewRowSlide.push({\n\t\t\t\t\t\t\ttype: SLIDE_OBJECT_TYPES.tablecell,\n\t\t\t\t\t\t\ttext: '',\n\t\t\t\t\t\t\toptions: cell.options,\n\t\t\t\t\t\t})\n\t\t\t\t\t})\n\t\t\t\t\tcurrSlide.rows.push(newRowSlide)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// B: Add a line of text to 1-N cells that still have `lines`\n\t\t\tlinesRow.forEach((cell, idxR) => {\n\t\t\t\tif (cell._lines.length > 0) {\n\t\t\t\t\t// 1\n\t\t\t\t\tlet currSlide = tableRowSlides[tableRowSlides.length - 1]\n\t\t\t\t\t// NOTE: TableCell.text type c/b string|IText (for conversion in method that calls this one), but we can guarantee it always string b/c we craft it, hence this TS workaround\n\t\t\t\t\tlet rowCell = currSlide.rows[currSlide.rows.length - 1][idxR] as TableCell\n\t\t\t\t\tlet currText = rowCell.text.toString()\n\t\t\t\t\trowCell.text += (currText.length > 0 && !RegExp(/\\n$/g).test(currText) ? CRLF : '').replace(/[\\r\\n]+$/g, CRLF) + cell._lines.shift()\n\n\t\t\t\t\t// 2\n\t\t\t\t\tif (cell._lineHeight > maxLineHeight) maxLineHeight = cell._lineHeight\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// C: Increase table height by one line height as 1-N cells below are\n\t\t\temuTabCurrH += maxLineHeight\n\t\t\tif (tabOpts.verbose) console.log(`- SLIDE [${tableRowSlides.length}]: ROW [${iRow}]: one line added ... emuTabCurrH = ${(emuTabCurrH / EMU).toFixed(2)}`)\n\t\t}\n\n\t\tif (tabOpts.verbose)\n\t\t\tconsole.log(\n\t\t\t\t`- SLIDE [${tableRowSlides.length}]: ROW [${iRow}]: ...COMPLETE ...... emuTabCurrH = ${(emuTabCurrH / EMU).toFixed(2)} ( emuSlideTabH = ${(\n\t\t\t\t\temuSlideTabH / EMU\n\t\t\t\t).toFixed(2)} )`\n\t\t\t)\n\t}\n\n\tif (tabOpts.verbose) {\n\t\tconsole.log(`\\n|================================================|\\n| FINAL: tableRowSlides.length = ${tableRowSlides.length}`)\n\t\tconsole.log(tableRowSlides)\n\t\t//console.log(JSON.stringify(tableRowSlides,null,2))\n\t\tconsole.log(`|================================================|\\n\\n`)\n\t}\n\n\treturn tableRowSlides\n}\n\n/**\n * Reproduces an HTML table as a PowerPoint table - including column widths, style, etc. - creates 1 or more slides as needed\n * @param {PptxGenJS} pptx - pptxgenjs instance\n * @param {string} tabEleId - HTMLElementID of the table\n * @param {ITableToSlidesOpts} options - array of options (e.g.: tabsize)\n * @param {SlideLayout} masterSlide - masterSlide\n */\nexport function genTableToSlides(pptx: PptxGenJS, tabEleId: string, options: TableToSlidesProps = {}, masterSlide?: SlideLayout) {\n\tlet opts = options || {}\n\topts.slideMargin = opts.slideMargin || opts.slideMargin === 0 ? opts.slideMargin : 0.5\n\tlet emuSlideTabW = opts.w || pptx.presLayout.width\n\tlet arrObjTabHeadRows: [TableCell[]?] = []\n\tlet arrObjTabBodyRows: [TableCell[]?] = []\n\tlet arrObjTabFootRows: [TableCell[]?] = []\n\tlet arrColW: number[] = []\n\tlet arrTabColW: number[] = []\n\tlet arrInchMargins: [number, number, number, number] = [0.5, 0.5, 0.5, 0.5] // TRBL-style\n\tlet intTabW = 0\n\n\t// REALITY-CHECK:\n\tif (!document.getElementById(tabEleId)) throw new Error('tableToSlides: Table ID \"' + tabEleId + '\" does not exist!')\n\n\t// STEP 1: Set margins\n\tif (masterSlide && masterSlide._margin) {\n\t\tif (Array.isArray(masterSlide._margin)) arrInchMargins = masterSlide._margin\n\t\telse if (!isNaN(masterSlide._margin)) arrInchMargins = [masterSlide._margin, masterSlide._margin, masterSlide._margin, masterSlide._margin]\n\t\topts.slideMargin = arrInchMargins\n\t} else if (opts && opts.slideMargin) {\n\t\tif (Array.isArray(opts.slideMargin)) arrInchMargins = opts.slideMargin\n\t\telse if (!isNaN(opts.slideMargin)) arrInchMargins = [opts.slideMargin, opts.slideMargin, opts.slideMargin, opts.slideMargin]\n\t}\n\temuSlideTabW = (opts.w ? inch2Emu(opts.w) : pptx.presLayout.width) - inch2Emu(arrInchMargins[1] + arrInchMargins[3])\n\n\tif (opts.verbose) console.log('-- VERBOSE MODE ----------------------------------')\n\tif (opts.verbose) console.log(`opts.h ................. = ${opts.h}`)\n\tif (opts.verbose) console.log(`opts.w ................. = ${opts.w}`)\n\tif (opts.verbose) console.log(`pptx.presLayout.width .. = ${pptx.presLayout.width / EMU}`)\n\tif (opts.verbose) console.log(`emuSlideTabW (in)....... = ${emuSlideTabW / EMU}`)\n\n\t// STEP 2: Grab table col widths - just find the first availble row, either thead/tbody/tfoot, others may have colspsna,s who cares, we only need col widths from 1\n\tlet firstRowCells = document.querySelectorAll(`#${tabEleId} tr:first-child th`)\n\tif (firstRowCells.length === 0) firstRowCells = document.querySelectorAll(`#${tabEleId} tr:first-child td`)\n\tfirstRowCells.forEach((cell: HTMLElement) => {\n\t\tif (cell.getAttribute('colspan')) {\n\t\t\t// Guesstimate (divide evenly) col widths\n\t\t\t// NOTE: both j$query and vanilla selectors return {0} when table is not visible)\n\t\t\tfor (let idxc = 0; idxc < Number(cell.getAttribute('colspan')); idxc++) {\n\t\t\t\tarrTabColW.push(Math.round(cell.offsetWidth / Number(cell.getAttribute('colspan'))))\n\t\t\t}\n\t\t} else {\n\t\t\tarrTabColW.push(cell.offsetWidth)\n\t\t}\n\t})\n\tarrTabColW.forEach(colW => {\n\t\tintTabW += colW\n\t})\n\n\t// STEP 3: Calc/Set column widths by using same column width percent from HTML table\n\tarrTabColW.forEach((colW, idxW) => {\n\t\tlet intCalcWidth = Number(((Number(emuSlideTabW) * ((colW / intTabW) * 100)) / 100 / EMU).toFixed(2))\n\t\tlet intMinWidth = 0\n\t\tlet colSelectorMin = document.querySelector(`#${tabEleId} thead tr:first-child th:nth-child(${idxW + 1})`)\n\t\tif (colSelectorMin) intMinWidth = Number(colSelectorMin.getAttribute('data-pptx-min-width'))\n\t\tlet intSetWidth = 0\n\t\tlet colSelectorSet = document.querySelector(`#${tabEleId} thead tr:first-child th:nth-child(${idxW + 1})`)\n\t\tif (colSelectorSet) intMinWidth = Number(colSelectorSet.getAttribute('data-pptx-width'))\n\t\tarrColW.push(intSetWidth ? intSetWidth : intMinWidth > intCalcWidth ? intMinWidth : intCalcWidth)\n\t})\n\tif (opts.verbose) {\n\t\tconsole.log(`arrColW ................ = ${arrColW.toString()}`)\n\t}\n\n\t// STEP 4: Iterate over each table element and create data arrays (text and opts)\n\t// NOTE: We create 3 arrays instead of one so we can loop over body then show header/footer rows on first and last page\n\t;['thead', 'tbody', 'tfoot'].forEach(part => {\n\t\tdocument.querySelectorAll(`#${tabEleId} ${part} tr`).forEach((row: HTMLTableRowElement) => {\n\t\t\tlet arrObjTabCells: TableCell[] = []\n\t\t\tArray.from(row.cells).forEach(cell => {\n\t\t\t\t// A: Get RGB text/bkgd colors\n\t\t\t\tlet arrRGB1 = window.getComputedStyle(cell).getPropertyValue('color').replace(/\\s+/gi, '').replace('rgba(', '').replace('rgb(', '').replace(')', '').split(',')\n\t\t\t\tlet arrRGB2 = window\n\t\t\t\t\t.getComputedStyle(cell)\n\t\t\t\t\t.getPropertyValue('background-color')\n\t\t\t\t\t.replace(/\\s+/gi, '')\n\t\t\t\t\t.replace('rgba(', '')\n\t\t\t\t\t.replace('rgb(', '')\n\t\t\t\t\t.replace(')', '')\n\t\t\t\t\t.split(',')\n\t\t\t\tif (\n\t\t\t\t\t// NOTE: (ISSUE#57): Default for unstyled tables is black bkgd, so use white instead\n\t\t\t\t\twindow.getComputedStyle(cell).getPropertyValue('background-color') === 'rgba(0, 0, 0, 0)' ||\n\t\t\t\t\twindow.getComputedStyle(cell).getPropertyValue('transparent')\n\t\t\t\t) {\n\t\t\t\t\tarrRGB2 = ['255', '255', '255']\n\t\t\t\t}\n\n\t\t\t\t// B: Create option object\n\t\t\t\tlet cellOpts: TableCellProps = {\n\t\t\t\t\talign: null,\n\t\t\t\t\tbold:\n\t\t\t\t\t\twindow.getComputedStyle(cell).getPropertyValue('font-weight') === 'bold' ||\n\t\t\t\t\t\tNumber(window.getComputedStyle(cell).getPropertyValue('font-weight')) >= 500\n\t\t\t\t\t\t\t? true\n\t\t\t\t\t\t\t: false,\n\t\t\t\t\tborder: null,\n\t\t\t\t\tcolor: rgbToHex(Number(arrRGB1[0]), Number(arrRGB1[1]), Number(arrRGB1[2])),\n\t\t\t\t\tfill: { color: rgbToHex(Number(arrRGB2[0]), Number(arrRGB2[1]), Number(arrRGB2[2])) },\n\t\t\t\t\tfontFace:\n\t\t\t\t\t\t(window.getComputedStyle(cell).getPropertyValue('font-family') || '').split(',')[0].replace(/\"/g, '').replace('inherit', '').replace('initial', '') ||\n\t\t\t\t\t\tnull,\n\t\t\t\t\tfontSize: Number(window.getComputedStyle(cell).getPropertyValue('font-size').replace(/[a-z]/gi, '')),\n\t\t\t\t\tmargin: null,\n\t\t\t\t\tcolspan: Number(cell.getAttribute('colspan')) || null,\n\t\t\t\t\trowspan: Number(cell.getAttribute('rowspan')) || null,\n\t\t\t\t\tvalign: null,\n\t\t\t\t}\n\n\t\t\t\tif (['left', 'center', 'right', 'start', 'end'].indexOf(window.getComputedStyle(cell).getPropertyValue('text-align')) > -1) {\n\t\t\t\t\tlet align = window.getComputedStyle(cell).getPropertyValue('text-align').replace('start', 'left').replace('end', 'right')\n\t\t\t\t\tcellOpts.align = align === 'center' ? 'center' : align === 'left' ? 'left' : align === 'right' ? 'right' : null\n\t\t\t\t}\n\t\t\t\tif (['top', 'middle', 'bottom'].indexOf(window.getComputedStyle(cell).getPropertyValue('vertical-align')) > -1) {\n\t\t\t\t\tlet valign = window.getComputedStyle(cell).getPropertyValue('vertical-align')\n\t\t\t\t\tcellOpts.valign = valign === 'top' ? 'top' : valign === 'middle' ? 'middle' : valign === 'bottom' ? 'bottom' : null\n\t\t\t\t}\n\n\t\t\t\t// C: Add padding [margin] (if any)\n\t\t\t\t// NOTE: Margins translate: px->pt 1:1 (e.g.: a 20px padded cell looks the same in PPTX as 20pt Text Inset/Padding)\n\t\t\t\tif (window.getComputedStyle(cell).getPropertyValue('padding-left')) {\n\t\t\t\t\tcellOpts.margin = [0, 0, 0, 0]\n\t\t\t\t\tlet sidesPad = ['padding-top', 'padding-right', 'padding-bottom', 'padding-left']\n\t\t\t\t\tsidesPad.forEach((val, idxs) => {\n\t\t\t\t\t\tcellOpts.margin[idxs] = Math.round(Number(window.getComputedStyle(cell).getPropertyValue(val).replace(/\\D/gi, '')))\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// D: Add border (if any)\n\t\t\t\tif (\n\t\t\t\t\twindow.getComputedStyle(cell).getPropertyValue('border-top-width') ||\n\t\t\t\t\twindow.getComputedStyle(cell).getPropertyValue('border-right-width') ||\n\t\t\t\t\twindow.getComputedStyle(cell).getPropertyValue('border-bottom-width') ||\n\t\t\t\t\twindow.getComputedStyle(cell).getPropertyValue('border-left-width')\n\t\t\t\t) {\n\t\t\t\t\tcellOpts.border = [null, null, null, null]\n\t\t\t\t\tlet sidesBor = ['top', 'right', 'bottom', 'left']\n\t\t\t\t\tsidesBor.forEach((val, idxb) => {\n\t\t\t\t\t\tlet intBorderW = Math.round(\n\t\t\t\t\t\t\tNumber(\n\t\t\t\t\t\t\t\twindow\n\t\t\t\t\t\t\t\t\t.getComputedStyle(cell)\n\t\t\t\t\t\t\t\t\t.getPropertyValue('border-' + val + '-width')\n\t\t\t\t\t\t\t\t\t.replace('px', '')\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\tlet arrRGB = []\n\t\t\t\t\t\tarrRGB = window\n\t\t\t\t\t\t\t.getComputedStyle(cell)\n\t\t\t\t\t\t\t.getPropertyValue('border-' + val + '-color')\n\t\t\t\t\t\t\t.replace(/\\s+/gi, '')\n\t\t\t\t\t\t\t.replace('rgba(', '')\n\t\t\t\t\t\t\t.replace('rgb(', '')\n\t\t\t\t\t\t\t.replace(')', '')\n\t\t\t\t\t\t\t.split(',')\n\t\t\t\t\t\tlet strBorderC = rgbToHex(Number(arrRGB[0]), Number(arrRGB[1]), Number(arrRGB[2]))\n\t\t\t\t\t\tcellOpts.border[idxb] = { pt: intBorderW, color: strBorderC }\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// LAST: Add cell\n\t\t\t\tarrObjTabCells.push({\n\t\t\t\t\t_type: SLIDE_OBJECT_TYPES.tablecell,\n\t\t\t\t\ttext: cell.innerText, // `innerText` returns <br> as \"\\n\", so linebreak etc. work later!\n\t\t\t\t\toptions: cellOpts,\n\t\t\t\t})\n\t\t\t})\n\t\t\tswitch (part) {\n\t\t\t\tcase 'thead':\n\t\t\t\t\tarrObjTabHeadRows.push(arrObjTabCells)\n\t\t\t\t\tbreak\n\t\t\t\tcase 'tbody':\n\t\t\t\t\tarrObjTabBodyRows.push(arrObjTabCells)\n\t\t\t\t\tbreak\n\t\t\t\tcase 'tfoot':\n\t\t\t\t\tarrObjTabFootRows.push(arrObjTabCells)\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.log(`table parsing: unexpected table part: ${part}`)\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t})\n\t})\n\n\t// STEP 5: Break table into Slides as needed\n\t// Pass head-rows as there is an option to add to each table and the parse func needs this data to fulfill that option\n\topts._arrObjTabHeadRows = arrObjTabHeadRows || null\n\topts.colW = arrColW\n\tgetSlidesForTableRows([...arrObjTabHeadRows, ...arrObjTabBodyRows, ...arrObjTabFootRows], opts, pptx.presLayout, masterSlide).forEach((slide, idxTr) => {\n\t\t// A: Create new Slide\n\t\tlet newSlide = pptx.addSlide({ masterName: opts.masterSlideName || null })\n\n\t\t// B: DESIGN: Reset `y` to startY or margin after first Slide (ISSUE#43, ISSUE#47, ISSUE#48)\n\t\tif (idxTr === 0) opts.y = opts.y || arrInchMargins[0]\n\t\tif (idxTr > 0) opts.y = opts.autoPageSlideStartY || opts.newSlideStartY || arrInchMargins[0]\n\t\tif (opts.verbose) console.log('opts.autoPageSlideStartY:' + opts.autoPageSlideStartY + ' / arrInchMargins[0]:' + arrInchMargins[0] + ' => opts.y = ' + opts.y)\n\n\t\t// C: Add table to Slide\n\t\tnewSlide.addTable(slide.rows, { x: opts.x || arrInchMargins[3], y: opts.y, w: Number(emuSlideTabW) / EMU, colW: arrColW, autoPage: false })\n\n\t\t// D: Add any additional objects\n\t\tif (opts.addImage) newSlide.addImage({ path: opts.addImage.url, x: opts.addImage.x, y: opts.addImage.y, w: opts.addImage.w, h: opts.addImage.h })\n\t\tif (opts.addShape) newSlide.addShape(opts.addShape.shape, opts.addShape.options || {})\n\t\tif (opts.addTable) newSlide.addTable(opts.addTable.rows, opts.addTable.options || {})\n\t\tif (opts.addText) newSlide.addText(opts.addText.text, opts.addText.options || {})\n\t})\n}\n","/**\n * PptxGenJS: XML Generation\n */\n\nimport {\n\tBULLET_TYPES,\n\tCRLF,\n\tDEF_BULLET_MARGIN,\n\tDEF_CELL_MARGIN_PT,\n\tDEF_PRES_LAYOUT_NAME,\n\tDEF_TEXT_GLOW,\n\tDEF_TEXT_SHADOW,\n\tEMU,\n\tLAYOUT_IDX_SERIES_BASE,\n\tPLACEHOLDER_TYPES,\n\tSLDNUMFLDID,\n\tSLIDE_OBJECT_TYPES,\n} from './core-enums'\nimport {\n\tIPresentationProps,\n\tISlideObject,\n\tISlideRel,\n\tISlideRelChart,\n\tISlideRelMedia,\n\tObjectOptions,\n\tPresSlide,\n\tShadowProps,\n\tSlideLayout,\n\tTableCell,\n\tTableCellProps,\n\tTextProps,\n\tTextPropsOptions,\n} from './core-interfaces'\nimport {\n\tconvertRotationDegrees,\n\tcreateColorElement,\n\tcreateGlowElement,\n\tencodeXmlEntities,\n\tgenXmlColorSelection,\n\tgetSmartParseNumber,\n\tgetUuid,\n\tinch2Emu,\n\tvalToPts,\n} from './gen-utils'\n\nlet imageSizingXml = {\n\tcover: function (imgSize, boxDim) {\n\t\tlet imgRatio = imgSize.h / imgSize.w,\n\t\t\tboxRatio = boxDim.h / boxDim.w,\n\t\t\tisBoxBased = boxRatio > imgRatio,\n\t\t\twidth = isBoxBased ? boxDim.h / imgRatio : boxDim.w,\n\t\t\theight = isBoxBased ? boxDim.h : boxDim.w * imgRatio,\n\t\t\thzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.w / width)),\n\t\t\tvzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.h / height))\n\t\treturn '<a:srcRect l=\"' + hzPerc + '\" r=\"' + hzPerc + '\" t=\"' + vzPerc + '\" b=\"' + vzPerc + '\"/><a:stretch/>'\n\t},\n\tcontain: function (imgSize, boxDim) {\n\t\tlet imgRatio = imgSize.h / imgSize.w,\n\t\t\tboxRatio = boxDim.h / boxDim.w,\n\t\t\twidthBased = boxRatio > imgRatio,\n\t\t\twidth = widthBased ? boxDim.w : boxDim.h / imgRatio,\n\t\t\theight = widthBased ? boxDim.w * imgRatio : boxDim.h,\n\t\t\thzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.w / width)),\n\t\t\tvzPerc = Math.round(1e5 * 0.5 * (1 - boxDim.h / height))\n\t\treturn '<a:srcRect l=\"' + hzPerc + '\" r=\"' + hzPerc + '\" t=\"' + vzPerc + '\" b=\"' + vzPerc + '\"/><a:stretch/>'\n\t},\n\tcrop: function (imageSize, boxDim) {\n\t\tlet l = boxDim.x,\n\t\t\tr = imageSize.w - (boxDim.x + boxDim.w),\n\t\t\tt = boxDim.y,\n\t\t\tb = imageSize.h - (boxDim.y + boxDim.h),\n\t\t\tlPerc = Math.round(1e5 * (l / imageSize.w)),\n\t\t\trPerc = Math.round(1e5 * (r / imageSize.w)),\n\t\t\ttPerc = Math.round(1e5 * (t / imageSize.h)),\n\t\t\tbPerc = Math.round(1e5 * (b / imageSize.h))\n\t\treturn '<a:srcRect l=\"' + lPerc + '\" r=\"' + rPerc + '\" t=\"' + tPerc + '\" b=\"' + bPerc + '\"/><a:stretch/>'\n\t},\n}\n\n/**\n * Transforms a slide or slideLayout to resulting XML string - Creates `ppt/slide*.xml`\n * @param {PresSlide|SlideLayout} slideObject - slide object created within createSlideObject\n * @return {string} XML string with <p:cSld> as the root\n */\nfunction slideObjectToXml(slide: PresSlide | SlideLayout): string {\n\tlet strSlideXml: string = slide._name ? '<p:cSld name=\"' + slide._name + '\">' : '<p:cSld>'\n\tlet intTableNum: number = 1\n\n\t// STEP 1: Add background\n\tif (slide.bkgd) {\n\t\tstrSlideXml += genXmlColorSelection(null, slide.bkgd)\n\t} else if (!slide.bkgd && slide._name && slide._name === DEF_PRES_LAYOUT_NAME) {\n\t\t// NOTE: Default [white] background is needed on slideMaster1.xml to avoid gray background in Keynote (and Finder previews)\n\t\tstrSlideXml += '<p:bg><p:bgRef idx=\"1001\"><a:schemeClr val=\"bg1\"/></p:bgRef></p:bg>'\n\t}\n\n\t// STEP 2: Add background image (using Strech) (if any)\n\tif (slide._bkgdImgRid) {\n\t\t// FIXME: We should be doing this in the slideLayout...\n\t\tstrSlideXml +=\n\t\t\t'<p:bg>' +\n\t\t\t'<p:bgPr><a:blipFill dpi=\"0\" rotWithShape=\"1\">' +\n\t\t\t'<a:blip r:embed=\"rId' +\n\t\t\tslide._bkgdImgRid +\n\t\t\t'\"><a:lum/></a:blip>' +\n\t\t\t'<a:srcRect/><a:stretch><a:fillRect/></a:stretch></a:blipFill>' +\n\t\t\t'<a:effectLst/></p:bgPr>' +\n\t\t\t'</p:bg>'\n\t}\n\n\t// STEP 3: Continue slide by starting spTree node\n\tstrSlideXml += '<p:spTree>'\n\tstrSlideXml += '<p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr>'\n\tstrSlideXml += '<p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/>'\n\tstrSlideXml += '<a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr>'\n\n\t// STEP 4: Loop over all Slide.data objects and add them to this slide\n\tslide._slideObjects.forEach((slideItemObj: ISlideObject, idx: number) => {\n\t\tlet x = 0,\n\t\t\ty = 0,\n\t\t\tcx = getSmartParseNumber('75%', 'X', slide._presLayout),\n\t\t\tcy = 0\n\t\tlet placeholderObj: ISlideObject\n\t\tlet locationAttr = ''\n\n\t\tif (\n\t\t\t(slide as PresSlide)._slideLayout !== undefined &&\n\t\t\t(slide as PresSlide)._slideLayout._slideObjects !== undefined &&\n\t\t\tslideItemObj.options &&\n\t\t\tslideItemObj.options.placeholder\n\t\t) {\n\t\t\tplaceholderObj = (slide as PresSlide)._slideLayout._slideObjects.filter(\n\t\t\t\t(object: ISlideObject) => object.options.placeholder === slideItemObj.options.placeholder\n\t\t\t)[0]\n\t\t}\n\n\t\t// A: Set option vars\n\t\tslideItemObj.options = slideItemObj.options || {}\n\n\t\tif (typeof slideItemObj.options.x !== 'undefined') x = getSmartParseNumber(slideItemObj.options.x, 'X', slide._presLayout)\n\t\tif (typeof slideItemObj.options.y !== 'undefined') y = getSmartParseNumber(slideItemObj.options.y, 'Y', slide._presLayout)\n\t\tif (typeof slideItemObj.options.w !== 'undefined') cx = getSmartParseNumber(slideItemObj.options.w, 'X', slide._presLayout)\n\t\tif (typeof slideItemObj.options.h !== 'undefined') cy = getSmartParseNumber(slideItemObj.options.h, 'Y', slide._presLayout)\n\n\t\t// If using a placeholder then inherit it's position\n\t\tif (placeholderObj) {\n\t\t\tif (placeholderObj.options.x || placeholderObj.options.x === 0) x = getSmartParseNumber(placeholderObj.options.x, 'X', slide._presLayout)\n\t\t\tif (placeholderObj.options.y || placeholderObj.options.y === 0) y = getSmartParseNumber(placeholderObj.options.y, 'Y', slide._presLayout)\n\t\t\tif (placeholderObj.options.w || placeholderObj.options.w === 0) cx = getSmartParseNumber(placeholderObj.options.w, 'X', slide._presLayout)\n\t\t\tif (placeholderObj.options.h || placeholderObj.options.h === 0) cy = getSmartParseNumber(placeholderObj.options.h, 'Y', slide._presLayout)\n\t\t}\n\t\t//\n\t\tif (slideItemObj.options.flipH) locationAttr += ' flipH=\"1\"'\n\t\tif (slideItemObj.options.flipV) locationAttr += ' flipV=\"1\"'\n\t\tif (slideItemObj.options.rotate) locationAttr += ' rot=\"' + convertRotationDegrees(slideItemObj.options.rotate) + '\"'\n\n\t\t// B: Add OBJECT to the current Slide\n\t\tswitch (slideItemObj._type) {\n\t\t\tcase SLIDE_OBJECT_TYPES.table:\n\t\t\t\tlet objTableGrid = {}\n\t\t\t\tlet arrTabRows = slideItemObj.arrTabRows\n\t\t\t\tlet objTabOpts = slideItemObj.options\n\t\t\t\tlet intColCnt = 0,\n\t\t\t\t\tintColW = 0\n\t\t\t\tlet cellOpts: TableCellProps\n\n\t\t\t\t// Calc number of columns\n\t\t\t\t// NOTE: Cells may have a colspan, so merely taking the length of the [0] (or any other) row is not\n\t\t\t\t// ....: sufficient to determine column count. Therefore, check each cell for a colspan and total cols as reqd\n\t\t\t\tarrTabRows[0].forEach(cell => {\n\t\t\t\t\tcellOpts = cell.options || null\n\t\t\t\t\tintColCnt += cellOpts && cellOpts.colspan ? Number(cellOpts.colspan) : 1\n\t\t\t\t})\n\n\t\t\t\t// STEP 1: Start Table XML\n\t\t\t\t// NOTE: Non-numeric cNvPr id values will trigger \"presentation needs repair\" type warning in MS-PPT-2013\n\t\t\t\tlet strXml =\n\t\t\t\t\t'<p:graphicFrame>' +\n\t\t\t\t\t'  <p:nvGraphicFramePr>' +\n\t\t\t\t\t'    <p:cNvPr id=\"' +\n\t\t\t\t\t(intTableNum * slide._slideNum + 1) +\n\t\t\t\t\t'\" name=\"Table ' +\n\t\t\t\t\tintTableNum * slide._slideNum +\n\t\t\t\t\t'\"/>' +\n\t\t\t\t\t'    <p:cNvGraphicFramePr><a:graphicFrameLocks noGrp=\"1\"/></p:cNvGraphicFramePr>' +\n\t\t\t\t\t'    <p:nvPr><p:extLst><p:ext uri=\"{D42A27DB-BD31-4B8C-83A1-F6EECF244321}\"><p14:modId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1579011935\"/></p:ext></p:extLst></p:nvPr>' +\n\t\t\t\t\t'  </p:nvGraphicFramePr>' +\n\t\t\t\t\t'  <p:xfrm>' +\n\t\t\t\t\t'    <a:off x=\"' +\n\t\t\t\t\t(x || (x === 0 ? 0 : EMU)) +\n\t\t\t\t\t'\" y=\"' +\n\t\t\t\t\t(y || (y === 0 ? 0 : EMU)) +\n\t\t\t\t\t'\"/>' +\n\t\t\t\t\t'    <a:ext cx=\"' +\n\t\t\t\t\t(cx || (cx === 0 ? 0 : EMU)) +\n\t\t\t\t\t'\" cy=\"' +\n\t\t\t\t\t(cy || EMU) +\n\t\t\t\t\t'\"/>' +\n\t\t\t\t\t'  </p:xfrm>' +\n\t\t\t\t\t'  <a:graphic>' +\n\t\t\t\t\t'    <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/table\">' +\n\t\t\t\t\t'      <a:tbl>' +\n\t\t\t\t\t'        <a:tblPr/>'\n\t\t\t\t// + '        <a:tblPr bandRow=\"1\"/>';\n\t\t\t\t// TODO: Support banded rows, first/last row, etc.\n\t\t\t\t// NOTE: Banding, etc. only shows when using a table style! (or set alt row color if banding)\n\t\t\t\t// <a:tblPr firstCol=\"0\" firstRow=\"0\" lastCol=\"0\" lastRow=\"0\" bandCol=\"0\" bandRow=\"1\">\n\n\t\t\t\t// STEP 2: Set column widths\n\t\t\t\t// Evenly distribute cols/rows across size provided when applicable (calc them if only overall dimensions were provided)\n\t\t\t\t// A: Col widths provided?\n\t\t\t\tif (Array.isArray(objTabOpts.colW)) {\n\t\t\t\t\tstrXml += '<a:tblGrid>'\n\t\t\t\t\tfor (let col = 0; col < intColCnt; col++) {\n\t\t\t\t\t\tstrXml +=\n\t\t\t\t\t\t\t'<a:gridCol w=\"' +\n\t\t\t\t\t\t\tMath.round(inch2Emu(objTabOpts.colW[col]) || (typeof slideItemObj.options.w === 'number' ? slideItemObj.options.w : 1) / intColCnt) +\n\t\t\t\t\t\t\t'\"/>'\n\t\t\t\t\t}\n\t\t\t\t\tstrXml += '</a:tblGrid>'\n\t\t\t\t}\n\t\t\t\t// B: Table Width provided without colW? Then distribute cols\n\t\t\t\telse {\n\t\t\t\t\tintColW = objTabOpts.colW ? objTabOpts.colW : EMU\n\t\t\t\t\tif (slideItemObj.options.w && !objTabOpts.colW) intColW = Math.round((typeof slideItemObj.options.w === 'number' ? slideItemObj.options.w : 1) / intColCnt)\n\t\t\t\t\tstrXml += '<a:tblGrid>'\n\t\t\t\t\tfor (let colw = 0; colw < intColCnt; colw++) {\n\t\t\t\t\t\tstrXml += '<a:gridCol w=\"' + intColW + '\"/>'\n\t\t\t\t\t}\n\t\t\t\t\tstrXml += '</a:tblGrid>'\n\t\t\t\t}\n\n\t\t\t\t// STEP 3: Build our row arrays into an actual grid to match the XML we will be building next (ISSUE #36)\n\t\t\t\t// Note row arrays can arrive \"lopsided\" as in row1:[1,2,3] row2:[3] when first two cols rowspan!,\n\t\t\t\t// so a simple loop below in XML building wont suffice to build table correctly.\n\t\t\t\t// We have to build an actual grid now\n\t\t\t\t/*\n\t\t\t\t\tEX: (A0:rowspan=3, B1:rowspan=2, C1:colspan=2)\n\n\t\t\t\t\t/------|------|------|------\\\n\t\t\t\t\t|  A0  |  B0  |  C0  |  D0  |\n\t\t\t\t\t|      |  B1  |  C1  |      |\n\t\t\t\t\t|      |      |  C2  |  D2  |\n\t\t\t\t\t\\------|------|------|------/\n\t\t\t\t*/\n\t\t\t\t/*\n\t\t\t\t\tObject ex: key = rowIdx / val = [cells] cellIdx { 0:{type: \"tablecell\", text: Array(1), options: {…}}, 1:... }\n\t\t\t\t\t{0: {…}, 1: {…}, 2: {…}, 3: {…}}\n\t\t\t\t*/\n\t\t\t\tarrTabRows.forEach((row, rIdx) => {\n\t\t\t\t\t// A: Create row if needed (recall one may be created in loop below for rowspans, so dont assume we need to create one each iteration)\n\t\t\t\t\tif (!objTableGrid[rIdx]) objTableGrid[rIdx] = {}\n\n\t\t\t\t\t// B: Loop over all cells\n\t\t\t\t\trow.forEach((cell, cIdx) => {\n\t\t\t\t\t\t// DESIGN: NOTE: Row cell arrays can be \"uneven\" (diff cell count in each) due to rowspan/colspan\n\t\t\t\t\t\t// Therefore, for each cell we run 0->colCount to determine the correct slot for it to reside\n\t\t\t\t\t\t// as the uneven/mixed nature of the data means we cannot use the cIdx value alone.\n\t\t\t\t\t\t// E.g.: the 2nd element in the row array may actually go into the 5th table grid row cell b/c of colspans!\n\t\t\t\t\t\tfor (let idx = 0; cIdx + idx < intColCnt; idx++) {\n\t\t\t\t\t\t\tlet currColIdx = cIdx + idx\n\n\t\t\t\t\t\t\tif (!objTableGrid[rIdx][currColIdx]) {\n\t\t\t\t\t\t\t\t// A: Set this cell\n\t\t\t\t\t\t\t\tobjTableGrid[rIdx][currColIdx] = cell\n\n\t\t\t\t\t\t\t\t// B: Handle `colspan` or `rowspan` (a {cell} cant have both! TODO: FUTURE: ROWSPAN & COLSPAN in same cell)\n\t\t\t\t\t\t\t\tif (cell && cell.options && cell.options.colspan && !isNaN(Number(cell.options.colspan))) {\n\t\t\t\t\t\t\t\t\tfor (let idy = 1; idy < Number(cell.options.colspan); idy++) {\n\t\t\t\t\t\t\t\t\t\tobjTableGrid[rIdx][currColIdx + idy] = { _hmerge: true, text: 'hmerge' }\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if (cell && cell.options && cell.options.rowspan && !isNaN(Number(cell.options.rowspan))) {\n\t\t\t\t\t\t\t\t\tfor (let idz = 1; idz < Number(cell.options.rowspan); idz++) {\n\t\t\t\t\t\t\t\t\t\tif (!objTableGrid[rIdx + idz]) objTableGrid[rIdx + idz] = {}\n\t\t\t\t\t\t\t\t\t\tobjTableGrid[rIdx + idz][currColIdx] = { _vmerge: true, text: 'vmerge' }\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// C: Break out of colCnt loop now that slot has been filled\n\t\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\n\t\t\t\t/* DEBUG: useful for rowspan/colspan testing\n\t\t\t\tif ( objTabOpts.verbose ) {\n\t\t\t\t\tconsole.table(objTableGrid);\n\t\t\t\t\tlet arrText = [];\n\t\t\t\t\tobjTableGrid.forEach(function(row){ let arrRow = []; row.forEach(row,function(cell){ arrRow.push(cell.text); }); arrText.push(arrRow); });\n\t\t\t\t\tconsole.table( arrText );\n\t\t\t\t}\n\t\t\t\t*/\n\n\t\t\t\t// STEP 4: Build table rows/cells\n\t\t\t\tObject.entries(objTableGrid).forEach(([rIdx, rowObj]) => {\n\t\t\t\t\t// A: Table Height provided without rowH? Then distribute rows\n\t\t\t\t\tlet intRowH = 0 // IMPORTANT: Default must be zero for auto-sizing to work\n\t\t\t\t\tif (Array.isArray(objTabOpts.rowH) && objTabOpts.rowH[rIdx]) intRowH = inch2Emu(Number(objTabOpts.rowH[rIdx]))\n\t\t\t\t\telse if (objTabOpts.rowH && !isNaN(Number(objTabOpts.rowH))) intRowH = inch2Emu(Number(objTabOpts.rowH))\n\t\t\t\t\telse if (slideItemObj.options.cy || slideItemObj.options.h)\n\t\t\t\t\t\tintRowH = Math.round(\n\t\t\t\t\t\t\t(slideItemObj.options.h ? inch2Emu(slideItemObj.options.h) : typeof slideItemObj.options.cy === 'number' ? slideItemObj.options.cy : 1) /\n\t\t\t\t\t\t\t\tarrTabRows.length\n\t\t\t\t\t\t)\n\n\t\t\t\t\t// B: Start row\n\t\t\t\t\tstrXml += `<a:tr h=\"${intRowH}\">`\n\n\t\t\t\t\t// C: Loop over each CELL\n\t\t\t\t\tObject.entries(rowObj).forEach(([_cIdx, cellObj]) => {\n\t\t\t\t\t\tlet cell: TableCell = cellObj\n\n\t\t\t\t\t\t// 1: \"_hmerge\" cells are just place-holders in the table grid - skip those and go to next cell\n\t\t\t\t\t\tif (cell._hmerge) return\n\n\t\t\t\t\t\t// 2: OPTIONS: Build/set cell options\n\t\t\t\t\t\tlet cellOpts = cell.options || ({} as TableCell['options'])\n\t\t\t\t\t\tcell.options = cellOpts\n\n\t\t\t\t\t\t// B: Inherit some options from table when cell options dont exist\n\t\t\t\t\t\t// @see: http://officeopenxml.com/drwTableCellProperties-alignment.php\n\t\t\t\t\t\t;['align', 'bold', 'border', 'color', 'fill', 'fontFace', 'fontSize', 'margin', 'underline', 'valign'].forEach(name => {\n\t\t\t\t\t\t\tif (objTabOpts[name] && !cellOpts[name] && cellOpts[name] !== 0) cellOpts[name] = objTabOpts[name]\n\t\t\t\t\t\t})\n\n\t\t\t\t\t\tlet cellValign = cellOpts.valign\n\t\t\t\t\t\t\t? ' anchor=\"' +\n\t\t\t\t\t\t\t  cellOpts.valign\n\t\t\t\t\t\t\t\t\t.replace(/^c$/i, 'ctr')\n\t\t\t\t\t\t\t\t\t.replace(/^m$/i, 'ctr')\n\t\t\t\t\t\t\t\t\t.replace('center', 'ctr')\n\t\t\t\t\t\t\t\t\t.replace('middle', 'ctr')\n\t\t\t\t\t\t\t\t\t.replace('top', 't')\n\t\t\t\t\t\t\t\t\t.replace('btm', 'b')\n\t\t\t\t\t\t\t\t\t.replace('bottom', 'b') +\n\t\t\t\t\t\t\t  '\"'\n\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\tlet cellColspan = cellOpts.colspan ? ` gridSpan=\"${cellOpts.colspan}\"` : ''\n\t\t\t\t\t\tlet cellRowspan = cellOpts.rowspan ? ` rowSpan=\"${cellOpts.rowspan}\"` : ''\n\t\t\t\t\t\tlet fillColor =\n\t\t\t\t\t\t\tcell._optImp && cell._optImp.fill && cell._optImp.fill.color\n\t\t\t\t\t\t\t\t? cell._optImp.fill.color\n\t\t\t\t\t\t\t\t: cell._optImp && cell._optImp.fill && typeof cell._optImp.fill === 'string'\n\t\t\t\t\t\t\t\t? cell._optImp.fill\n\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\tfillColor =\n\t\t\t\t\t\t\tfillColor || (cellOpts.fill && cellOpts.fill.color) ? cellOpts.fill.color : cellOpts.fill && typeof cellOpts.fill === 'string' ? cellOpts.fill : ''\n\t\t\t\t\t\tlet cellFill = fillColor ? `<a:solidFill>${createColorElement(fillColor)}</a:solidFill>` : ''\n\t\t\t\t\t\tlet cellMargin = cellOpts.margin === 0 || cellOpts.margin ? cellOpts.margin : DEF_CELL_MARGIN_PT\n\t\t\t\t\t\tif (!Array.isArray(cellMargin) && typeof cellMargin === 'number') cellMargin = [cellMargin, cellMargin, cellMargin, cellMargin]\n\t\t\t\t\t\tlet cellMarginXml = ` marL=\"${valToPts(cellMargin[3])}\" marR=\"${valToPts(cellMargin[1])}\" marT=\"${valToPts(cellMargin[0])}\" marB=\"${valToPts(\n\t\t\t\t\t\t\tcellMargin[2]\n\t\t\t\t\t\t)}\"`\n\n\t\t\t\t\t\t// FUTURE: Cell NOWRAP property (text wrap: add to a:tcPr (horzOverflow=\"overflow\" or whatever options exist)\n\n\t\t\t\t\t\t// 3: ROWSPAN: Add dummy cells for any active rowspan\n\t\t\t\t\t\tif (cell._vmerge) {\n\t\t\t\t\t\t\tstrXml += '<a:tc vMerge=\"1\"><a:tcPr/></a:tc>'\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// 4: Set CELL content and properties ==================================\n\t\t\t\t\t\tstrXml += `<a:tc${cellColspan}${cellRowspan}>${genXmlTextBody(cell)}<a:tcPr${cellMarginXml}${cellValign}>`\n\t\t\t\t\t\t//strXml += `<a:tc${cellColspan}${cellRowspan}>${genXmlTextBody(cell)}<a:tcPr${cellMarginXml}${cellValign}${cellTextDir}>`\n\t\t\t\t\t\t// FIXME: 20200525: ^^^\n\t\t\t\t\t\t// <a:tcPr marL=\"38100\" marR=\"38100\" marT=\"38100\" marB=\"38100\" vert=\"vert270\">\n\n\t\t\t\t\t\t// 5: Borders: Add any borders\n\t\t\t\t\t\tif (cellOpts.border && Array.isArray(cellOpts.border)) {\n\t\t\t\t\t\t\t// NOTE: *** IMPORTANT! *** LRTB order matters! (Reorder a line below to watch the borders go wonky in MS-PPT-2013!!)\n\t\t\t\t\t\t\t;[\n\t\t\t\t\t\t\t\t{ idx: 3, name: 'lnL' },\n\t\t\t\t\t\t\t\t{ idx: 1, name: 'lnR' },\n\t\t\t\t\t\t\t\t{ idx: 0, name: 'lnT' },\n\t\t\t\t\t\t\t\t{ idx: 2, name: 'lnB' },\n\t\t\t\t\t\t\t].forEach(obj => {\n\t\t\t\t\t\t\t\tif (cellOpts.border[obj.idx].type !== 'none') {\n\t\t\t\t\t\t\t\t\tstrXml += `<a:${obj.name} w=\"${valToPts(cellOpts.border[obj.idx].pt)}\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\">`\n\t\t\t\t\t\t\t\t\tstrXml += `<a:solidFill>${createColorElement(cellOpts.border[obj.idx].color)}</a:solidFill>`\n\t\t\t\t\t\t\t\t\tstrXml += `<a:prstDash val=\"${\n\t\t\t\t\t\t\t\t\t\tcellOpts.border[obj.idx].type === 'dash' ? 'sysDash' : 'solid'\n\t\t\t\t\t\t\t\t\t}\"/><a:round/><a:headEnd type=\"none\" w=\"med\" len=\"med\"/><a:tailEnd type=\"none\" w=\"med\" len=\"med\"/>`\n\t\t\t\t\t\t\t\t\tstrXml += `</a:${obj.name}>`\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tstrXml += `<a:${obj.name} w=\"0\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:noFill/></a:${obj.name}>`\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// 6: Close cell Properties & Cell\n\t\t\t\t\t\tstrXml += cellFill\n\t\t\t\t\t\tstrXml += '  </a:tcPr>'\n\t\t\t\t\t\tstrXml += ' </a:tc>'\n\n\t\t\t\t\t\t// LAST: COLSPAN: Add a 'merged' col for each column being merged (SEE: http://officeopenxml.com/drwTableGrid.php)\n\t\t\t\t\t\tif (cellOpts.colspan) {\n\t\t\t\t\t\t\tfor (let tmp = 1; tmp < Number(cellOpts.colspan); tmp++) {\n\t\t\t\t\t\t\t\tstrXml += '<a:tc hMerge=\"1\"><a:tcPr/></a:tc>'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\t// D: Complete row\n\t\t\t\t\tstrXml += '</a:tr>'\n\t\t\t\t})\n\n\t\t\t\t// STEP 5: Complete table\n\t\t\t\tstrXml += '      </a:tbl>'\n\t\t\t\tstrXml += '    </a:graphicData>'\n\t\t\t\tstrXml += '  </a:graphic>'\n\t\t\t\tstrXml += '</p:graphicFrame>'\n\n\t\t\t\t// STEP 6: Set table XML\n\t\t\t\tstrSlideXml += strXml\n\n\t\t\t\t// LAST: Increment counter\n\t\t\t\tintTableNum++\n\t\t\t\tbreak\n\n\t\t\tcase SLIDE_OBJECT_TYPES.text:\n\t\t\tcase SLIDE_OBJECT_TYPES.placeholder:\n\t\t\t\tlet shapeName = slideItemObj.options.shapeName ? encodeXmlEntities(slideItemObj.options.shapeName) : `Object${idx + 1}`\n\n\t\t\t\t// Lines can have zero cy, but text should not\n\t\t\t\tif (!slideItemObj.options.line && cy === 0) cy = EMU * 0.3\n\n\t\t\t\t// Margin/Padding/Inset for textboxes\n\t\t\t\tif (slideItemObj.options.margin && Array.isArray(slideItemObj.options.margin)) {\n\t\t\t\t\tslideItemObj.options._bodyProp.lIns = valToPts(slideItemObj.options.margin[0] || 0)\n\t\t\t\t\tslideItemObj.options._bodyProp.rIns = valToPts(slideItemObj.options.margin[1] || 0)\n\t\t\t\t\tslideItemObj.options._bodyProp.bIns = valToPts(slideItemObj.options.margin[2] || 0)\n\t\t\t\t\tslideItemObj.options._bodyProp.tIns = valToPts(slideItemObj.options.margin[3] || 0)\n\t\t\t\t} else if (typeof slideItemObj.options.margin === 'number') {\n\t\t\t\t\tslideItemObj.options._bodyProp.lIns = valToPts(slideItemObj.options.margin)\n\t\t\t\t\tslideItemObj.options._bodyProp.rIns = valToPts(slideItemObj.options.margin)\n\t\t\t\t\tslideItemObj.options._bodyProp.bIns = valToPts(slideItemObj.options.margin)\n\t\t\t\t\tslideItemObj.options._bodyProp.tIns = valToPts(slideItemObj.options.margin)\n\t\t\t\t}\n\n\t\t\t\t// A: Start SHAPE =======================================================\n\t\t\t\tstrSlideXml += '<p:sp>'\n\n\t\t\t\t// B: The addition of the \"txBox\" attribute is the sole determiner of if an object is a shape or textbox\n\t\t\t\tstrSlideXml += `<p:nvSpPr><p:cNvPr id=\"${idx + 2}\" name=\"${shapeName}\">`\n\t\t\t\t// <Hyperlink>\n\t\t\t\tif (slideItemObj.options.hyperlink && slideItemObj.options.hyperlink.url)\n\t\t\t\t\tstrSlideXml +=\n\t\t\t\t\t\t'<a:hlinkClick r:id=\"rId' +\n\t\t\t\t\t\tslideItemObj.options.hyperlink._rId +\n\t\t\t\t\t\t'\" tooltip=\"' +\n\t\t\t\t\t\t(slideItemObj.options.hyperlink.tooltip ? encodeXmlEntities(slideItemObj.options.hyperlink.tooltip) : '') +\n\t\t\t\t\t\t'\"/>'\n\t\t\t\tif (slideItemObj.options.hyperlink && slideItemObj.options.hyperlink.slide)\n\t\t\t\t\tstrSlideXml +=\n\t\t\t\t\t\t'<a:hlinkClick r:id=\"rId' +\n\t\t\t\t\t\tslideItemObj.options.hyperlink._rId +\n\t\t\t\t\t\t'\" tooltip=\"' +\n\t\t\t\t\t\t(slideItemObj.options.hyperlink.tooltip ? encodeXmlEntities(slideItemObj.options.hyperlink.tooltip) : '') +\n\t\t\t\t\t\t'\" action=\"ppaction://hlinksldjump\"/>'\n\t\t\t\t// </Hyperlink>\n\t\t\t\tstrSlideXml += '</p:cNvPr>'\n\t\t\t\tstrSlideXml += '<p:cNvSpPr' + (slideItemObj.options && slideItemObj.options.isTextBox ? ' txBox=\"1\"/>' : '/>')\n\t\t\t\tstrSlideXml += `<p:nvPr>${slideItemObj._type === 'placeholder' ? genXmlPlaceholder(slideItemObj) : genXmlPlaceholder(placeholderObj)}</p:nvPr>`\n\t\t\t\tstrSlideXml += '</p:nvSpPr><p:spPr>'\n\t\t\t\tstrSlideXml += `<a:xfrm${locationAttr}>`\n\t\t\t\tstrSlideXml += `<a:off x=\"${x}\" y=\"${y}\"/>`\n\t\t\t\tstrSlideXml += `<a:ext cx=\"${cx}\" cy=\"${cy}\"/></a:xfrm>`\n\t\t\t\tstrSlideXml +=\n\t\t\t\t\t'<a:prstGeom prst=\"' +\n\t\t\t\t\tslideItemObj.shape +\n\t\t\t\t\t'\"><a:avLst>' +\n\t\t\t\t\t(slideItemObj.options.rectRadius\n\t\t\t\t\t\t? '<a:gd name=\"adj\" fmla=\"val ' + Math.round((slideItemObj.options.rectRadius * EMU * 100000) / Math.min(cx, cy)) + '\"/>'\n\t\t\t\t\t\t: '') +\n\t\t\t\t\t'</a:avLst></a:prstGeom>'\n\n\t\t\t\t// Option: FILL\n\t\t\t\tstrSlideXml += slideItemObj.options.fill ? genXmlColorSelection(slideItemObj.options.fill) : '<a:noFill/>'\n\n\t\t\t\t// shape Type: LINE: line color\n\t\t\t\tif (slideItemObj.options.line) {\n\t\t\t\t\tstrSlideXml += slideItemObj.options.line.width ? `<a:ln w=\"${valToPts(slideItemObj.options.line.width)}\">` : '<a:ln>'\n\t\t\t\t\tstrSlideXml += genXmlColorSelection(slideItemObj.options.line.color)\n\t\t\t\t\tif (slideItemObj.options.line.dashType) strSlideXml += `<a:prstDash val=\"${slideItemObj.options.line.dashType}\"/>`\n\t\t\t\t\tif (slideItemObj.options.line.beginArrowType) strSlideXml += `<a:headEnd type=\"${slideItemObj.options.line.beginArrowType}\"/>`\n\t\t\t\t\tif (slideItemObj.options.line.endArrowType) strSlideXml += `<a:tailEnd type=\"${slideItemObj.options.line.endArrowType}\"/>`\n\t\t\t\t\t// FUTURE: `endArrowSize` < a: headEnd type = \"arrow\" w = \"lg\" len = \"lg\" /> 'sm' | 'med' | 'lg'(values are 1 - 9, making a 3x3 grid of w / len possibilities)\n\t\t\t\t\tstrSlideXml += '</a:ln>'\n\t\t\t\t}\n\n\t\t\t\t// EFFECTS > SHADOW: REF: @see http://officeopenxml.com/drwSp-effects.php\n\t\t\t\tif (slideItemObj.options.shadow) {\n\t\t\t\t\tslideItemObj.options.shadow.type = slideItemObj.options.shadow.type || 'outer'\n\t\t\t\t\tslideItemObj.options.shadow.blur = valToPts(slideItemObj.options.shadow.blur || 8)\n\t\t\t\t\tslideItemObj.options.shadow.offset = valToPts(slideItemObj.options.shadow.offset || 4)\n\t\t\t\t\tslideItemObj.options.shadow.angle = Math.round((slideItemObj.options.shadow.angle || 270) * 60000)\n\t\t\t\t\tslideItemObj.options.shadow.opacity = Math.round((slideItemObj.options.shadow.opacity || 0.75) * 100000)\n\t\t\t\t\tslideItemObj.options.shadow.color = slideItemObj.options.shadow.color || DEF_TEXT_SHADOW.color\n\n\t\t\t\t\tstrSlideXml += '<a:effectLst>'\n\t\t\t\t\tstrSlideXml += '<a:' + slideItemObj.options.shadow.type + 'Shdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\" '\n\t\t\t\t\tstrSlideXml += ' algn=\"bl\" rotWithShape=\"0\" blurRad=\"' + slideItemObj.options.shadow.blur + '\" '\n\t\t\t\t\tstrSlideXml += ' dist=\"' + slideItemObj.options.shadow.offset + '\" dir=\"' + slideItemObj.options.shadow.angle + '\">'\n\t\t\t\t\tstrSlideXml += '<a:srgbClr val=\"' + slideItemObj.options.shadow.color + '\">'\n\t\t\t\t\tstrSlideXml += '<a:alpha val=\"' + slideItemObj.options.shadow.opacity + '\"/></a:srgbClr>'\n\t\t\t\t\tstrSlideXml += '</a:outerShdw>'\n\t\t\t\t\tstrSlideXml += '</a:effectLst>'\n\t\t\t\t}\n\n\t\t\t\t/* TODO: FUTURE: Text wrapping (copied from MS-PPTX export)\n\t\t\t\t\t// Commented out b/c i'm not even sure this works - current code produces text that wraps in shapes and textboxes, so...\n\t\t\t\t\tif ( slideItemObj.options.textWrap ) {\n\t\t\t\t\t\tstrSlideXml += '<a:extLst>'\n\t\t\t\t\t\t\t\t\t+ '<a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\">'\n\t\t\t\t\t\t\t\t\t+ '<ma14:wrappingTextBoxFlag xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\" val=\"1\"/>'\n\t\t\t\t\t\t\t\t\t+ '</a:ext>'\n\t\t\t\t\t\t\t\t\t+ '</a:extLst>';\n\t\t\t\t\t}\n\t\t\t\t\t*/\n\n\t\t\t\t// B: Close shape Properties\n\t\t\t\tstrSlideXml += '</p:spPr>'\n\n\t\t\t\t// C: Add formatted text (text body \"bodyPr\")\n\t\t\t\tstrSlideXml += genXmlTextBody(slideItemObj)\n\n\t\t\t\t// LAST: Close SHAPE =======================================================\n\t\t\t\tstrSlideXml += '</p:sp>'\n\t\t\t\tbreak\n\n\t\t\tcase SLIDE_OBJECT_TYPES.image:\n\t\t\t\tlet sizing = slideItemObj.options.sizing,\n\t\t\t\t\trounding = slideItemObj.options.rounding,\n\t\t\t\t\twidth = cx,\n\t\t\t\t\theight = cy\n\n\t\t\t\tstrSlideXml += '<p:pic>'\n\t\t\t\tstrSlideXml += '  <p:nvPicPr>'\n\t\t\t\tstrSlideXml += '    <p:cNvPr id=\"' + (idx + 2) + '\" name=\"Object ' + (idx + 1) + '\" descr=\"' + encodeXmlEntities(slideItemObj.image) + '\">'\n\t\t\t\tif (slideItemObj.hyperlink && slideItemObj.hyperlink.url)\n\t\t\t\t\tstrSlideXml +=\n\t\t\t\t\t\t'<a:hlinkClick r:id=\"rId' +\n\t\t\t\t\t\tslideItemObj.hyperlink._rId +\n\t\t\t\t\t\t'\" tooltip=\"' +\n\t\t\t\t\t\t(slideItemObj.hyperlink.tooltip ? encodeXmlEntities(slideItemObj.hyperlink.tooltip) : '') +\n\t\t\t\t\t\t'\"/>'\n\t\t\t\tif (slideItemObj.hyperlink && slideItemObj.hyperlink.slide)\n\t\t\t\t\tstrSlideXml +=\n\t\t\t\t\t\t'<a:hlinkClick r:id=\"rId' +\n\t\t\t\t\t\tslideItemObj.hyperlink._rId +\n\t\t\t\t\t\t'\" tooltip=\"' +\n\t\t\t\t\t\t(slideItemObj.hyperlink.tooltip ? encodeXmlEntities(slideItemObj.hyperlink.tooltip) : '') +\n\t\t\t\t\t\t'\" action=\"ppaction://hlinksldjump\"/>'\n\t\t\t\tstrSlideXml += '    </p:cNvPr>'\n\t\t\t\tstrSlideXml += '    <p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr>'\n\t\t\t\tstrSlideXml += '    <p:nvPr>' + genXmlPlaceholder(placeholderObj) + '</p:nvPr>'\n\t\t\t\tstrSlideXml += '  </p:nvPicPr>'\n\t\t\t\tstrSlideXml += '<p:blipFill>'\n\t\t\t\t// NOTE: This works for both cases: either `path` or `data` contains the SVG\n\t\t\t\tif (\n\t\t\t\t\t(slide._relsMedia || []).filter(rel => rel.rId === slideItemObj.imageRid)[0] &&\n\t\t\t\t\t(slide._relsMedia || []).filter(rel => rel.rId === slideItemObj.imageRid)[0]['extn'] === 'svg'\n\t\t\t\t) {\n\t\t\t\t\tstrSlideXml += '<a:blip r:embed=\"rId' + (slideItemObj.imageRid - 1) + '\">'\n\t\t\t\t\tstrSlideXml += ' <a:extLst>'\n\t\t\t\t\tstrSlideXml += '  <a:ext uri=\"{96DAC541-7B7A-43D3-8B79-37D633B846F1}\">'\n\t\t\t\t\tstrSlideXml += '   <asvg:svgBlip xmlns:asvg=\"http://schemas.microsoft.com/office/drawing/2016/SVG/main\" r:embed=\"rId' + slideItemObj.imageRid + '\"/>'\n\t\t\t\t\tstrSlideXml += '  </a:ext>'\n\t\t\t\t\tstrSlideXml += ' </a:extLst>'\n\t\t\t\t\tstrSlideXml += '</a:blip>'\n\t\t\t\t} else {\n\t\t\t\t\tstrSlideXml += '<a:blip r:embed=\"rId' + slideItemObj.imageRid + '\"/>'\n\t\t\t\t}\n\t\t\t\tif (sizing && sizing.type) {\n\t\t\t\t\tlet boxW = sizing.w ? getSmartParseNumber(sizing.w, 'X', slide._presLayout) : cx,\n\t\t\t\t\t\tboxH = sizing.h ? getSmartParseNumber(sizing.h, 'Y', slide._presLayout) : cy,\n\t\t\t\t\t\tboxX = getSmartParseNumber(sizing.x || 0, 'X', slide._presLayout),\n\t\t\t\t\t\tboxY = getSmartParseNumber(sizing.y || 0, 'Y', slide._presLayout)\n\n\t\t\t\t\tstrSlideXml += imageSizingXml[sizing.type]({ w: width, h: height }, { w: boxW, h: boxH, x: boxX, y: boxY })\n\t\t\t\t\twidth = boxW\n\t\t\t\t\theight = boxH\n\t\t\t\t} else {\n\t\t\t\t\tstrSlideXml += '  <a:stretch><a:fillRect/></a:stretch>'\n\t\t\t\t}\n\t\t\t\tstrSlideXml += '</p:blipFill>'\n\t\t\t\tstrSlideXml += '<p:spPr>'\n\t\t\t\tstrSlideXml += ' <a:xfrm' + locationAttr + '>'\n\t\t\t\tstrSlideXml += '  <a:off x=\"' + x + '\" y=\"' + y + '\"/>'\n\t\t\t\tstrSlideXml += '  <a:ext cx=\"' + width + '\" cy=\"' + height + '\"/>'\n\t\t\t\tstrSlideXml += ' </a:xfrm>'\n\t\t\t\tstrSlideXml += ' <a:prstGeom prst=\"' + (rounding ? 'ellipse' : 'rect') + '\"><a:avLst/></a:prstGeom>'\n\t\t\t\tstrSlideXml += '</p:spPr>'\n\t\t\t\tstrSlideXml += '</p:pic>'\n\t\t\t\tbreak\n\n\t\t\tcase SLIDE_OBJECT_TYPES.media:\n\t\t\t\tif (slideItemObj.mtype === 'online') {\n\t\t\t\t\tstrSlideXml += '<p:pic>'\n\t\t\t\t\tstrSlideXml += ' <p:nvPicPr>'\n\t\t\t\t\t// IMPORTANT: <p:cNvPr id=\"\" value is critical - if not the same number as preview image rId, PowerPoint throws error!\n\t\t\t\t\tstrSlideXml += ' <p:cNvPr id=\"' + (slideItemObj.mediaRid + 2) + '\" name=\"Picture' + (idx + 1) + '\"/>'\n\t\t\t\t\tstrSlideXml += ' <p:cNvPicPr/>'\n\t\t\t\t\tstrSlideXml += ' <p:nvPr>'\n\t\t\t\t\tstrSlideXml += '  <a:videoFile r:link=\"rId' + slideItemObj.mediaRid + '\"/>'\n\t\t\t\t\tstrSlideXml += ' </p:nvPr>'\n\t\t\t\t\tstrSlideXml += ' </p:nvPicPr>'\n\t\t\t\t\t// NOTE: `blip` is diferent than videos; also there's no preview \"p:extLst\" above but exists in videos\n\t\t\t\t\tstrSlideXml += ' <p:blipFill><a:blip r:embed=\"rId' + (slideItemObj.mediaRid + 1) + '\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill>' // NOTE: Preview image is required!\n\t\t\t\t\tstrSlideXml += ' <p:spPr>'\n\t\t\t\t\tstrSlideXml += '  <a:xfrm' + locationAttr + '>'\n\t\t\t\t\tstrSlideXml += '   <a:off x=\"' + x + '\" y=\"' + y + '\"/>'\n\t\t\t\t\tstrSlideXml += '   <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>'\n\t\t\t\t\tstrSlideXml += '  </a:xfrm>'\n\t\t\t\t\tstrSlideXml += '  <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>'\n\t\t\t\t\tstrSlideXml += ' </p:spPr>'\n\t\t\t\t\tstrSlideXml += '</p:pic>'\n\t\t\t\t} else {\n\t\t\t\t\tstrSlideXml += '<p:pic>'\n\t\t\t\t\tstrSlideXml += ' <p:nvPicPr>'\n\t\t\t\t\t// IMPORTANT: <p:cNvPr id=\"\" value is critical - if not the same number as preiew image rId, PowerPoint throws error!\n\t\t\t\t\tstrSlideXml +=\n\t\t\t\t\t\t' <p:cNvPr id=\"' +\n\t\t\t\t\t\t(slideItemObj.mediaRid + 2) +\n\t\t\t\t\t\t'\" name=\"' +\n\t\t\t\t\t\tslideItemObj.media.split('/').pop().split('.').shift() +\n\t\t\t\t\t\t'\"><a:hlinkClick r:id=\"\" action=\"ppaction://media\"/></p:cNvPr>'\n\t\t\t\t\tstrSlideXml += ' <p:cNvPicPr><a:picLocks noChangeAspect=\"1\"/></p:cNvPicPr>'\n\t\t\t\t\tstrSlideXml += ' <p:nvPr>'\n\t\t\t\t\tstrSlideXml += '  <a:videoFile r:link=\"rId' + slideItemObj.mediaRid + '\"/>'\n\t\t\t\t\tstrSlideXml += '  <p:extLst>'\n\t\t\t\t\tstrSlideXml += '   <p:ext uri=\"{DAA4B4D4-6D71-4841-9C94-3DE7FCFB9230}\">'\n\t\t\t\t\tstrSlideXml += '    <p14:media xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" r:embed=\"rId' + (slideItemObj.mediaRid + 1) + '\"/>'\n\t\t\t\t\tstrSlideXml += '   </p:ext>'\n\t\t\t\t\tstrSlideXml += '  </p:extLst>'\n\t\t\t\t\tstrSlideXml += ' </p:nvPr>'\n\t\t\t\t\tstrSlideXml += ' </p:nvPicPr>'\n\t\t\t\t\tstrSlideXml += ' <p:blipFill><a:blip r:embed=\"rId' + (slideItemObj.mediaRid + 2) + '\"/><a:stretch><a:fillRect/></a:stretch></p:blipFill>' // NOTE: Preview image is required!\n\t\t\t\t\tstrSlideXml += ' <p:spPr>'\n\t\t\t\t\tstrSlideXml += '  <a:xfrm' + locationAttr + '>'\n\t\t\t\t\tstrSlideXml += '   <a:off x=\"' + x + '\" y=\"' + y + '\"/>'\n\t\t\t\t\tstrSlideXml += '   <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>'\n\t\t\t\t\tstrSlideXml += '  </a:xfrm>'\n\t\t\t\t\tstrSlideXml += '  <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>'\n\t\t\t\t\tstrSlideXml += ' </p:spPr>'\n\t\t\t\t\tstrSlideXml += '</p:pic>'\n\t\t\t\t}\n\t\t\t\tbreak\n\n\t\t\tcase SLIDE_OBJECT_TYPES.chart:\n\t\t\t\tstrSlideXml += '<p:graphicFrame>'\n\t\t\t\tstrSlideXml += ' <p:nvGraphicFramePr>'\n\t\t\t\tstrSlideXml += '   <p:cNvPr id=\"' + (idx + 2) + '\" name=\"Chart ' + (idx + 1) + '\"/>'\n\t\t\t\tstrSlideXml += '   <p:cNvGraphicFramePr/>'\n\t\t\t\tstrSlideXml += '   <p:nvPr>' + genXmlPlaceholder(placeholderObj) + '</p:nvPr>'\n\t\t\t\tstrSlideXml += ' </p:nvGraphicFramePr>'\n\t\t\t\tstrSlideXml += ' <p:xfrm>'\n\t\t\t\tstrSlideXml += '  <a:off x=\"' + x + '\" y=\"' + y + '\"/>'\n\t\t\t\tstrSlideXml += '  <a:ext cx=\"' + cx + '\" cy=\"' + cy + '\"/>'\n\t\t\t\tstrSlideXml += ' </p:xfrm>'\n\t\t\t\tstrSlideXml += ' <a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\">'\n\t\t\t\tstrSlideXml += '  <a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/chart\">'\n\t\t\t\tstrSlideXml += '   <c:chart r:id=\"rId' + slideItemObj.chartRid + '\" xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\"/>'\n\t\t\t\tstrSlideXml += '  </a:graphicData>'\n\t\t\t\tstrSlideXml += ' </a:graphic>'\n\t\t\t\tstrSlideXml += '</p:graphicFrame>'\n\t\t\t\tbreak\n\n\t\t\tdefault:\n\t\t\t\tstrSlideXml += ''\n\t\t\t\tbreak\n\t\t}\n\t})\n\n\t// STEP 5: Add slide numbers (if any) last\n\tif (slide._slideNumberProps) {\n\t\tstrSlideXml +=\n\t\t\t'<p:sp>' +\n\t\t\t'  <p:nvSpPr>' +\n\t\t\t'    <p:cNvPr id=\"25\" name=\"Slide Number Placeholder 24\"/>' +\n\t\t\t'    <p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr>' +\n\t\t\t'    <p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"4294967295\"/></p:nvPr>' +\n\t\t\t'  </p:nvSpPr>' +\n\t\t\t'  <p:spPr>' +\n\t\t\t'    <a:xfrm>' +\n\t\t\t'      <a:off x=\"' +\n\t\t\tgetSmartParseNumber(slide._slideNumberProps.x, 'X', slide._presLayout) +\n\t\t\t'\" y=\"' +\n\t\t\tgetSmartParseNumber(slide._slideNumberProps.y, 'Y', slide._presLayout) +\n\t\t\t'\"/>' +\n\t\t\t'      <a:ext cx=\"' +\n\t\t\t(slide._slideNumberProps.w ? getSmartParseNumber(slide._slideNumberProps.w, 'X', slide._presLayout) : 800000) +\n\t\t\t'\" cy=\"' +\n\t\t\t(slide._slideNumberProps.h ? getSmartParseNumber(slide._slideNumberProps.h, 'Y', slide._presLayout) : 300000) +\n\t\t\t'\"/>' +\n\t\t\t'    </a:xfrm>' +\n\t\t\t'    <a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom>' +\n\t\t\t'    <a:extLst><a:ext uri=\"{C572A759-6A51-4108-AA02-DFA0A04FC94B}\"><ma14:wrappingTextBoxFlag val=\"0\" xmlns:ma14=\"http://schemas.microsoft.com/office/mac/drawingml/2011/main\"/></a:ext></a:extLst>' +\n\t\t\t'  </p:spPr>'\n\t\tstrSlideXml += '<p:txBody>'\n\t\tstrSlideXml += '  <a:bodyPr/>'\n\t\tstrSlideXml += '  <a:lstStyle><a:lvl1pPr>'\n\t\tif (slide._slideNumberProps.fontFace || slide._slideNumberProps.fontSize || slide._slideNumberProps.color) {\n\t\t\tstrSlideXml += '<a:defRPr sz=\"' + (slide._slideNumberProps.fontSize ? Math.round(slide._slideNumberProps.fontSize) : '12') + '00\">'\n\t\t\tif (slide._slideNumberProps.color) strSlideXml += genXmlColorSelection(slide._slideNumberProps.color)\n\t\t\tif (slide._slideNumberProps.fontFace)\n\t\t\t\tstrSlideXml +=\n\t\t\t\t\t'<a:latin typeface=\"' +\n\t\t\t\t\tslide._slideNumberProps.fontFace +\n\t\t\t\t\t'\"/><a:ea typeface=\"' +\n\t\t\t\t\tslide._slideNumberProps.fontFace +\n\t\t\t\t\t'\"/><a:cs typeface=\"' +\n\t\t\t\t\tslide._slideNumberProps.fontFace +\n\t\t\t\t\t'\"/>'\n\t\t\tstrSlideXml += '</a:defRPr>'\n\t\t}\n\t\tstrSlideXml += '</a:lvl1pPr></a:lstStyle>'\n\t\tstrSlideXml += '<a:p><a:fld id=\"' + SLDNUMFLDID + '\" type=\"slidenum\"><a:rPr lang=\"en-US\"/><a:t></a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p>'\n\t\tstrSlideXml += '</p:txBody></p:sp>'\n\t}\n\n\t// STEP 6: Close spTree and finalize slide XML\n\tstrSlideXml += '</p:spTree>'\n\tstrSlideXml += '</p:cSld>'\n\n\t// LAST: Return\n\treturn strSlideXml\n}\n\n/**\n * Transforms slide relations to XML string.\n * Extra relations that are not dynamic can be passed using the 2nd arg (e.g. theme relation in master file).\n * These relations use rId series that starts with 1-increased maximum of rIds used for dynamic relations.\n * @param {PresSlide | SlideLayout} slide - slide object whose relations are being transformed\n * @param {{ target: string; type: string }[]} defaultRels - array of default relations\n * @return {string} XML\n */\nfunction slideObjectRelationsToXml(slide: PresSlide | SlideLayout, defaultRels: { target: string; type: string }[]): string {\n\tlet lastRid = 0 // stores maximum rId used for dynamic relations\n\tlet strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\n\n\t// STEP 1: Add all rels for this Slide\n\tslide._rels.forEach((rel: ISlideRel) => {\n\t\tlastRid = Math.max(lastRid, rel.rId)\n\t\tif (rel.type.toLowerCase().indexOf('hyperlink') > -1) {\n\t\t\tif (rel.data === 'slide') {\n\t\t\t\tstrXml +=\n\t\t\t\t\t'<Relationship Id=\"rId' +\n\t\t\t\t\trel.rId +\n\t\t\t\t\t'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\"' +\n\t\t\t\t\t' Target=\"slide' +\n\t\t\t\t\trel.Target +\n\t\t\t\t\t'.xml\"/>'\n\t\t\t} else {\n\t\t\t\tstrXml +=\n\t\t\t\t\t'<Relationship Id=\"rId' +\n\t\t\t\t\trel.rId +\n\t\t\t\t\t'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink\"' +\n\t\t\t\t\t' Target=\"' +\n\t\t\t\t\trel.Target +\n\t\t\t\t\t'\" TargetMode=\"External\"/>'\n\t\t\t}\n\t\t} else if (rel.type.toLowerCase().indexOf('notesSlide') > -1) {\n\t\t\tstrXml +=\n\t\t\t\t'<Relationship Id=\"rId' + rel.rId + '\" Target=\"' + rel.Target + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesSlide\"/>'\n\t\t}\n\t})\n\t;(slide._relsChart || []).forEach((rel: ISlideRelChart) => {\n\t\tlastRid = Math.max(lastRid, rel.rId)\n\t\tstrXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart\" Target=\"' + rel.Target + '\"/>'\n\t})\n\t;(slide._relsMedia || []).forEach((rel: ISlideRelMedia) => {\n\t\tlastRid = Math.max(lastRid, rel.rId)\n\t\tif (rel.type.toLowerCase().indexOf('image') > -1) {\n\t\t\tstrXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"' + rel.Target + '\"/>'\n\t\t} else if (rel.type.toLowerCase().indexOf('audio') > -1) {\n\t\t\t// As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\n\t\t\tif (strXml.indexOf(' Target=\"' + rel.Target + '\"') > -1)\n\t\t\t\tstrXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\" Target=\"' + rel.Target + '\"/>'\n\t\t\telse\n\t\t\t\tstrXml +=\n\t\t\t\t\t'<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/audio\" Target=\"' + rel.Target + '\"/>'\n\t\t} else if (rel.type.toLowerCase().indexOf('video') > -1) {\n\t\t\t// As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\n\t\t\tif (strXml.indexOf(' Target=\"' + rel.Target + '\"') > -1)\n\t\t\t\tstrXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\" Target=\"' + rel.Target + '\"/>'\n\t\t\telse\n\t\t\t\tstrXml +=\n\t\t\t\t\t'<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\" Target=\"' + rel.Target + '\"/>'\n\t\t} else if (rel.type.toLowerCase().indexOf('online') > -1) {\n\t\t\t// As media has *TWO* rel entries per item, check for first one, if found add second rel with alt style\n\t\t\tif (strXml.indexOf(' Target=\"' + rel.Target + '\"') > -1)\n\t\t\t\tstrXml += '<Relationship Id=\"rId' + rel.rId + '\" Type=\"http://schemas.microsoft.com/office/2007/relationships/image\" Target=\"' + rel.Target + '\"/>'\n\t\t\telse\n\t\t\t\tstrXml +=\n\t\t\t\t\t'<Relationship Id=\"rId' +\n\t\t\t\t\trel.rId +\n\t\t\t\t\t'\" Target=\"' +\n\t\t\t\t\trel.Target +\n\t\t\t\t\t'\" TargetMode=\"External\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>'\n\t\t}\n\t})\n\n\t// STEP 2: Add default rels\n\tdefaultRels.forEach((rel, idx) => {\n\t\tstrXml += '<Relationship Id=\"rId' + (lastRid + idx + 1) + '\" Type=\"' + rel.type + '\" Target=\"' + rel.target + '\"/>'\n\t})\n\n\tstrXml += '</Relationships>'\n\treturn strXml\n}\n\n/**\n * Generate XML Paragraph Properties\n * @param {ISlideObject|TextProps} textObj - text object\n * @param {boolean} isDefault - array of default relations\n * @return {string} XML\n */\nfunction genXmlParagraphProperties(textObj: ISlideObject | TextProps, isDefault: boolean): string {\n\tlet strXmlBullet = '',\n\t\tstrXmlLnSpc = '',\n\t\tstrXmlParaSpc = ''\n\tlet tag = isDefault ? 'a:lvl1pPr' : 'a:pPr'\n\tlet bulletMarL = valToPts(DEF_BULLET_MARGIN)\n\n\tlet paragraphPropXml = `<${tag}${textObj.options.rtlMode ? ' rtl=\"1\" ' : ''}`\n\n\t// A: Build paragraphProperties\n\t{\n\t\t// OPTION: align\n\t\tif (textObj.options.align) {\n\t\t\tswitch (textObj.options.align) {\n\t\t\t\tcase 'left':\n\t\t\t\t\tparagraphPropXml += ' algn=\"l\"'\n\t\t\t\t\tbreak\n\t\t\t\tcase 'right':\n\t\t\t\t\tparagraphPropXml += ' algn=\"r\"'\n\t\t\t\t\tbreak\n\t\t\t\tcase 'center':\n\t\t\t\t\tparagraphPropXml += ' algn=\"ctr\"'\n\t\t\t\t\tbreak\n\t\t\t\tcase 'justify':\n\t\t\t\t\tparagraphPropXml += ' algn=\"just\"'\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tparagraphPropXml += ''\n\t\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\tif (textObj.options.lineSpacing) strXmlLnSpc = `<a:lnSpc><a:spcPts val=\"${textObj.options.lineSpacing * 100}\"/></a:lnSpc>`\n\n\t\t// OPTION: indent\n\t\tif (textObj.options.indentLevel && !isNaN(Number(textObj.options.indentLevel)) && textObj.options.indentLevel > 0) {\n\t\t\tparagraphPropXml += ` lvl=\"${textObj.options.indentLevel}\"`\n\t\t}\n\n\t\t// OPTION: Paragraph Spacing: Before/After\n\t\tif (textObj.options.paraSpaceBefore && !isNaN(Number(textObj.options.paraSpaceBefore)) && textObj.options.paraSpaceBefore > 0) {\n\t\t\tstrXmlParaSpc += `<a:spcBef><a:spcPts val=\"${textObj.options.paraSpaceBefore * 100}\"/></a:spcBef>`\n\t\t}\n\t\tif (textObj.options.paraSpaceAfter && !isNaN(Number(textObj.options.paraSpaceAfter)) && textObj.options.paraSpaceAfter > 0) {\n\t\t\tstrXmlParaSpc += `<a:spcAft><a:spcPts val=\"${textObj.options.paraSpaceAfter * 100}\"/></a:spcAft>`\n\t\t}\n\n\t\t// OPTION: bullet\n\t\t// NOTE: OOXML uses the unicode character set for Bullets\n\t\t// EX: Unicode Character 'BULLET' (U+2022) ==> '<a:buChar char=\"&#x2022;\"/>'\n\t\tif (typeof textObj.options.bullet === 'object') {\n\t\t\tif (textObj && textObj.options && textObj.options.bullet && textObj.options.bullet.indent) bulletMarL = valToPts(textObj.options.bullet.indent)\n\n\t\t\tif (textObj.options.bullet.type) {\n\t\t\t\tif (textObj.options.bullet.type.toString().toLowerCase() === 'number') {\n\t\t\t\t\tparagraphPropXml += ` marL=\"${\n\t\t\t\t\t\ttextObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletMarL + bulletMarL * textObj.options.indentLevel : bulletMarL\n\t\t\t\t\t}\" indent=\"-${bulletMarL}\"`\n\t\t\t\t\tstrXmlBullet = `<a:buSzPct val=\"100000\"/><a:buFont typeface=\"+mj-lt\"/><a:buAutoNum type=\"${textObj.options.bullet.style || 'arabicPeriod'}\" startAt=\"${\n\t\t\t\t\t\ttextObj.options.bullet.numberStartAt || textObj.options.bullet.startAt || '1'\n\t\t\t\t\t}\"/>`\n\t\t\t\t}\n\t\t\t} else if (textObj.options.bullet.characterCode) {\n\t\t\t\tlet bulletCode = `&#x${textObj.options.bullet.characterCode};`\n\n\t\t\t\t// Check value for hex-ness (s/b 4 char hex)\n\t\t\t\tif (/^[0-9A-Fa-f]{4}$/.test(textObj.options.bullet.characterCode) === false) {\n\t\t\t\t\tconsole.warn('Warning: `bullet.characterCode should be a 4-digit unicode charatcer (ex: 22AB)`!')\n\t\t\t\t\tbulletCode = BULLET_TYPES['DEFAULT']\n\t\t\t\t}\n\n\t\t\t\tparagraphPropXml += ` marL=\"${\n\t\t\t\t\ttextObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletMarL + bulletMarL * textObj.options.indentLevel : bulletMarL\n\t\t\t\t}\" indent=\"-${bulletMarL}\"`\n\t\t\t\tstrXmlBullet = '<a:buSzPct val=\"100000\"/><a:buChar char=\"' + bulletCode + '\"/>'\n\t\t\t} else if (textObj.options.bullet.code) {\n\t\t\t\t// @deprecated `bullet.code` v3.3.0\n\t\t\t\tlet bulletCode = `&#x${textObj.options.bullet.code};`\n\n\t\t\t\t// Check value for hex-ness (s/b 4 char hex)\n\t\t\t\tif (/^[0-9A-Fa-f]{4}$/.test(textObj.options.bullet.code) === false) {\n\t\t\t\t\tconsole.warn('Warning: `bullet.code should be a 4-digit hex code (ex: 22AB)`!')\n\t\t\t\t\tbulletCode = BULLET_TYPES['DEFAULT']\n\t\t\t\t}\n\n\t\t\t\tparagraphPropXml += ` marL=\"${\n\t\t\t\t\ttextObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletMarL + bulletMarL * textObj.options.indentLevel : bulletMarL\n\t\t\t\t}\" indent=\"-${bulletMarL}\"`\n\t\t\t\tstrXmlBullet = '<a:buSzPct val=\"100000\"/><a:buChar char=\"' + bulletCode + '\"/>'\n\t\t\t} else {\n\t\t\t\tparagraphPropXml += ` marL=\"${\n\t\t\t\t\ttextObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletMarL + bulletMarL * textObj.options.indentLevel : bulletMarL\n\t\t\t\t}\" indent=\"-${bulletMarL}\"`\n\t\t\t\tstrXmlBullet = `<a:buSzPct val=\"100000\"/><a:buChar char=\"${BULLET_TYPES['DEFAULT']}\"/>`\n\t\t\t}\n\t\t} else if (textObj.options.bullet === true) {\n\t\t\tparagraphPropXml += ` marL=\"${\n\t\t\t\ttextObj.options.indentLevel && textObj.options.indentLevel > 0 ? bulletMarL + bulletMarL * textObj.options.indentLevel : bulletMarL\n\t\t\t}\" indent=\"-${bulletMarL}\"`\n\t\t\tstrXmlBullet = `<a:buSzPct val=\"100000\"/><a:buChar char=\"${BULLET_TYPES['DEFAULT']}\"/>`\n\t\t} else if (textObj.options.bullet === false) {\n\t\t\t// We only add this when the user explicitely asks for no bullet, otherwise, it can override the master defaults!\n\t\t\tparagraphPropXml += ` indent=\"0\" marL=\"0\"` // FIX: ISSUE#589 - specify zero indent and marL or default will be hanging paragraph\n\t\t\tstrXmlBullet = '<a:buNone/>'\n\t\t}\n\n\t\t// B: Close Paragraph-Properties\n\t\t// IMPORTANT: strXmlLnSpc, strXmlParaSpc, and strXmlBullet require strict ordering - anything out of order is ignored. (PPT-Online, PPT for Mac)\n\t\tparagraphPropXml += '>' + strXmlLnSpc + strXmlParaSpc + strXmlBullet\n\t\tif (isDefault) paragraphPropXml += genXmlTextRunProperties(textObj.options, true)\n\t\tparagraphPropXml += '</' + tag + '>'\n\t}\n\n\treturn paragraphPropXml\n}\n\n/**\n * Generate XML Text Run Properties (`a:rPr`)\n * @param {ObjectOptions|TextPropsOptions} opts - text options\n * @param {boolean} isDefault - whether these are the default text run properties\n * @return {string} XML\n */\nfunction genXmlTextRunProperties(opts: ObjectOptions | TextPropsOptions, isDefault: boolean): string {\n\tlet runProps = ''\n\tlet runPropsTag = isDefault ? 'a:defRPr' : 'a:rPr'\n\n\t// BEGIN runProperties (ex: `<a:rPr lang=\"en-US\" sz=\"1600\" b=\"1\" dirty=\"0\">`)\n\trunProps += '<' + runPropsTag + ' lang=\"' + (opts.lang ? opts.lang : 'en-US') + '\"' + (opts.lang ? ' altLang=\"en-US\"' : '')\n\trunProps += opts.fontSize ? ' sz=\"' + Math.round(opts.fontSize) + '00\"' : '' // NOTE: Use round so sizes like '7.5' wont cause corrupt pres.\n\trunProps += opts.bold ? ' b=\"1\"' : ''\n\trunProps += opts.italic ? ' i=\"1\"' : ''\n\trunProps += opts.strike ? ' strike=\"sngStrike\"' : ''\n\trunProps += opts.underline || opts.hyperlink ? ' u=\"sng\"' : ''\n\trunProps += opts.subscript ? ' baseline=\"-40000\"' : opts.superscript ? ' baseline=\"30000\"' : ''\n\trunProps += opts.charSpacing ? ' spc=\"' + opts.charSpacing * 100 + '\" kern=\"0\"' : '' // IMPORTANT: Also disable kerning; otherwise text won't actually expand\n\trunProps += ' dirty=\"0\">'\n\t// Color / Font / Outline are children of <a:rPr>, so add them now before closing the runProperties tag\n\tif (opts.color || opts.fontFace || opts.outline) {\n\t\tif (opts.outline && typeof opts.outline === 'object') {\n\t\t\trunProps += `<a:ln w=\"${valToPts(opts.outline.size || 0.75)}\">${genXmlColorSelection(opts.outline.color || 'FFFFFF')}</a:ln>`\n\t\t}\n\t\tif (opts.color) runProps += genXmlColorSelection(opts.color)\n\t\tif (opts.glow) runProps += `<a:effectLst>${createGlowElement(opts.glow, DEF_TEXT_GLOW)}</a:effectLst>`\n\t\tif (opts.fontFace) {\n\t\t\t// NOTE: 'cs' = Complex Script, 'ea' = East Asian (use \"-120\" instead of \"0\" - per Issue #174); ea must come first (Issue #174)\n\t\t\trunProps += `<a:latin typeface=\"${opts.fontFace}\" pitchFamily=\"34\" charset=\"0\"/><a:ea typeface=\"${opts.fontFace}\" pitchFamily=\"34\" charset=\"-122\"/><a:cs typeface=\"${opts.fontFace}\" pitchFamily=\"34\" charset=\"-120\"/>`\n\t\t}\n\t}\n\n\t// Hyperlink support\n\tif (opts.hyperlink) {\n\t\tif (typeof opts.hyperlink !== 'object') throw new Error(\"ERROR: text `hyperlink` option should be an object. Ex: `hyperlink:{url:'https://github.com'}` \")\n\t\telse if (!opts.hyperlink.url && !opts.hyperlink.slide) throw new Error(\"ERROR: 'hyperlink requires either `url` or `slide`'\")\n\t\telse if (opts.hyperlink.url) {\n\t\t\t// TODO: (20170410): FUTURE-FEATURE: color (link is always blue in Keynote and PPT online, so usual text run above isnt honored for links..?)\n\t\t\t//runProps += '<a:uFill>'+ genXmlColorSelection('0000FF') +'</a:uFill>'; // Breaks PPT2010! (Issue#74)\n\t\t\trunProps += `<a:hlinkClick r:id=\"rId${opts.hyperlink._rId}\" invalidUrl=\"\" action=\"\" tgtFrame=\"\" tooltip=\"${\n\t\t\t\topts.hyperlink.tooltip ? encodeXmlEntities(opts.hyperlink.tooltip) : ''\n\t\t\t}\" history=\"1\" highlightClick=\"0\" endSnd=\"0\"/>`\n\t\t} else if (opts.hyperlink.slide) {\n\t\t\trunProps += `<a:hlinkClick r:id=\"rId${opts.hyperlink._rId}\" action=\"ppaction://hlinksldjump\" tooltip=\"${\n\t\t\t\topts.hyperlink.tooltip ? encodeXmlEntities(opts.hyperlink.tooltip) : ''\n\t\t\t}\"/>`\n\t\t}\n\t}\n\n\t// END runProperties\n\trunProps += `</${runPropsTag}>`\n\n\treturn runProps\n}\n\n/**\n * Build textBody text runs [`<a:r></a:r>`] for paragraphs [`<a:p>`]\n * @param {TextProps} textObj - Text object\n * @return {string} XML string\n */\nfunction genXmlTextRun(textObj: TextProps): string {\n\t// NOTE: Dont create full rPr runProps for empty [lineBreak] runs\n\t// Why? The size of the lineBreak wont match (eg: below it will be 18px instead of the correct 36px)\n\t// Do this:\n\t/*\n\t\t<a:p>\n\t\t\t<a:pPr algn=\"r\"/>\n\t\t\t<a:endParaRPr lang=\"en-US\" sz=\"3600\" dirty=\"0\"/>\n\t\t</a:p>\n\t*/\n\t// NOT this:\n\t/*\n\t\t<a:p>\n\t\t\t<a:pPr algn=\"r\"/>\n\t\t\t<a:r>\n\t\t\t\t<a:rPr lang=\"en-US\" sz=\"3600\" dirty=\"0\">\n\t\t\t\t\t<a:solidFill>\n\t\t\t\t\t\t<a:schemeClr val=\"accent5\"/>\n\t\t\t\t\t</a:solidFill>\n\t\t\t\t\t<a:latin typeface=\"Times\" pitchFamily=\"34\" charset=\"0\"/>\n\t\t\t\t\t<a:ea typeface=\"Times\" pitchFamily=\"34\" charset=\"-122\"/>\n\t\t\t\t\t<a:cs typeface=\"Times\" pitchFamily=\"34\" charset=\"-120\"/>\n\t\t\t\t</a:rPr>\n\t\t\t\t<a:t></a:t>\n\t\t\t</a:r>\n\t\t\t<a:endParaRPr lang=\"en-US\" dirty=\"0\"/>\n\t\t</a:p>\n\t*/\n\n\t// Return paragraph with text run\n\treturn textObj.text ? `<a:r>${genXmlTextRunProperties(textObj.options, false)}<a:t>${encodeXmlEntities(textObj.text)}</a:t></a:r>` : ''\n}\n\n/**\n * Builds `<a:bodyPr></a:bodyPr>` tag for \"genXmlTextBody()\"\n * @param {ISlideObject | TableCell} slideObject - various options\n * @return {string} XML string\n */\nfunction genXmlBodyProperties(slideObject: ISlideObject | TableCell): string {\n\tlet bodyProperties = '<a:bodyPr'\n\n\tif (slideObject && slideObject._type === SLIDE_OBJECT_TYPES.text && slideObject.options._bodyProp) {\n\t\t// PPT-2019 EX: <a:bodyPr wrap=\"square\" lIns=\"1270\" tIns=\"1270\" rIns=\"1270\" bIns=\"1270\" rtlCol=\"0\" anchor=\"ctr\"/>\n\n\t\t// A: Enable or disable textwrapping none or square\n\t\tbodyProperties += slideObject.options._bodyProp.wrap ? ' wrap=\"' + slideObject.options._bodyProp.wrap + '\"' : ' wrap=\"square\"'\n\n\t\t// B: Textbox margins [padding]\n\t\tif (slideObject.options._bodyProp.lIns || slideObject.options._bodyProp.lIns === 0) bodyProperties += ' lIns=\"' + slideObject.options._bodyProp.lIns + '\"'\n\t\tif (slideObject.options._bodyProp.tIns || slideObject.options._bodyProp.tIns === 0) bodyProperties += ' tIns=\"' + slideObject.options._bodyProp.tIns + '\"'\n\t\tif (slideObject.options._bodyProp.rIns || slideObject.options._bodyProp.rIns === 0) bodyProperties += ' rIns=\"' + slideObject.options._bodyProp.rIns + '\"'\n\t\tif (slideObject.options._bodyProp.bIns || slideObject.options._bodyProp.bIns === 0) bodyProperties += ' bIns=\"' + slideObject.options._bodyProp.bIns + '\"'\n\n\t\t// C: Add rtl after margins\n\t\tbodyProperties += ' rtlCol=\"0\"'\n\n\t\t// D: Add anchorPoints\n\t\tif (slideObject.options._bodyProp.anchor) bodyProperties += ' anchor=\"' + slideObject.options._bodyProp.anchor + '\"' // VALS: [t,ctr,b]\n\t\tif (slideObject.options._bodyProp.vert) bodyProperties += ' vert=\"' + slideObject.options._bodyProp.vert + '\"' // VALS: [eaVert,horz,mongolianVert,vert,vert270,wordArtVert,wordArtVertRtl]\n\n\t\t// E: Close <a:bodyPr element\n\t\tbodyProperties += '>'\n\n\t\t/**\n\t\t * F: Text Fit/AutoFit/Shrink option\n\t\t * @see: http://officeopenxml.com/drwSp-text-bodyPr-fit.php\n\t\t * @see: http://www.datypic.com/sc/ooxml/g-a_EG_TextAutofit.html\n\t\t */\n\t\tif (slideObject.options.fit) {\n\t\t\t// NOTE: Use of '<a:noAutofit/>' instead of '' causes issues in PPT-2013!\n\t\t\tif (slideObject.options.fit === 'none') bodyProperties += ''\n\t\t\t// NOTE: Shrink does not work automatically - PowerPoint calculates the `fontScale` value dynamically upon resize\n\t\t\t//else if (slideObject.options.fit === 'shrink') bodyProperties += '<a:normAutofit fontScale=\"85000\" lnSpcReduction=\"20000\"/>' // MS-PPT > Format shape > Text Options: \"Shrink text on overflow\"\n\t\t\telse if (slideObject.options.fit === 'shrink') bodyProperties += '<a:normAutofit/>'\n\t\t\telse if (slideObject.options.fit === 'resize') bodyProperties += '<a:spAutoFit/>'\n\t\t}\n\t\t//\n\t\t// DEPRECATED: below (@deprecated v3.3.0)\n\t\tif (slideObject.options.shrinkText) bodyProperties += '<a:normAutofit/>' // MS-PPT > Format shape > Text Options: \"Shrink text on overflow\"\n\t\t/* DEPRECATED: below (@deprecated v3.3.0)\n\t\t * MS-PPT > Format shape > Text Options: \"Resize shape to fit text\" [spAutoFit]\n\t\t * NOTE: Use of '<a:noAutofit/>' in lieu of '' below causes issues in PPT-2013\n\t\t */\n\t\tbodyProperties += slideObject.options._bodyProp.autoFit !== false ? '<a:spAutoFit/>' : ''\n\n\t\t// LAST: Close _bodyProp\n\t\tbodyProperties += '</a:bodyPr>'\n\t} else {\n\t\t// DEFAULT:\n\t\tbodyProperties += ' wrap=\"square\" rtlCol=\"0\">'\n\t\tbodyProperties += '</a:bodyPr>'\n\t}\n\n\t// LAST: Return Close _bodyProp\n\treturn slideObject._type === SLIDE_OBJECT_TYPES.tablecell ? '<a:bodyPr/>' : bodyProperties\n}\n\n/**\n * Generate the XML for text and its options (bold, bullet, etc) including text runs (word-level formatting)\n * @param {ISlideObject|TableCell} slideObj - slideObj or tableCell\n * @note PPT text lines [lines followed by line-breaks] are created using <p>-aragraph's\n * @note Bullets are a paragragh-level formatting device\n * @template\n *\t<p:txBody>\n *\t\t<a:bodyPr wrap=\"square\" rtlCol=\"0\">\n *\t\t\t<a:spAutoFit/>\n *\t\t</a:bodyPr>\n *\t\t<a:lstStyle/>\n *\t\t<a:p>\n *\t\t\t<a:pPr algn=\"ctr\"/>\n *\t\t\t<a:r>\n *\t\t\t\t<a:rPr lang=\"en-US\" dirty=\"0\" err=\"1\"/>\n *\t\t\t\t<a:t>textbox text</a:t>\n *\t\t\t</a:r>\n *\t\t\t<a:endParaRPr lang=\"en-US\" dirty=\"0\"/>\n *\t\t</a:p>\n *\t</p:txBody>\n * @returns XML containing the param object's text and formatting\n */\nexport function genXmlTextBody(slideObj: ISlideObject | TableCell): string {\n\tlet opts: ObjectOptions = slideObj.options || {}\n\tlet tmpTextObjects: TextProps[] = []\n\tlet arrTextObjects: TextProps[] = []\n\n\t// FIRST: Shapes without text, etc. may be sent here during build, but have no text to render so return an empty string\n\tif (opts && slideObj._type !== SLIDE_OBJECT_TYPES.tablecell && (typeof slideObj.text === 'undefined' || slideObj.text === null)) return ''\n\n\t// STEP 1: Start textBody\n\tlet strSlideXml = slideObj._type === SLIDE_OBJECT_TYPES.tablecell ? '<a:txBody>' : '<p:txBody>'\n\n\t// STEP 2: Add bodyProperties\n\t{\n\t\t// A: 'bodyPr'\n\t\tstrSlideXml += genXmlBodyProperties(slideObj)\n\n\t\t// B: 'lstStyle'\n\t\t// NOTE: shape type 'LINE' has different text align needs (a lstStyle.lvl1pPr between bodyPr and p)\n\t\t// FIXME: LINE horiz-align doesnt work (text is always to the left inside line) (FYI: the PPT code diff is substantial!)\n\t\tif (opts.h === 0 && opts.line && opts.align) strSlideXml += '<a:lstStyle><a:lvl1pPr algn=\"l\"/></a:lstStyle>'\n\t\telse if (slideObj._type === 'placeholder') strSlideXml += `<a:lstStyle>${genXmlParagraphProperties(slideObj, true)}</a:lstStyle>`\n\t\telse strSlideXml += '<a:lstStyle/>'\n\t}\n\n\t/* STEP 3: Modify slideObj.text to array\n\t\tCASES:\n\t\taddText( 'string' ) // string\n\t\taddText( 'line1\\n line2' ) // string with lineBreak\n\t\taddText( {text:'word1'} ) // TextProps object\n\t\taddText( ['barry','allen'] ) // array of strings\n\t\taddText( [{text:'word1'}, {text:'word2'}] ) // TextProps object array\n\t\taddText( [{text:'line1\\n line2'}, {text:'end word'}] ) // TextProps object array with lineBreak\n\t*/\n\tif (typeof slideObj.text === 'string' || typeof slideObj.text === 'number') {\n\t\t// Handle cases 1,2\n\t\ttmpTextObjects.push({ text: slideObj.text.toString(), options: opts || {} })\n\t} else if (!Array.isArray(slideObj.text) && slideObj.text!.hasOwnProperty('text')) {\n\t\t// Handle case 3\n\t\ttmpTextObjects.push({ text: slideObj.text || '', options: slideObj.options || {} })\n\t} else if (Array.isArray(slideObj.text)) {\n\t\t// Handle cases 4,5,6\n\t\t// NOTE: use cast as text is TextProps[]|TableCell[] and their `options` dont overlap (they share the same TextBaseProps though)\n\t\ttmpTextObjects = (slideObj.text as TextProps[]).map(item => ({ text: item.text, options: item.options }))\n\t}\n\n\t// STEP 4: Iterate over text objects, set text/options, break into pieces if '\\n'/breakLine found\n\ttmpTextObjects.forEach((itext, idx) => {\n\t\tif (!itext.text) itext.text = ''\n\n\t\t// A: Set options\n\t\titext.options = itext.options || opts || {}\n\t\tif (idx === 0 && itext.options && !itext.options.bullet && opts.bullet) itext.options.bullet = opts.bullet\n\n\t\t// B: Cast to text-object and fix line-breaks (if needed)\n\t\tif (typeof itext.text === 'string' || typeof itext.text === 'number') {\n\t\t\t// 1: Convert \"\\n\" or any variation into CRLF\n\t\t\titext.text = itext.text.toString().replace(/\\r*\\n/g, CRLF)\n\t\t}\n\n\t\t// C: If text string has line-breaks, then create a separate text-object for each (much easier than dealing with split inside a loop below)\n\t\t// NOTE: Filter for trailing lineBreak prevents the creation of an empty textObj as the last item\n\t\tif (itext.text.indexOf(CRLF) > -1 && itext.text.match(/\\n$/g) === null) {\n\t\t\titext.text.split(CRLF).forEach(line => {\n\t\t\t\titext.options.breakLine = true\n\t\t\t\tarrTextObjects.push({ text: line, options: itext.options })\n\t\t\t})\n\t\t} else {\n\t\t\tarrTextObjects.push(itext)\n\t\t}\n\t})\n\n\t// STEP 5: Group textObj into lines by checking for lineBreak, bullets, alignment change, etc.\n\tlet arrLines: TextProps[][] = []\n\tlet arrTexts: TextProps[] = []\n\tarrTextObjects.forEach((textObj, idx) => {\n\t\t// A: Align or Bullet trigger new line\n\t\tif (arrTexts.length > 0 && (textObj.options.align || opts.align)) {\n\t\t\t// Only start a new paragraph when align *changes*\n\t\t\tif (textObj.options.align != arrTextObjects[idx - 1].options.align) {\n\t\t\t\tarrLines.push(arrTexts)\n\t\t\t\tarrTexts = []\n\t\t\t}\n\t\t} else if (arrTexts.length > 0 && textObj.options.bullet && arrTexts.length > 0) {\n\t\t\tarrLines.push(arrTexts)\n\t\t\tarrTexts = []\n\t\t\ttextObj.options.breakLine = false // For cases with both `bullet` and `brekaLine` - prevent double lineBreak\n\t\t}\n\n\t\t// B: Add this text to current line\n\t\tarrTexts.push(textObj)\n\n\t\t// C: BreakLine begins new line **after** adding current text\n\t\tif (arrTexts.length > 0 && textObj.options.breakLine) {\n\t\t\t// Avoid starting a para right as loop is exhausted\n\t\t\tif (idx + 1 < arrTextObjects.length) {\n\t\t\t\tarrLines.push(arrTexts)\n\t\t\t\tarrTexts = []\n\t\t\t}\n\t\t}\n\n\t\t// D: Flush buffer\n\t\tif (idx + 1 === arrTextObjects.length) arrLines.push(arrTexts)\n\t})\n\n\t// STEP 6: Loop over each line and create paragraph props, text run, etc.\n\tarrLines.forEach(line => {\n\t\tlet reqsClosingFontSize = false\n\n\t\t// A: Start paragraph, add paraProps\n\t\tstrSlideXml += '<a:p>'\n\t\t// NOTE: `rtlMode` is like other opts, its propagated up to each text:options, so just check the 1st one\n\t\tlet paragraphPropXml = `<a:pPr ${line[0].options && line[0].options.rtlMode ? ' rtl=\"1\" ' : ''}`\n\n\t\t// B: Start paragraph, loop over lines and add text runs\n\t\tline.forEach((textObj, idx) => {\n\t\t\t// A: Set line index\n\t\t\ttextObj.options._lineIdx = idx\n\n\t\t\t// B: Inherit pPr-type options from parent shape's `options`\n\t\t\ttextObj.options.align = textObj.options.align || opts.align\n\t\t\ttextObj.options.lineSpacing = textObj.options.lineSpacing || opts.lineSpacing\n\t\t\ttextObj.options.indentLevel = textObj.options.indentLevel || opts.indentLevel\n\t\t\ttextObj.options.paraSpaceBefore = textObj.options.paraSpaceBefore || opts.paraSpaceBefore\n\t\t\ttextObj.options.paraSpaceAfter = textObj.options.paraSpaceAfter || opts.paraSpaceAfter\n\t\t\tparagraphPropXml = genXmlParagraphProperties(textObj, false)\n\n\t\t\tstrSlideXml += paragraphPropXml\n\t\t\t// C: Inherit any main options (color, fontSize, etc.)\n\t\t\t// NOTE: We only pass the text.options to genXmlTextRun (not the Slide.options),\n\t\t\t// so the run building function cant just fallback to Slide.color, therefore, we need to do that here before passing options below.\n\t\t\tObject.entries(opts).forEach(([key, val]) => {\n\t\t\t\t// NOTE: This loop will pick up unecessary keys (`x`, etc.), but it doesnt hurt anything\n\t\t\t\tif (key !== 'bullet' && !textObj.options[key]) textObj.options[key] = val\n\t\t\t})\n\n\t\t\t// D: Add formatted textrun\n\t\t\tstrSlideXml += genXmlTextRun(textObj)\n\n\t\t\t// E: Flag close fontSize for empty [lineBreak] elements\n\t\t\tif ((!textObj.text && opts.fontSize) || textObj.options.fontSize) {\n\t\t\t\treqsClosingFontSize = true\n\t\t\t\topts.fontSize = opts.fontSize || textObj.options.fontSize\n\t\t\t}\n\t\t})\n\n\t\t/* C: Append 'endParaRPr' (when needed) and close current open paragraph\n\t\t * NOTE: (ISSUE#20, ISSUE#193): Add 'endParaRPr' with font/size props or PPT default (Arial/18pt en-us) is used making row \"too tall\"/not honoring options\n\t\t */\n\t\tif (slideObj._type === SLIDE_OBJECT_TYPES.tablecell && (opts.fontSize || opts.fontFace)) {\n\t\t\tif (opts.fontFace) {\n\t\t\t\tstrSlideXml += `<a:endParaRPr lang=\"${opts.lang || 'en-US'}\"` + (opts.fontSize ? ` sz=\"${Math.round(opts.fontSize)}00\"` : '') + ' dirty=\"0\">'\n\t\t\t\tstrSlideXml += `<a:latin typeface=\"${opts.fontFace}\" charset=\"0\"/>`\n\t\t\t\tstrSlideXml += `<a:ea typeface=\"${opts.fontFace}\" charset=\"0\"/>`\n\t\t\t\tstrSlideXml += `<a:cs typeface=\"${opts.fontFace}\" charset=\"0\"/>`\n\t\t\t\tstrSlideXml += '</a:endParaRPr>'\n\t\t\t} else {\n\t\t\t\tstrSlideXml += `<a:endParaRPr lang=\"${opts.lang || 'en-US'}\"` + (opts.fontSize ? ` sz=\"${Math.round(opts.fontSize)}00\"` : '') + ' dirty=\"0\"/>'\n\t\t\t}\n\t\t} else if (reqsClosingFontSize) {\n\t\t\t// Empty [lineBreak] lines should not contain runProp, however, they need to specify fontSize in `endParaRPr`\n\t\t\tstrSlideXml += `<a:endParaRPr lang=\"${opts.lang || 'en-US'}\"` + (opts.fontSize ? ` sz=\"${Math.round(opts.fontSize)}00\"` : '') + ' dirty=\"0\"/>'\n\t\t} else {\n\t\t\tstrSlideXml += `<a:endParaRPr lang=\"${opts.lang || 'en-US'}\" dirty=\"0\"/>` // Added 20180101 to address PPT-2007 issues\n\t\t}\n\n\t\t// D: End paragraph\n\t\tstrSlideXml += '</a:p>'\n\t})\n\n\t// STEP 7: Close the textBody\n\tstrSlideXml += slideObj._type === SLIDE_OBJECT_TYPES.tablecell ? '</a:txBody>' : '</p:txBody>'\n\n\t// LAST: Return XML\n\treturn strSlideXml\n}\n\n/**\n * Generate an XML Placeholder\n * @param {ISlideObject} placeholderObj\n * @returns XML\n */\nexport function genXmlPlaceholder(placeholderObj: ISlideObject): string {\n\tif (!placeholderObj) return ''\n\n\tlet placeholderIdx = placeholderObj.options && placeholderObj.options._placeholderIdx ? placeholderObj.options._placeholderIdx : ''\n\tlet placeholderType = placeholderObj.options && placeholderObj.options._placeholderType ? placeholderObj.options._placeholderType : ''\n\n\treturn `<p:ph\n\t\t${placeholderIdx ? ' idx=\"' + placeholderIdx + '\"' : ''}\n\t\t${placeholderType && PLACEHOLDER_TYPES[placeholderType] ? ' type=\"' + PLACEHOLDER_TYPES[placeholderType] + '\"' : ''}\n\t\t${placeholderObj.text && placeholderObj.text.length > 0 ? ' hasCustomPrompt=\"1\"' : ''}\n\t\t/>`\n}\n\n// XML-GEN: First 6 functions create the base /ppt files\n\n/**\n * Generate XML ContentType\n * @param {PresSlide[]} slides - slides\n * @param {SlideLayout[]} slideLayouts - slide layouts\n * @param {PresSlide} masterSlide - master slide\n * @returns XML\n */\nexport function makeXmlContTypes(slides: PresSlide[], slideLayouts: SlideLayout[], masterSlide?: PresSlide): string {\n\tlet strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF\n\tstrXml += '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'\n\tstrXml += '<Default Extension=\"xml\" ContentType=\"application/xml\"/>'\n\tstrXml += '<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>'\n\tstrXml += '<Default Extension=\"jpeg\" ContentType=\"image/jpeg\"/>'\n\tstrXml += '<Default Extension=\"jpg\" ContentType=\"image/jpg\"/>'\n\n\t// STEP 1: Add standard/any media types used in Presentation\n\tstrXml += '<Default Extension=\"png\" ContentType=\"image/png\"/>'\n\tstrXml += '<Default Extension=\"gif\" ContentType=\"image/gif\"/>'\n\tstrXml += '<Default Extension=\"m4v\" ContentType=\"video/mp4\"/>' // NOTE: Hard-Code this extension as it wont be created in loop below (as extn !== type)\n\tstrXml += '<Default Extension=\"mp4\" ContentType=\"video/mp4\"/>' // NOTE: Hard-Code this extension as it wont be created in loop below (as extn !== type)\n\tslides.forEach(slide => {\n\t\t;(slide._relsMedia || []).forEach(rel => {\n\t\t\tif (rel.type !== 'image' && rel.type !== 'online' && rel.type !== 'chart' && rel.extn !== 'm4v' && strXml.indexOf(rel.type) === -1) {\n\t\t\t\tstrXml += '<Default Extension=\"' + rel.extn + '\" ContentType=\"' + rel.type + '\"/>'\n\t\t\t}\n\t\t})\n\t})\n\tstrXml += '<Default Extension=\"vml\" ContentType=\"application/vnd.openxmlformats-officedocument.vmlDrawing\"/>'\n\tstrXml += '<Default Extension=\"xlsx\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"/>'\n\n\t// STEP 2: Add presentation and slide master(s)/slide(s)\n\tstrXml += '<Override PartName=\"/ppt/presentation.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml\"/>'\n\tstrXml += '<Override PartName=\"/ppt/notesMasters/notesMaster1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.notesMaster+xml\"/>'\n\tslides.forEach((slide, idx) => {\n\t\tstrXml +=\n\t\t\t'<Override PartName=\"/ppt/slideMasters/slideMaster' +\n\t\t\t(idx + 1) +\n\t\t\t'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideMaster+xml\"/>'\n\t\tstrXml += '<Override PartName=\"/ppt/slides/slide' + (idx + 1) + '.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slide+xml\"/>'\n\t\t// Add charts if any\n\t\tslide._relsChart.forEach(rel => {\n\t\t\tstrXml += ' <Override PartName=\"' + rel.Target + '\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>'\n\t\t})\n\t})\n\n\t// STEP 3: Core PPT\n\tstrXml += '<Override PartName=\"/ppt/presProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.presProps+xml\"/>'\n\tstrXml += '<Override PartName=\"/ppt/viewProps.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.viewProps+xml\"/>'\n\tstrXml += '<Override PartName=\"/ppt/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>'\n\tstrXml += '<Override PartName=\"/ppt/tableStyles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml\"/>'\n\n\t// STEP 4: Add Slide Layouts\n\tslideLayouts.forEach((layout, idx) => {\n\t\tstrXml +=\n\t\t\t'<Override PartName=\"/ppt/slideLayouts/slideLayout' +\n\t\t\t(idx + 1) +\n\t\t\t'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.slideLayout+xml\"/>'\n\t\t;(layout._relsChart || []).forEach(rel => {\n\t\t\tstrXml += ' <Override PartName=\"' + rel.Target + '\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>'\n\t\t})\n\t})\n\n\t// STEP 5: Add notes slide(s)\n\tslides.forEach((_slide, idx) => {\n\t\tstrXml +=\n\t\t\t' <Override PartName=\"/ppt/notesSlides/notesSlide' +\n\t\t\t(idx + 1) +\n\t\t\t'.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.presentationml.notesSlide+xml\"/>'\n\t})\n\n\t// STEP 6: Add rels\n\tmasterSlide._relsChart.forEach(rel => {\n\t\tstrXml += ' <Override PartName=\"' + rel.Target + '\" ContentType=\"application/vnd.openxmlformats-officedocument.drawingml.chart+xml\"/>'\n\t})\n\tmasterSlide._relsMedia.forEach(rel => {\n\t\tif (rel.type !== 'image' && rel.type !== 'online' && rel.type !== 'chart' && rel.extn !== 'm4v' && strXml.indexOf(rel.type) === -1)\n\t\t\tstrXml += ' <Default Extension=\"' + rel.extn + '\" ContentType=\"' + rel.type + '\"/>'\n\t})\n\n\t// LAST: Finish XML (Resume core)\n\tstrXml += ' <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>'\n\tstrXml += ' <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>'\n\tstrXml += '</Types>'\n\n\treturn strXml\n}\n\n/**\n * Creates `_rels/.rels`\n * @returns XML\n */\nexport function makeXmlRootRels(): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n\t\t<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>\n\t\t<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>\n\t\t<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"ppt/presentation.xml\"/>\n\t\t</Relationships>`\n}\n\n/**\n * Creates `docProps/app.xml`\n * @param {PresSlide[]} slides - Presenation Slides\n * @param {string} company - \"Company\" metadata\n * @returns XML\n */\nexport function makeXmlApp(slides: PresSlide[], company: string): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}<Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">\n\t<TotalTime>0</TotalTime>\n\t<Words>0</Words>\n\t<Application>Microsoft Office PowerPoint</Application>\n\t<PresentationFormat>On-screen Show (16:9)</PresentationFormat>\n\t<Paragraphs>0</Paragraphs>\n\t<Slides>${slides.length}</Slides>\n\t<Notes>${slides.length}</Notes>\n\t<HiddenSlides>0</HiddenSlides>\n\t<MMClips>0</MMClips>\n\t<ScaleCrop>false</ScaleCrop>\n\t<HeadingPairs>\n\t\t<vt:vector size=\"6\" baseType=\"variant\">\n\t\t\t<vt:variant><vt:lpstr>Fonts Used</vt:lpstr></vt:variant>\n\t\t\t<vt:variant><vt:i4>2</vt:i4></vt:variant>\n\t\t\t<vt:variant><vt:lpstr>Theme</vt:lpstr></vt:variant>\n\t\t\t<vt:variant><vt:i4>1</vt:i4></vt:variant>\n\t\t\t<vt:variant><vt:lpstr>Slide Titles</vt:lpstr></vt:variant>\n\t\t\t<vt:variant><vt:i4>${slides.length}</vt:i4></vt:variant>\n\t\t</vt:vector>\n\t</HeadingPairs>\n\t<TitlesOfParts>\n\t\t<vt:vector size=\"${slides.length + 1 + 2}\" baseType=\"lpstr\">\n\t\t\t<vt:lpstr>Arial</vt:lpstr>\n\t\t\t<vt:lpstr>Calibri</vt:lpstr>\n\t\t\t<vt:lpstr>Office Theme</vt:lpstr>\n\t\t\t${slides.map((_slideObj, idx) => '<vt:lpstr>Slide ' + (idx + 1) + '</vt:lpstr>\\n').join('')}\n\t\t</vt:vector>\n\t</TitlesOfParts>\n\t<Company>${company}</Company>\n\t<LinksUpToDate>false</LinksUpToDate>\n\t<SharedDoc>false</SharedDoc>\n\t<HyperlinksChanged>false</HyperlinksChanged>\n\t<AppVersion>16.0000</AppVersion>\n\t</Properties>`\n}\n\n/**\n * Creates `docProps/core.xml`\n * @param {string} title - metadata data\n * @param {string} company - metadata data\n * @param {string} author - metadata value\n * @param {string} revision - metadata value\n * @returns XML\n */\nexport function makeXmlCore(title: string, subject: string, author: string, revision: string): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\t<cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n\t\t<dc:title>${encodeXmlEntities(title)}</dc:title>\n\t\t<dc:subject>${encodeXmlEntities(subject)}</dc:subject>\n\t\t<dc:creator>${encodeXmlEntities(author)}</dc:creator>\n\t\t<cp:lastModifiedBy>${encodeXmlEntities(author)}</cp:lastModifiedBy>\n\t\t<cp:revision>${revision}</cp:revision>\n\t\t<dcterms:created xsi:type=\"dcterms:W3CDTF\">${new Date().toISOString().replace(/\\.\\d\\d\\dZ/, 'Z')}</dcterms:created>\n\t\t<dcterms:modified xsi:type=\"dcterms:W3CDTF\">${new Date().toISOString().replace(/\\.\\d\\d\\dZ/, 'Z')}</dcterms:modified>\n\t</cp:coreProperties>`\n}\n\n/**\n * Creates `ppt/_rels/presentation.xml.rels`\n * @param {PresSlide[]} slides - Presenation Slides\n * @returns XML\n */\nexport function makeXmlPresentationRels(slides: Array<PresSlide>): string {\n\tlet intRelNum = 1\n\tlet strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF\n\tstrXml += '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'\n\tstrXml += '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster\" Target=\"slideMasters/slideMaster1.xml\"/>'\n\tfor (let idx = 1; idx <= slides.length; idx++) {\n\t\tstrXml +=\n\t\t\t'<Relationship Id=\"rId' + ++intRelNum + '\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\" Target=\"slides/slide' + idx + '.xml\"/>'\n\t}\n\tintRelNum++\n\tstrXml +=\n\t\t'<Relationship Id=\"rId' +\n\t\tintRelNum +\n\t\t'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesMaster\" Target=\"notesMasters/notesMaster1.xml\"/>' +\n\t\t'<Relationship Id=\"rId' +\n\t\t(intRelNum + 1) +\n\t\t'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/presProps\" Target=\"presProps.xml\"/>' +\n\t\t'<Relationship Id=\"rId' +\n\t\t(intRelNum + 2) +\n\t\t'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/viewProps\" Target=\"viewProps.xml\"/>' +\n\t\t'<Relationship Id=\"rId' +\n\t\t(intRelNum + 3) +\n\t\t'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>' +\n\t\t'<Relationship Id=\"rId' +\n\t\t(intRelNum + 4) +\n\t\t'\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles\" Target=\"tableStyles.xml\"/>' +\n\t\t'</Relationships>'\n\n\treturn strXml\n}\n\n// XML-GEN: Functions that run 1-N times (once for each Slide)\n\n/**\n * Generates XML for the slide file (`ppt/slides/slide1.xml`)\n * @param {PresSlide} slide - the slide object to transform into XML\n * @return {string} XML\n */\nexport function makeXmlSlide(slide: PresSlide): string {\n\treturn (\n\t\t`<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}` +\n\t\t`<p:sld xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" ` +\n\t\t`xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"` +\n\t\t`${slide && slide.hidden ? ' show=\"0\"' : ''}>` +\n\t\t`${slideObjectToXml(slide)}` +\n\t\t`<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sld>`\n\t)\n}\n\n/**\n * Get text content of Notes from Slide\n * @param {PresSlide} slide - the slide object to transform into XML\n * @return {string} notes text\n */\nexport function getNotesFromSlide(slide: PresSlide): string {\n\tlet notesText = ''\n\n\tslide._slideObjects.forEach(data => {\n\t\tif (data._type === 'notes') notesText += data.text\n\t})\n\n\treturn notesText.replace(/\\r*\\n/g, CRLF)\n}\n\n/**\n * Generate XML for Notes Master (notesMaster1.xml)\n * @returns {string} XML\n */\nexport function makeXmlNotesMaster(): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}<p:notesMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:cSld><p:bg><p:bgRef idx=\"1001\"><a:schemeClr val=\"bg1\"/></p:bgRef></p:bg><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/><p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/></a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Header Placeholder 1\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"hdr\" sz=\"quarter\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"2971800\" cy=\"458788\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\"/><a:lstStyle><a:lvl1pPr algn=\"l\"><a:defRPr sz=\"1200\"/></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Date Placeholder 2\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"dt\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"3884613\" y=\"0\"/><a:ext cx=\"2971800\" cy=\"458788\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\"/><a:lstStyle><a:lvl1pPr algn=\"r\"><a:defRPr sz=\"1200\"/></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{5282F153-3F37-0F45-9E97-73ACFA13230C}\" type=\"datetimeFigureOut\"><a:rPr lang=\"en-US\"/><a:t>7/23/19</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Slide Image Placeholder 3\"/><p:cNvSpPr><a:spLocks noGrp=\"1\" noRot=\"1\" noChangeAspect=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldImg\" idx=\"2\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"685800\" y=\"1143000\"/><a:ext cx=\"5486400\" cy=\"3086100\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom><a:noFill/><a:ln w=\"12700\"><a:solidFill><a:prstClr val=\"black\"/></a:solidFill></a:ln></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"ctr\"/><a:lstStyle/><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"5\" name=\"Notes Placeholder 4\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"body\" sz=\"quarter\" idx=\"3\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"685800\" y=\"4400550\"/><a:ext cx=\"5486400\" cy=\"3600450\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\"/><a:lstStyle/><a:p><a:pPr lvl=\"0\"/><a:r><a:rPr lang=\"en-US\"/><a:t>Click to edit Master text styles</a:t></a:r></a:p><a:p><a:pPr lvl=\"1\"/><a:r><a:rPr lang=\"en-US\"/><a:t>Second level</a:t></a:r></a:p><a:p><a:pPr lvl=\"2\"/><a:r><a:rPr lang=\"en-US\"/><a:t>Third level</a:t></a:r></a:p><a:p><a:pPr lvl=\"3\"/><a:r><a:rPr lang=\"en-US\"/><a:t>Fourth level</a:t></a:r></a:p><a:p><a:pPr lvl=\"4\"/><a:r><a:rPr lang=\"en-US\"/><a:t>Fifth level</a:t></a:r></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"6\" name=\"Footer Placeholder 5\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"ftr\" sz=\"quarter\" idx=\"4\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"0\" y=\"8685213\"/><a:ext cx=\"2971800\" cy=\"458787\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"b\"/><a:lstStyle><a:lvl1pPr algn=\"l\"><a:defRPr sz=\"1200\"/></a:lvl1pPr></a:lstStyle><a:p><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"7\" name=\"Slide Number Placeholder 6\"/><p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr><p:ph type=\"sldNum\" sz=\"quarter\" idx=\"5\"/></p:nvPr></p:nvSpPr><p:spPr><a:xfrm><a:off x=\"3884613\" y=\"8685213\"/><a:ext cx=\"2971800\" cy=\"458787\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></p:spPr><p:txBody><a:bodyPr vert=\"horz\" lIns=\"91440\" tIns=\"45720\" rIns=\"91440\" bIns=\"45720\" rtlCol=\"0\" anchor=\"b\"/><a:lstStyle><a:lvl1pPr algn=\"r\"><a:defRPr sz=\"1200\"/></a:lvl1pPr></a:lstStyle><a:p><a:fld id=\"{CE5E9CC1-C706-0F49-92D6-E571CC5EEA8F}\" type=\"slidenum\"><a:rPr lang=\"en-US\"/><a:t>‹#›</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp></p:spTree><p:extLst><p:ext uri=\"{BB962C8B-B14F-4D97-AF65-F5344CB8AC3E}\"><p14:creationId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1024086991\"/></p:ext></p:extLst></p:cSld><p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\"/><p:notesStyle><a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr><a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr><a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr><a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr><a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr><a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr><a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr><a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr><a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr></p:notesStyle></p:notesMaster>`\n}\n\n/**\n * Creates Notes Slide (`ppt/notesSlides/notesSlide1.xml`)\n * @param {PresSlide} slide - the slide object to transform into XML\n * @return {string} XML\n */\nexport function makeXmlNotesSlide(slide: PresSlide): string {\n\treturn (\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\n\t\tCRLF +\n\t\t'<p:notes xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">' +\n\t\t'<p:cSld><p:spTree><p:nvGrpSpPr><p:cNvPr id=\"1\" name=\"\"/><p:cNvGrpSpPr/>' +\n\t\t'<p:nvPr/></p:nvGrpSpPr><p:grpSpPr><a:xfrm><a:off x=\"0\" y=\"0\"/>' +\n\t\t'<a:ext cx=\"0\" cy=\"0\"/><a:chOff x=\"0\" y=\"0\"/><a:chExt cx=\"0\" cy=\"0\"/>' +\n\t\t'</a:xfrm></p:grpSpPr><p:sp><p:nvSpPr><p:cNvPr id=\"2\" name=\"Slide Image Placeholder 1\"/>' +\n\t\t'<p:cNvSpPr><a:spLocks noGrp=\"1\" noRot=\"1\" noChangeAspect=\"1\"/></p:cNvSpPr>' +\n\t\t'<p:nvPr><p:ph type=\"sldImg\"/></p:nvPr></p:nvSpPr><p:spPr/>' +\n\t\t'</p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"3\" name=\"Notes Placeholder 2\"/>' +\n\t\t'<p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr>' +\n\t\t'<p:ph type=\"body\" idx=\"1\"/></p:nvPr></p:nvSpPr><p:spPr/>' +\n\t\t'<p:txBody><a:bodyPr/><a:lstStyle/><a:p><a:r>' +\n\t\t'<a:rPr lang=\"en-US\" dirty=\"0\"/><a:t>' +\n\t\tencodeXmlEntities(getNotesFromSlide(slide)) +\n\t\t'</a:t></a:r><a:endParaRPr lang=\"en-US\" dirty=\"0\"/></a:p></p:txBody>' +\n\t\t'</p:sp><p:sp><p:nvSpPr><p:cNvPr id=\"4\" name=\"Slide Number Placeholder 3\"/>' +\n\t\t'<p:cNvSpPr><a:spLocks noGrp=\"1\"/></p:cNvSpPr><p:nvPr>' +\n\t\t'<p:ph type=\"sldNum\" sz=\"quarter\" idx=\"10\"/></p:nvPr></p:nvSpPr>' +\n\t\t'<p:spPr/><p:txBody><a:bodyPr/><a:lstStyle/><a:p>' +\n\t\t'<a:fld id=\"' +\n\t\tSLDNUMFLDID +\n\t\t'\" type=\"slidenum\">' +\n\t\t'<a:rPr lang=\"en-US\"/><a:t>' +\n\t\tslide._slideNum +\n\t\t'</a:t></a:fld><a:endParaRPr lang=\"en-US\"/></a:p></p:txBody></p:sp>' +\n\t\t'</p:spTree><p:extLst><p:ext uri=\"{BB962C8B-B14F-4D97-AF65-F5344CB8AC3E}\">' +\n\t\t'<p14:creationId xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\" val=\"1024086991\"/>' +\n\t\t'</p:ext></p:extLst></p:cSld><p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:notes>'\n\t)\n}\n\n/**\n * Generates the XML layout resource from a layout object\n * @param {SlideLayout} layout - slide layout (master)\n * @return {string} XML\n */\nexport function makeXmlLayout(layout: SlideLayout): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\t\t<p:sldLayout xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" preserve=\"1\">\n\t\t${slideObjectToXml(layout)}\n\t\t<p:clrMapOvr><a:masterClrMapping/></p:clrMapOvr></p:sldLayout>`\n}\n\n/**\n * Creates Slide Master 1 (`ppt/slideMasters/slideMaster1.xml`)\n * @param {PresSlide} slide - slide object that represents master slide layout\n * @param {SlideLayout[]} layouts - slide layouts\n * @return {string} XML\n */\nexport function makeXmlMaster(slide: PresSlide, layouts: SlideLayout[]): string {\n\t// NOTE: Pass layouts as static rels because they are not referenced any time\n\tlet layoutDefs = layouts.map((_layoutDef, idx) => '<p:sldLayoutId id=\"' + (LAYOUT_IDX_SERIES_BASE + idx) + '\" r:id=\"rId' + (slide._rels.length + idx + 1) + '\"/>')\n\n\tlet strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + CRLF\n\tstrXml +=\n\t\t'<p:sldMaster xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\">'\n\tstrXml += slideObjectToXml(slide)\n\tstrXml +=\n\t\t'<p:clrMap bg1=\"lt1\" tx1=\"dk1\" bg2=\"lt2\" tx2=\"dk2\" accent1=\"accent1\" accent2=\"accent2\" accent3=\"accent3\" accent4=\"accent4\" accent5=\"accent5\" accent6=\"accent6\" hlink=\"hlink\" folHlink=\"folHlink\"/>'\n\tstrXml += '<p:sldLayoutIdLst>' + layoutDefs.join('') + '</p:sldLayoutIdLst>'\n\tstrXml += '<p:hf sldNum=\"0\" hdr=\"0\" ftr=\"0\" dt=\"0\"/>'\n\tstrXml +=\n\t\t'<p:txStyles>' +\n\t\t' <p:titleStyle>' +\n\t\t'  <a:lvl1pPr algn=\"ctr\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"0\"/></a:spcBef><a:buNone/><a:defRPr sz=\"4400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mj-lt\"/><a:ea typeface=\"+mj-ea\"/><a:cs typeface=\"+mj-cs\"/></a:defRPr></a:lvl1pPr>' +\n\t\t' </p:titleStyle>' +\n\t\t' <p:bodyStyle>' +\n\t\t'  <a:lvl1pPr marL=\"342900\" indent=\"-342900\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"3200\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>' +\n\t\t'  <a:lvl2pPr marL=\"742950\" indent=\"-285750\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"–\"/><a:defRPr sz=\"2800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>' +\n\t\t'  <a:lvl3pPr marL=\"1143000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2400\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>' +\n\t\t'  <a:lvl4pPr marL=\"1600200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"–\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>' +\n\t\t'  <a:lvl5pPr marL=\"2057400\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"»\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>' +\n\t\t'  <a:lvl6pPr marL=\"2514600\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>' +\n\t\t'  <a:lvl7pPr marL=\"2971800\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>' +\n\t\t'  <a:lvl8pPr marL=\"3429000\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>' +\n\t\t'  <a:lvl9pPr marL=\"3886200\" indent=\"-228600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:spcBef><a:spcPct val=\"20000\"/></a:spcBef><a:buFont typeface=\"Arial\" pitchFamily=\"34\" charset=\"0\"/><a:buChar char=\"•\"/><a:defRPr sz=\"2000\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>' +\n\t\t' </p:bodyStyle>' +\n\t\t' <p:otherStyle>' +\n\t\t'  <a:defPPr><a:defRPr lang=\"en-US\"/></a:defPPr>' +\n\t\t'  <a:lvl1pPr marL=\"0\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl1pPr>' +\n\t\t'  <a:lvl2pPr marL=\"457200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl2pPr>' +\n\t\t'  <a:lvl3pPr marL=\"914400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl3pPr>' +\n\t\t'  <a:lvl4pPr marL=\"1371600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl4pPr>' +\n\t\t'  <a:lvl5pPr marL=\"1828800\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl5pPr>' +\n\t\t'  <a:lvl6pPr marL=\"2286000\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl6pPr>' +\n\t\t'  <a:lvl7pPr marL=\"2743200\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl7pPr>' +\n\t\t'  <a:lvl8pPr marL=\"3200400\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl8pPr>' +\n\t\t'  <a:lvl9pPr marL=\"3657600\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\"><a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/></a:defRPr></a:lvl9pPr>' +\n\t\t' </p:otherStyle>' +\n\t\t'</p:txStyles>'\n\tstrXml += '</p:sldMaster>'\n\n\treturn strXml\n}\n\n/**\n * Generates XML string for a slide layout relation file\n * @param {number} layoutNumber - 1-indexed number of a layout that relations are generated for\n * @param {SlideLayout[]} slideLayouts - Slide Layouts\n * @return {string} XML\n */\nexport function makeXmlSlideLayoutRel(layoutNumber: number, slideLayouts: SlideLayout[]): string {\n\treturn slideObjectRelationsToXml(slideLayouts[layoutNumber - 1], [\n\t\t{\n\t\t\ttarget: '../slideMasters/slideMaster1.xml',\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideMaster',\n\t\t},\n\t])\n}\n\n/**\n * Creates `ppt/_rels/slide*.xml.rels`\n * @param {PresSlide[]} slides\n * @param {SlideLayout[]} slideLayouts - Slide Layout(s)\n * @param {number} `slideNumber` 1-indexed number of a layout that relations are generated for\n * @return {string} XML\n */\nexport function makeXmlSlideRel(slides: PresSlide[], slideLayouts: SlideLayout[], slideNumber: number): string {\n\treturn slideObjectRelationsToXml(slides[slideNumber - 1], [\n\t\t{\n\t\t\ttarget: '../slideLayouts/slideLayout' + getLayoutIdxForSlide(slides, slideLayouts, slideNumber) + '.xml',\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\n\t\t},\n\t\t{\n\t\t\ttarget: '../notesSlides/notesSlide' + slideNumber + '.xml',\n\t\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesSlide',\n\t\t},\n\t])\n}\n\n/**\n * Generates XML string for a slide relation file.\n * @param {number} slideNumber - 1-indexed number of a layout that relations are generated for\n * @return {string} XML\n */\nexport function makeXmlNotesSlideRel(slideNumber: number): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\t\t<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n\t\t\t<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/notesMaster\" Target=\"../notesMasters/notesMaster1.xml\"/>\n\t\t\t<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/slide\" Target=\"../slides/slide${slideNumber}.xml\"/>\n\t\t</Relationships>`\n}\n\n/**\n * Creates `ppt/slideMasters/_rels/slideMaster1.xml.rels`\n * @param {PresSlide} masterSlide - Slide object\n * @param {SlideLayout[]} slideLayouts - Slide Layouts\n * @return {string} XML\n */\nexport function makeXmlMasterRel(masterSlide: PresSlide, slideLayouts: SlideLayout[]): string {\n\tlet defaultRels = slideLayouts.map((_layoutDef, idx) => ({\n\t\ttarget: `../slideLayouts/slideLayout${idx + 1}.xml`,\n\t\ttype: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/slideLayout',\n\t}))\n\tdefaultRels.push({ target: '../theme/theme1.xml', type: 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme' })\n\n\treturn slideObjectRelationsToXml(masterSlide, defaultRels)\n}\n\n/**\n * Creates `ppt/notesMasters/_rels/notesMaster1.xml.rels`\n * @return {string} XML\n */\nexport function makeXmlNotesMasterRel(): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n\t\t<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"../theme/theme1.xml\"/>\n\t\t</Relationships>`\n}\n\n/**\n * For the passed slide number, resolves name of a layout that is used for.\n * @param {PresSlide[]} slides - srray of slides\n * @param {SlideLayout[]} slideLayouts - array of slideLayouts\n * @param {number} slideNumber\n * @return {number} slide number\n */\nfunction getLayoutIdxForSlide(slides: PresSlide[], slideLayouts: SlideLayout[], slideNumber: number): number {\n\tfor (let i = 0; i < slideLayouts.length; i++) {\n\t\tif (slideLayouts[i]._name === slides[slideNumber - 1]._slideLayout._name) {\n\t\t\treturn i + 1\n\t\t}\n\t}\n\n\t// IMPORTANT: Return 1 (for `slideLayout1.xml`) when no def is found\n\t// So all objects are in Layout1 and every slide that references it uses this layout.\n\treturn 1\n}\n\n// XML-GEN: Last 5 functions create root /ppt files\n\n/**\n * Creates `ppt/theme/theme1.xml`\n * @return {string} XML\n */\nexport function makeXmlTheme(): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}<a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"44546A\"/></a:dk2><a:lt2><a:srgbClr val=\"E7E6E6\"/></a:lt2><a:accent1><a:srgbClr val=\"4472C4\"/></a:accent1><a:accent2><a:srgbClr val=\"ED7D31\"/></a:accent2><a:accent3><a:srgbClr val=\"A5A5A5\"/></a:accent3><a:accent4><a:srgbClr val=\"FFC000\"/></a:accent4><a:accent5><a:srgbClr val=\"5B9BD5\"/></a:accent5><a:accent6><a:srgbClr val=\"70AD47\"/></a:accent6><a:hlink><a:srgbClr val=\"0563C1\"/></a:hlink><a:folHlink><a:srgbClr val=\"954F72\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Calibri Light\" panose=\"020F0302020204030204\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"游ゴシック Light\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"等线 Light\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Angsana New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/><a:font script=\"Armn\" typeface=\"Arial\"/><a:font script=\"Bugi\" typeface=\"Leelawadee UI\"/><a:font script=\"Bopo\" typeface=\"Microsoft JhengHei\"/><a:font script=\"Java\" typeface=\"Javanese Text\"/><a:font script=\"Lisu\" typeface=\"Segoe UI\"/><a:font script=\"Mymr\" typeface=\"Myanmar Text\"/><a:font script=\"Nkoo\" typeface=\"Ebrima\"/><a:font script=\"Olck\" typeface=\"Nirmala UI\"/><a:font script=\"Osma\" typeface=\"Ebrima\"/><a:font script=\"Phag\" typeface=\"Phagspa\"/><a:font script=\"Syrn\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Syrj\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Syre\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Sora\" typeface=\"Nirmala UI\"/><a:font script=\"Tale\" typeface=\"Microsoft Tai Le\"/><a:font script=\"Talu\" typeface=\"Microsoft New Tai Lue\"/><a:font script=\"Tfng\" typeface=\"Ebrima\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\" panose=\"020F0502020204030204\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"游ゴシック\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"等线\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Cordia New\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/><a:font script=\"Armn\" typeface=\"Arial\"/><a:font script=\"Bugi\" typeface=\"Leelawadee UI\"/><a:font script=\"Bopo\" typeface=\"Microsoft JhengHei\"/><a:font script=\"Java\" typeface=\"Javanese Text\"/><a:font script=\"Lisu\" typeface=\"Segoe UI\"/><a:font script=\"Mymr\" typeface=\"Myanmar Text\"/><a:font script=\"Nkoo\" typeface=\"Ebrima\"/><a:font script=\"Olck\" typeface=\"Nirmala UI\"/><a:font script=\"Osma\" typeface=\"Ebrima\"/><a:font script=\"Phag\" typeface=\"Phagspa\"/><a:font script=\"Syrn\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Syrj\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Syre\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Sora\" typeface=\"Nirmala UI\"/><a:font script=\"Tale\" typeface=\"Microsoft Tai Le\"/><a:font script=\"Talu\" typeface=\"Microsoft New Tai Lue\"/><a:font script=\"Tfng\" typeface=\"Ebrima\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"110000\"/><a:satMod val=\"105000\"/><a:tint val=\"67000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"105000\"/><a:satMod val=\"103000\"/><a:tint val=\"73000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"105000\"/><a:satMod val=\"109000\"/><a:tint val=\"81000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:satMod val=\"103000\"/><a:lumMod val=\"102000\"/><a:tint val=\"94000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:satMod val=\"110000\"/><a:lumMod val=\"100000\"/><a:shade val=\"100000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"99000\"/><a:satMod val=\"120000\"/><a:shade val=\"78000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"6350\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln><a:ln w=\"12700\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln><a:ln w=\"19050\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"57150\" dist=\"19050\" dir=\"5400000\" algn=\"ctr\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"63000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:solidFill><a:schemeClr val=\"phClr\"><a:tint val=\"95000\"/><a:satMod val=\"170000\"/></a:schemeClr></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"93000\"/><a:satMod val=\"150000\"/><a:shade val=\"98000\"/><a:lumMod val=\"102000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:tint val=\"98000\"/><a:satMod val=\"130000\"/><a:shade val=\"90000\"/><a:lumMod val=\"103000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"63000\"/><a:satMod val=\"120000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/><a:extLst><a:ext uri=\"{05A4C25C-085E-4340-85A3-A5531E510DB2}\"><thm15:themeFamily xmlns:thm15=\"http://schemas.microsoft.com/office/thememl/2012/main\" name=\"Office Theme\" id=\"{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}\" vid=\"{4A3C46E8-61CC-4603-A589-7422A47A8E4A}\"/></a:ext></a:extLst></a:theme>`\n}\n\n/**\n * Create presentation file (`ppt/presentation.xml`)\n * @see https://docs.microsoft.com/en-us/office/open-xml/structure-of-a-presentationml-document\n * @see http://www.datypic.com/sc/ooxml/t-p_CT_Presentation.html\n * @param {IPresentationProps} pres - presentation\n * @return {string} XML\n */\nexport function makeXmlPresentation(pres: IPresentationProps): string {\n\tlet strXml =\n\t\t`<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}` +\n\t\t`<p:presentation xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" ` +\n\t\t`xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\" ${pres.rtlMode ? 'rtl=\"1\"' : ''} saveSubsetFonts=\"1\" autoCompressPictures=\"0\">`\n\n\t// STEP 1: Add slide master (SPEC: tag 1 under <presentation>)\n\tstrXml += '<p:sldMasterIdLst><p:sldMasterId id=\"2147483648\" r:id=\"rId1\"/></p:sldMasterIdLst>'\n\n\t// STEP 2: Add all Slides (SPEC: tag 3 under <presentation>)\n\tstrXml += '<p:sldIdLst>'\n\tpres.slides.forEach(slide => (strXml += `<p:sldId id=\"${slide._slideId}\" r:id=\"rId${slide._rId}\"/>`))\n\tstrXml += '</p:sldIdLst>'\n\n\t// STEP 3: Add Notes Master (SPEC: tag 2 under <presentation>)\n\t// (NOTE: length+2 is from `presentation.xml.rels` func (since we have to match this rId, we just use same logic))\n\t// IMPORTANT: In this order (matches PPT2019) PPT will give corruption message on open!\n\t// IMPORTANT: Placing this before `<p:sldIdLst>` causes warning in modern powerpoint!\n\t// IMPORTANT: Presentations open without warning Without this line, however, the pres isnt preview in Finder anymore or viewable in iOS!\n\tstrXml += `<p:notesMasterIdLst><p:notesMasterId r:id=\"rId${pres.slides.length + 2}\"/></p:notesMasterIdLst>`\n\n\t// STEP 4: Add sizes\n\tstrXml += `<p:sldSz cx=\"${pres.presLayout.width}\" cy=\"${pres.presLayout.height}\"/>`\n\tstrXml += `<p:notesSz cx=\"${pres.presLayout.height}\" cy=\"${pres.presLayout.width}\"/>`\n\n\t// STEP 5: Add text styles\n\tstrXml += '<p:defaultTextStyle>'\n\tfor (let idy = 1; idy < 10; idy++) {\n\t\tstrXml +=\n\t\t\t`<a:lvl${idy}pPr marL=\"${(idy - 1) * 457200}\" algn=\"l\" defTabSz=\"914400\" rtl=\"0\" eaLnBrk=\"1\" latinLnBrk=\"0\" hangingPunct=\"1\">` +\n\t\t\t`<a:defRPr sz=\"1800\" kern=\"1200\"><a:solidFill><a:schemeClr val=\"tx1\"/></a:solidFill><a:latin typeface=\"+mn-lt\"/><a:ea typeface=\"+mn-ea\"/><a:cs typeface=\"+mn-cs\"/>` +\n\t\t\t`</a:defRPr></a:lvl${idy}pPr>`\n\t}\n\tstrXml += '</p:defaultTextStyle>'\n\n\t// STEP 6: Add Sections (if any)\n\tif (pres.sections && pres.sections.length > 0) {\n\t\tstrXml += '<p:extLst><p:ext uri=\"{521415D9-36F7-43E2-AB2F-B90AF26B5E84}\">'\n\t\tstrXml += '<p14:sectionLst xmlns:p14=\"http://schemas.microsoft.com/office/powerpoint/2010/main\">'\n\t\tpres.sections.forEach(sect => {\n\t\t\tstrXml += `<p14:section name=\"${encodeXmlEntities(sect.title)}\" id=\"{${getUuid('xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx')}}\"><p14:sldIdLst>`\n\t\t\tsect._slides.forEach(slide => (strXml += `<p14:sldId id=\"${slide._slideId}\"/>`))\n\t\t\tstrXml += `</p14:sldIdLst></p14:section>`\n\t\t})\n\t\tstrXml += '</p14:sectionLst></p:ext>'\n\t\tstrXml += '<p:ext uri=\"{EFAFB233-063F-42B5-8137-9DF3F51BA10A}\"><p15:sldGuideLst xmlns:p15=\"http://schemas.microsoft.com/office/powerpoint/2012/main\"/></p:ext>'\n\t\tstrXml += '</p:extLst>'\n\t}\n\n\t// Done\n\tstrXml += '</p:presentation>'\n\treturn strXml\n}\n\n/**\n * Create `ppt/presProps.xml`\n * @return {string} XML\n */\nexport function makeXmlPresProps(): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}<p:presentationPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"/>`\n}\n\n/**\n * Create `ppt/tableStyles.xml`\n * @see: http://openxmldeveloper.org/discussions/formats/f/13/p/2398/8107.aspx\n * @return {string} XML\n */\nexport function makeXmlTableStyles(): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}<a:tblStyleLst xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" def=\"{5C22544A-7EE6-4342-B048-85BDC9FD1C3A}\"/>`\n}\n\n/**\n * Creates `ppt/viewProps.xml`\n * @return {string} XML\n */\nexport function makeXmlViewProps(): string {\n\treturn `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>${CRLF}<p:viewPr xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:p=\"http://schemas.openxmlformats.org/presentationml/2006/main\"><p:normalViewPr horzBarState=\"maximized\"><p:restoredLeft sz=\"15611\"/><p:restoredTop sz=\"94610\"/></p:normalViewPr><p:slideViewPr><p:cSldViewPr snapToGrid=\"0\" snapToObjects=\"1\"><p:cViewPr varScale=\"1\"><p:scale><a:sx n=\"136\" d=\"100\"/><a:sy n=\"136\" d=\"100\"/></p:scale><p:origin x=\"216\" y=\"312\"/></p:cViewPr><p:guideLst/></p:cSldViewPr></p:slideViewPr><p:notesTextViewPr><p:cViewPr><p:scale><a:sx n=\"1\" d=\"1\"/><a:sy n=\"1\" d=\"1\"/></p:scale><p:origin x=\"0\" y=\"0\"/></p:cViewPr></p:notesTextViewPr><p:gridSpacing cx=\"76200\" cy=\"76200\"/></p:viewPr>`\n}\n\n/**\n * Checks shadow options passed by user and performs corrections if needed.\n * @param {ShadowProps} ShadowProps - shadow options\n */\nexport function correctShadowOptions(ShadowProps: ShadowProps) {\n\tif (!ShadowProps || typeof ShadowProps !== 'object') {\n\t\t//console.warn(\"`shadow` options must be an object. Ex: `{shadow: {type:'none'}}`\")\n\t\treturn\n\t}\n\n\t// OPT: `type`\n\tif (ShadowProps.type !== 'outer' && ShadowProps.type !== 'inner' && ShadowProps.type !== 'none') {\n\t\tconsole.warn('Warning: shadow.type options are `outer`, `inner` or `none`.')\n\t\tShadowProps.type = 'outer'\n\t}\n\n\t// OPT: `angle`\n\tif (ShadowProps.angle) {\n\t\t// A: REALITY-CHECK\n\t\tif (isNaN(Number(ShadowProps.angle)) || ShadowProps.angle < 0 || ShadowProps.angle > 359) {\n\t\t\tconsole.warn('Warning: shadow.angle can only be 0-359')\n\t\t\tShadowProps.angle = 270\n\t\t}\n\n\t\t// B: ROBUST: Cast any type of valid arg to int: '12', 12.3, etc. -> 12\n\t\tShadowProps.angle = Math.round(Number(ShadowProps.angle))\n\t}\n\n\t// OPT: `opacity`\n\tif (ShadowProps.opacity) {\n\t\t// A: REALITY-CHECK\n\t\tif (isNaN(Number(ShadowProps.opacity)) || ShadowProps.opacity < 0 || ShadowProps.opacity > 1) {\n\t\t\tconsole.warn('Warning: shadow.opacity can only be 0-1')\n\t\t\tShadowProps.opacity = 0.75\n\t\t}\n\n\t\t// B: ROBUST: Cast any type of valid arg to int: '12', 12.3, etc. -> 12\n\t\tShadowProps.opacity = Number(ShadowProps.opacity)\n\t}\n}\n","/**\n * PptxGenJS: Slide Object Generators\n */\n\nimport {\n\tBARCHART_COLORS,\n\tCHART_NAME,\n\tCHART_TYPE,\n\tDEF_CELL_BORDER,\n\tDEF_CELL_MARGIN_PT,\n\tDEF_FONT_COLOR,\n\tDEF_FONT_SIZE,\n\tDEF_SHAPE_LINE_COLOR,\n\tDEF_SLIDE_MARGIN_IN,\n\tEMU,\n\tIMG_PLAYBTN,\n\tMASTER_OBJECTS,\n\tPIECHART_COLORS,\n\tSHAPE_NAME,\n\tSHAPE_TYPE,\n\tSLIDE_OBJECT_TYPES,\n\tTEXT_HALIGN,\n\tTEXT_VALIGN,\n} from './core-enums'\nimport {\n\tBackgroundProps,\n\tIChartMulti,\n\tIChartOptsLib,\n\tISlideObject,\n\tImageProps,\n\tMediaProps,\n\tOptsChartGridLine,\n\tPresLayout,\n\tPresSlide,\n\tShapeLineProps,\n\tShapeProps,\n\tSlideLayout,\n\tSlideMasterProps,\n\tTableCell,\n\tTableProps,\n\tTableRow,\n\tTextProps,\n\tTextPropsOptions,\n} from './core-interfaces'\nimport { getSlidesForTableRows } from './gen-tables'\nimport { getSmartParseNumber, inch2Emu, encodeXmlEntities, getNewRelId, valToPts } from './gen-utils'\nimport { correctShadowOptions } from './gen-xml'\n\n/** counter for included charts (used for index in their filenames) */\nlet _chartCounter: number = 0\n\n/**\n * Transforms a slide definition to a slide object that is then passed to the XML transformation process.\n * @param {SlideMasterProps} slideDef - slide definition\n * @param {PresSlide|SlideLayout} target - empty slide object that should be updated by the passed definition\n */\nexport function createSlideObject(slideDef: SlideMasterProps, target: SlideLayout) {\n\t// STEP 1: Add background\n\tif (slideDef.background) addBackgroundDefinition(slideDef.background, target)\n\n\t// STEP 2: Add all Slide Master objects in the order they were given\n\tif (slideDef.objects && Array.isArray(slideDef.objects) && slideDef.objects.length > 0) {\n\t\tslideDef.objects.forEach((object, idx) => {\n\t\t\tlet key = Object.keys(object)[0]\n\t\t\tlet tgt = target as PresSlide\n\t\t\tif (MASTER_OBJECTS[key] && key === 'chart') addChartDefinition(tgt, object[key].type, object[key].data, object[key].opts)\n\t\t\telse if (MASTER_OBJECTS[key] && key === 'image') addImageDefinition(tgt, object[key])\n\t\t\telse if (MASTER_OBJECTS[key] && key === 'line') addShapeDefinition(tgt, SHAPE_TYPE.LINE, object[key])\n\t\t\telse if (MASTER_OBJECTS[key] && key === 'rect') addShapeDefinition(tgt, SHAPE_TYPE.RECTANGLE, object[key])\n\t\t\telse if (MASTER_OBJECTS[key] && key === 'text') addTextDefinition(tgt, object[key].text, object[key].options, false)\n\t\t\telse if (MASTER_OBJECTS[key] && key === 'placeholder') {\n\t\t\t\t// TODO: 20180820: Check for existing `name`?\n\t\t\t\tobject[key].options.placeholder = object[key].options.name\n\t\t\t\tdelete object[key].options.name // remap name for earier handling internally\n\t\t\t\tobject[key].options._placeholderType = object[key].options.type\n\t\t\t\tdelete object[key].options.type // remap name for earier handling internally\n\t\t\t\tobject[key].options._placeholderIdx = 100 + idx\n\t\t\t\taddTextDefinition(tgt, object[key].text, object[key].options, true)\n\t\t\t\t// TODO: ISSUE#599 - only text is suported now (add more below)\n\t\t\t\t//else if (object[key].image) addImageDefinition(tgt, object[key].image)\n\t\t\t\t/* 20200120: So... image placeholders go into the \"slideLayoutN.xml\" file and addImage doesnt do this yet...\n\t\t\t\t\t<p:sp>\n\t\t\t\t  <p:nvSpPr>\n\t\t\t\t\t<p:cNvPr id=\"7\" name=\"Picture Placeholder 6\">\n\t\t\t\t\t  <a:extLst>\n\t\t\t\t\t\t<a:ext uri=\"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}\">\n\t\t\t\t\t\t  <a16:creationId xmlns:a16=\"http://schemas.microsoft.com/office/drawing/2014/main\" id=\"{CE1AE45D-8641-0F4F-BDB5-080E69CCB034}\"/>\n\t\t\t\t\t\t</a:ext>\n\t\t\t\t\t  </a:extLst>\n\t\t\t\t\t</p:cNvPr>\n\t\t\t\t\t<p:cNvSpPr>\n\t\t\t\t*/\n\t\t\t}\n\t\t})\n\t}\n\n\t// STEP 3: Add Slide Numbers (NOTE: Do this last so numbers are not covered by objects!)\n\tif (slideDef.slideNumber && typeof slideDef.slideNumber === 'object') {\n\t\ttarget._slideNumberProps = slideDef.slideNumber\n\t}\n}\n\n/**\n * Generate the chart based on input data.\n * OOXML Chart Spec: ISO/IEC 29500-1:2016(E)\n *\n * @param {CHART_NAME | IChartMulti[]} `type` should belong to: 'column', 'pie'\n * @param {[]} `data` a JSON object with follow the following format\n * @param {IChartOptsLib} `opt` chart options\n * @param {PresSlide} `target` slide object that the chart will be added to\n * @return {object} chart object\n * {\n *   title: 'eSurvey chart',\n *   data: [\n *\t\t{\n *\t\t\tname: 'Income',\n *\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\n *\t\t\tvalues: [23.5, 26.2, 30.1, 29.5, 24.6]\n *\t\t},\n *\t\t{\n *\t\t\tname: 'Expense',\n *\t\t\tlabels: ['2005', '2006', '2007', '2008', '2009'],\n *\t\t\tvalues: [18.1, 22.8, 23.9, 25.1, 25]\n *\t\t}\n *\t ]\n *\t}\n */\nexport function addChartDefinition(target: PresSlide, type: CHART_NAME | IChartMulti[], data: any[], opt: IChartOptsLib): object {\n\tfunction correctGridLineOptions(glOpts: OptsChartGridLine) {\n\t\tif (!glOpts || glOpts.style === 'none') return\n\t\tif (glOpts.size !== undefined && (isNaN(Number(glOpts.size)) || glOpts.size <= 0)) {\n\t\t\tconsole.warn('Warning: chart.gridLine.size must be greater than 0.')\n\t\t\tdelete glOpts.size // delete prop to used defaults\n\t\t}\n\t\tif (glOpts.style && ['solid', 'dash', 'dot'].indexOf(glOpts.style) < 0) {\n\t\t\tconsole.warn('Warning: chart.gridLine.style options: `solid`, `dash`, `dot`.')\n\t\t\tdelete glOpts.style\n\t\t}\n\t}\n\n\tlet chartId = ++_chartCounter\n\tlet resultObject = {\n\t\t_type: null,\n\t\ttext: null,\n\t\toptions: null,\n\t\tchartRid: null,\n\t}\n\t// DESIGN: `type` can an object (ex: `pptx.charts.DOUGHNUT`) or an array of chart objects\n\t// EX: addChartDefinition([ { type:pptx.charts.BAR, data:{name:'', labels:[], values[]} }, {<etc>} ])\n\t// Multi-Type Charts\n\tlet tmpOpt\n\tlet tmpData = [],\n\t\toptions: IChartOptsLib\n\tif (Array.isArray(type)) {\n\t\t// For multi-type charts there needs to be data for each type,\n\t\t// as well as a single data source for non-series operations.\n\t\t// The data is indexed below to keep the data in order when segmented\n\t\t// into types.\n\t\ttype.forEach(obj => {\n\t\t\ttmpData = tmpData.concat(obj.data)\n\t\t})\n\t\ttmpOpt = data || opt\n\t} else {\n\t\ttmpData = data\n\t\ttmpOpt = opt\n\t}\n\ttmpData.forEach((item, i) => {\n\t\titem.index = i\n\t})\n\toptions = tmpOpt && typeof tmpOpt === 'object' ? tmpOpt : {}\n\n\t// STEP 1: TODO: check for reqd fields, correct type, etc\n\t// `type` exists in CHART_TYPE\n\t// Array.isArray(data)\n\t/*\n\t\tif ( Array.isArray(rel.data) && rel.data.length > 0 && typeof rel.data[0] === 'object'\n\t\t\t&& rel.data[0].labels && Array.isArray(rel.data[0].labels)\n\t\t\t&& rel.data[0].values && Array.isArray(rel.data[0].values) ) {\n\t\t\tobj = rel.data[0];\n\t\t}\n\t\telse {\n\t\t\tconsole.warn(\"USAGE: addChart( 'pie', [ {name:'Sales', labels:['Jan','Feb'], values:[10,20]} ], {x:1, y:1} )\");\n\t\t\treturn;\n\t\t}\n\t\t*/\n\n\t// STEP 2: Set default options/decode user options\n\t// A: Core\n\toptions._type = type\n\toptions.x = typeof options.x !== 'undefined' && options.x != null && !isNaN(Number(options.x)) ? options.x : 1\n\toptions.y = typeof options.y !== 'undefined' && options.y != null && !isNaN(Number(options.y)) ? options.y : 1\n\toptions.w = options.w || '50%'\n\toptions.h = options.h || '50%'\n\n\t// B: Options: misc\n\tif (['bar', 'col'].indexOf(options.barDir || '') < 0) options.barDir = 'col'\n\t// IMPORTANT: 'bestFit' will cause issues with PPT-Online in some cases, so defualt to 'ctr'!\n\tif (['bestFit', 'b', 'ctr', 'inBase', 'inEnd', 'l', 'outEnd', 'r', 't'].indexOf(options.dataLabelPosition || '') < 0)\n\t\toptions.dataLabelPosition = options._type === CHART_TYPE.PIE || options._type === CHART_TYPE.DOUGHNUT ? 'bestFit' : 'ctr'\n\toptions.dataLabelBkgrdColors = options.dataLabelBkgrdColors === true || options.dataLabelBkgrdColors === false ? options.dataLabelBkgrdColors : false\n\tif (['b', 'l', 'r', 't', 'tr'].indexOf(options.legendPos || '') < 0) options.legendPos = 'r'\n\t// barGrouping: \"21.2.3.17 ST_Grouping (Grouping)\"\n\tif (['clustered', 'standard', 'stacked', 'percentStacked'].indexOf(options.barGrouping || '') < 0) options.barGrouping = 'standard'\n\tif (options.barGrouping.indexOf('tacked') > -1) {\n\t\toptions.dataLabelPosition = 'ctr' // IMPORTANT: PPT-Online will not open Presentation when 'outEnd' etc is used on stacked!\n\t\tif (!options.barGapWidthPct) options.barGapWidthPct = 50\n\t}\n\t// 3D bar: ST_Shape\n\tif (['cone', 'coneToMax', 'box', 'cylinder', 'pyramid', 'pyramidToMax'].indexOf(options.bar3DShape || '') < 0) options.bar3DShape = 'box'\n\t// lineDataSymbol: http://www.datypic.com/sc/ooxml/a-val-32.html\n\t// Spec has [plus,star,x] however neither PPT2013 nor PPT-Online support them\n\tif (['circle', 'dash', 'diamond', 'dot', 'none', 'square', 'triangle'].indexOf(options.lineDataSymbol || '') < 0) options.lineDataSymbol = 'circle'\n\tif (['gap', 'span'].indexOf(options.displayBlanksAs || '') < 0) options.displayBlanksAs = 'span'\n\tif (['standard', 'marker', 'filled'].indexOf(options.radarStyle || '') < 0) options.radarStyle = 'standard'\n\toptions.lineDataSymbolSize = options.lineDataSymbolSize && !isNaN(options.lineDataSymbolSize) ? options.lineDataSymbolSize : 6\n\toptions.lineDataSymbolLineSize = options.lineDataSymbolLineSize && !isNaN(options.lineDataSymbolLineSize) ? valToPts(options.lineDataSymbolLineSize) : valToPts(0.75)\n\t// `layout` allows the override of PPT defaults to maximize space\n\tif (options.layout) {\n\t\t;['x', 'y', 'w', 'h'].forEach(key => {\n\t\t\tlet val = options.layout[key]\n\t\t\tif (isNaN(Number(val)) || val < 0 || val > 1) {\n\t\t\t\tconsole.warn('Warning: chart.layout.' + key + ' can only be 0-1')\n\t\t\t\tdelete options.layout[key] // remove invalid value so that default will be used\n\t\t\t}\n\t\t})\n\t}\n\n\t// Set gridline defaults\n\toptions.catGridLine = options.catGridLine || (options._type === CHART_TYPE.SCATTER ? { color: 'D9D9D9', size: 1 } : { style: 'none' })\n\toptions.valGridLine = options.valGridLine || (options._type === CHART_TYPE.SCATTER ? { color: 'D9D9D9', size: 1 } : {})\n\toptions.serGridLine = options.serGridLine || (options._type === CHART_TYPE.SCATTER ? { color: 'D9D9D9', size: 1 } : { style: 'none' })\n\tcorrectGridLineOptions(options.catGridLine)\n\tcorrectGridLineOptions(options.valGridLine)\n\tcorrectGridLineOptions(options.serGridLine)\n\tcorrectShadowOptions(options.shadow)\n\n\t// C: Options: plotArea\n\toptions.showDataTable = options.showDataTable === true || options.showDataTable === false ? options.showDataTable : false\n\toptions.showDataTableHorzBorder = options.showDataTableHorzBorder === true || options.showDataTableHorzBorder === false ? options.showDataTableHorzBorder : true\n\toptions.showDataTableVertBorder = options.showDataTableVertBorder === true || options.showDataTableVertBorder === false ? options.showDataTableVertBorder : true\n\toptions.showDataTableOutline = options.showDataTableOutline === true || options.showDataTableOutline === false ? options.showDataTableOutline : true\n\toptions.showDataTableKeys = options.showDataTableKeys === true || options.showDataTableKeys === false ? options.showDataTableKeys : true\n\toptions.showLabel = options.showLabel === true || options.showLabel === false ? options.showLabel : false\n\toptions.showLegend = options.showLegend === true || options.showLegend === false ? options.showLegend : false\n\toptions.showPercent = options.showPercent === true || options.showPercent === false ? options.showPercent : true\n\toptions.showTitle = options.showTitle === true || options.showTitle === false ? options.showTitle : false\n\toptions.showValue = options.showValue === true || options.showValue === false ? options.showValue : false\n\toptions.showLeaderLines = options.showLeaderLines === true || options.showLeaderLines === false ? options.showLeaderLines : false\n\toptions.catAxisLineShow = typeof options.catAxisLineShow !== 'undefined' ? options.catAxisLineShow : true\n\toptions.valAxisLineShow = typeof options.valAxisLineShow !== 'undefined' ? options.valAxisLineShow : true\n\toptions.serAxisLineShow = typeof options.serAxisLineShow !== 'undefined' ? options.serAxisLineShow : true\n\n\toptions.v3DRotX = !isNaN(options.v3DRotX) && options.v3DRotX >= -90 && options.v3DRotX <= 90 ? options.v3DRotX : 30\n\toptions.v3DRotY = !isNaN(options.v3DRotY) && options.v3DRotY >= 0 && options.v3DRotY <= 360 ? options.v3DRotY : 30\n\toptions.v3DRAngAx = options.v3DRAngAx === true || options.v3DRAngAx === false ? options.v3DRAngAx : true\n\toptions.v3DPerspective = !isNaN(options.v3DPerspective) && options.v3DPerspective >= 0 && options.v3DPerspective <= 240 ? options.v3DPerspective : 30\n\n\t// D: Options: chart\n\toptions.barGapWidthPct = !isNaN(options.barGapWidthPct) && options.barGapWidthPct >= 0 && options.barGapWidthPct <= 1000 ? options.barGapWidthPct : 150\n\toptions.barGapDepthPct = !isNaN(options.barGapDepthPct) && options.barGapDepthPct >= 0 && options.barGapDepthPct <= 1000 ? options.barGapDepthPct : 150\n\n\toptions.chartColors = Array.isArray(options.chartColors)\n\t\t? options.chartColors\n\t\t: options._type === CHART_TYPE.PIE || options._type === CHART_TYPE.DOUGHNUT\n\t\t? PIECHART_COLORS\n\t\t: BARCHART_COLORS\n\toptions.chartColorsOpacity = options.chartColorsOpacity && !isNaN(options.chartColorsOpacity) ? options.chartColorsOpacity : null\n\t//\n\toptions.border = options.border && typeof options.border === 'object' ? options.border : null\n\tif (options.border && (!options.border.pt || isNaN(options.border.pt))) options.border.pt = 1\n\tif (options.border && (!options.border.color || typeof options.border.color !== 'string' || options.border.color.length !== 6)) options.border.color = '363636'\n\t//\n\toptions.dataBorder = options.dataBorder && typeof options.dataBorder === 'object' ? options.dataBorder : null\n\tif (options.dataBorder && (!options.dataBorder.pt || isNaN(options.dataBorder.pt))) options.dataBorder.pt = 0.75\n\tif (options.dataBorder && (!options.dataBorder.color || typeof options.dataBorder.color !== 'string' || options.dataBorder.color.length !== 6))\n\t\toptions.dataBorder.color = 'F9F9F9'\n\t//\n\tif (!options.dataLabelFormatCode && options._type === CHART_TYPE.SCATTER) options.dataLabelFormatCode = 'General'\n\toptions.dataLabelFormatCode = options.dataLabelFormatCode && typeof options.dataLabelFormatCode === 'string' ? options.dataLabelFormatCode : '#,##0'\n\tif (options._type === CHART_TYPE.PIE || options._type === CHART_TYPE.DOUGHNUT) options.dataLabelFormatCode = options.showPercent ? '0%' : 'General'\n\t//\n\t// Set default format for Scatter chart labels to custom string if not defined\n\tif (!options.dataLabelFormatScatter && options._type === CHART_TYPE.SCATTER) options.dataLabelFormatScatter = 'custom'\n\t//\n\toptions.lineSize = typeof options.lineSize === 'number' ? options.lineSize : 2\n\toptions.valAxisMajorUnit = typeof options.valAxisMajorUnit === 'number' ? options.valAxisMajorUnit : null\n\toptions.valAxisCrossesAt = options.valAxisCrossesAt || 'autoZero'\n\n\t// STEP 4: Set props\n\tresultObject._type = 'chart'\n\tresultObject.options = options\n\tresultObject.chartRid = getNewRelId(target)\n\n\t// STEP 5: Add this chart to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\n\ttarget._relsChart.push({\n\t\trId: getNewRelId(target),\n\t\tdata: tmpData,\n\t\topts: options,\n\t\ttype: options._type,\n\t\tglobalId: chartId,\n\t\tfileName: 'chart' + chartId + '.xml',\n\t\tTarget: '/ppt/charts/chart' + chartId + '.xml',\n\t})\n\n\ttarget._slideObjects.push(resultObject)\n\treturn resultObject\n}\n\n/**\n * Adds an image object to a slide definition.\n * This method can be called with only two args (opt, target) - this is supposed to be the only way in future.\n * @param {ImageProps} `opt` - object containing `path`/`data`, `x`, `y`, etc.\n * @param {PresSlide} `target` - slide that the image should be added to (if not specified as the 2nd arg)\n * @note: Remote images (eg: \"http://whatev.com/blah\"/from web and/or remote server arent supported yet - we'd need to create an <img>, load it, then send to canvas\n * @see: https://stackoverflow.com/questions/164181/how-to-fetch-a-remote-image-to-display-in-a-canvas)\n */\nexport function addImageDefinition(target: PresSlide, opt: ImageProps) {\n\tlet newObject: ISlideObject = {\n\t\t_type: null,\n\t\ttext: null,\n\t\toptions: null,\n\t\timage: null,\n\t\timageRid: null,\n\t\thyperlink: null,\n\t}\n\t// FIRST: Set vars for this image (object param replaces positional args in 1.1.0)\n\tlet intPosX = opt.x || 0\n\tlet intPosY = opt.y || 0\n\tlet intWidth = opt.w || 0\n\tlet intHeight = opt.h || 0\n\tlet sizing = opt.sizing || null\n\tlet objHyperlink = opt.hyperlink || ''\n\tlet strImageData = opt.data || ''\n\tlet strImagePath = opt.path || ''\n\tlet imageRelId = getNewRelId(target)\n\n\t// REALITY-CHECK:\n\tif (!strImagePath && !strImageData) {\n\t\tconsole.error(`ERROR: addImage() requires either 'data' or 'path' parameter!`)\n\t\treturn null\n\t} else if (strImagePath && typeof strImagePath !== 'string') {\n\t\tconsole.error(`ERROR: addImage() 'path' should be a string, ex: {path:'/img/sample.png'} - you sent ${strImagePath}`)\n\t\treturn null\n\t} else if (strImageData && typeof strImageData !== 'string') {\n\t\tconsole.error(`ERROR: addImage() 'data' should be a string, ex: {data:'image/png;base64,NMP[...]'} - you sent ${strImageData}`)\n\t\treturn null\n\t} else if (strImageData && typeof strImageData === 'string' && strImageData.toLowerCase().indexOf('base64,') === -1) {\n\t\tconsole.error(\"ERROR: Image `data` value lacks a base64 header! Ex: 'image/png;base64,NMP[...]')\")\n\t\treturn null\n\t}\n\n\t// STEP 1: Set extension\n\t// NOTE: Split to address URLs with params (eg: `path/brent.jpg?someParam=true`)\n\tlet strImgExtn =\n\t\tstrImagePath\n\t\t\t.substring(strImagePath.lastIndexOf('/') + 1)\n\t\t\t.split('?')[0]\n\t\t\t.split('.')\n\t\t\t.pop()\n\t\t\t.split('#')[0] || 'png'\n\n\t// However, pre-encoded images can be whatever mime-type they want (and good for them!)\n\tif (strImageData && /image\\/(\\w+);/.exec(strImageData) && /image\\/(\\w+);/.exec(strImageData).length > 0) {\n\t\tstrImgExtn = /image\\/(\\w+);/.exec(strImageData)[1]\n\t} else if (strImageData && strImageData.toLowerCase().indexOf('image/svg+xml') > -1) {\n\t\tstrImgExtn = 'svg'\n\t}\n\n\t// STEP 2: Set type/path\n\tnewObject._type = SLIDE_OBJECT_TYPES.image\n\tnewObject.image = strImagePath || 'preencoded.png'\n\n\t// STEP 3: Set image properties & options\n\t// FIXME: Measure actual image when no intWidth/intHeight params passed\n\t// ....: This is an async process: we need to make getSizeFromImage use callback, then set H/W...\n\t// if ( !intWidth || !intHeight ) { var imgObj = getSizeFromImage(strImagePath);\n\tnewObject.options = {\n\t\tx: intPosX || 0,\n\t\ty: intPosY || 0,\n\t\tw: intWidth || 1,\n\t\th: intHeight || 1,\n\t\trounding: typeof opt.rounding === 'boolean' ? opt.rounding : false,\n\t\tsizing: sizing,\n\t\tplaceholder: opt.placeholder,\n\t\trotate: opt.rotate || 0,\n\t}\n\n\t// STEP 4: Add this image to this Slide Rels (rId/rels count spans all slides! Count all images to get next rId)\n\tif (strImgExtn === 'svg') {\n\t\t// SVG files consume *TWO* rId's: (a png version and the svg image)\n\t\t// <Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"../media/image1.png\"/>\n\t\t// <Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"../media/image2.svg\"/>\n\t\ttarget._relsMedia.push({\n\t\t\tpath: strImagePath || strImageData + 'png',\n\t\t\ttype: 'image/png',\n\t\t\textn: 'png',\n\t\t\tdata: strImageData || '',\n\t\t\trId: imageRelId,\n\t\t\tTarget: '../media/image-' + target._slideNum + '-' + (target._relsMedia.length + 1) + '.png',\n\t\t\tisSvgPng: true,\n\t\t\tsvgSize: { w: getSmartParseNumber(newObject.options.w, 'X', target._presLayout), h: getSmartParseNumber(newObject.options.h, 'Y', target._presLayout) },\n\t\t})\n\t\tnewObject.imageRid = imageRelId\n\t\ttarget._relsMedia.push({\n\t\t\tpath: strImagePath || strImageData,\n\t\t\ttype: 'image/svg+xml',\n\t\t\textn: strImgExtn,\n\t\t\tdata: strImageData || '',\n\t\t\trId: imageRelId + 1,\n\t\t\tTarget: '../media/image-' + target._slideNum + '-' + (target._relsMedia.length + 1) + '.' + strImgExtn,\n\t\t})\n\t\tnewObject.imageRid = imageRelId + 1\n\t} else {\n\t\ttarget._relsMedia.push({\n\t\t\tpath: strImagePath || 'preencoded.' + strImgExtn,\n\t\t\ttype: 'image/' + strImgExtn,\n\t\t\textn: strImgExtn,\n\t\t\tdata: strImageData || '',\n\t\t\trId: imageRelId,\n\t\t\tTarget: '../media/image-' + target._slideNum + '-' + (target._relsMedia.length + 1) + '.' + strImgExtn,\n\t\t})\n\t\tnewObject.imageRid = imageRelId\n\t}\n\n\t// STEP 5: Hyperlink support\n\tif (typeof objHyperlink === 'object') {\n\t\tif (!objHyperlink.url && !objHyperlink.slide) throw new Error('ERROR: `hyperlink` option requires either: `url` or `slide`')\n\t\telse {\n\t\t\timageRelId++\n\n\t\t\ttarget._rels.push({\n\t\t\t\ttype: SLIDE_OBJECT_TYPES.hyperlink,\n\t\t\t\tdata: objHyperlink.slide ? 'slide' : 'dummy',\n\t\t\t\trId: imageRelId,\n\t\t\t\tTarget: objHyperlink.url || objHyperlink.slide.toString(),\n\t\t\t})\n\n\t\t\tobjHyperlink._rId = imageRelId\n\t\t\tnewObject.hyperlink = objHyperlink\n\t\t}\n\t}\n\n\t// STEP 6: Add object to slide\n\ttarget._slideObjects.push(newObject)\n}\n\n/**\n * Adds a media object to a slide definition.\n * @param {PresSlide} `target` - slide object that the text will be added to\n * @param {MediaProps} `opt` - media options\n */\nexport function addMediaDefinition(target: PresSlide, opt: MediaProps) {\n\tlet intRels = target._relsMedia.length + 1\n\tlet intPosX = opt.x || 0\n\tlet intPosY = opt.y || 0\n\tlet intSizeX = opt.w || 2\n\tlet intSizeY = opt.h || 2\n\tlet strData = opt.data || ''\n\tlet strLink = opt.link || ''\n\tlet strPath = opt.path || ''\n\tlet strType = opt.type || 'audio'\n\tlet strExtn = 'mp3'\n\tlet slideData: ISlideObject = {\n\t\t_type: SLIDE_OBJECT_TYPES.media,\n\t}\n\n\t// STEP 1: REALITY-CHECK\n\tif (!strPath && !strData && strType !== 'online') {\n\t\tthrow new Error(\"addMedia() error: either 'data' or 'path' are required!\")\n\t} else if (strData && strData.toLowerCase().indexOf('base64,') === -1) {\n\t\tthrow new Error(\"addMedia() error: `data` value lacks a base64 header! Ex: 'video/mpeg;base64,NMP[...]')\")\n\t}\n\t// Online Video: requires `link`\n\tif (strType === 'online' && !strLink) {\n\t\tthrow new Error('addMedia() error: online videos require `link` value')\n\t}\n\n\t// FIXME: 20190707\n\t//strType = strData ? strData.split(';')[0].split('/')[0] : strType\n\tstrExtn = strData ? strData.split(';')[0].split('/')[1] : strPath.split('.').pop()\n\n\t// STEP 2: Set type, media\n\tslideData.mtype = strType\n\tslideData.media = strPath || 'preencoded.mov'\n\tslideData.options = {}\n\n\t// STEP 3: Set media properties & options\n\tslideData.options.x = intPosX\n\tslideData.options.y = intPosY\n\tslideData.options.w = intSizeX\n\tslideData.options.h = intSizeY\n\n\t// STEP 4: Add this media to this Slide Rels (rId/rels count spans all slides! Count all media to get next rId)\n\t// NOTE: rId starts at 2 (hence the intRels+1 below) as slideLayout.xml is rId=1!\n\tif (strType === 'online') {\n\t\t// A: Add video\n\t\ttarget._relsMedia.push({\n\t\t\tpath: strPath || 'preencoded' + strExtn,\n\t\t\tdata: 'dummy',\n\t\t\ttype: 'online',\n\t\t\textn: strExtn,\n\t\t\trId: intRels + 1,\n\t\t\tTarget: strLink,\n\t\t})\n\t\tslideData.mediaRid = target._relsMedia[target._relsMedia.length - 1].rId\n\n\t\t// B: Add preview/overlay image\n\t\ttarget._relsMedia.push({\n\t\t\tpath: 'preencoded.png',\n\t\t\tdata: IMG_PLAYBTN,\n\t\t\ttype: 'image/png',\n\t\t\textn: 'png',\n\t\t\trId: intRels + 2,\n\t\t\tTarget: '../media/image-' + target._slideNum + '-' + (target._relsMedia.length + 1) + '.png',\n\t\t})\n\t} else {\n\t\t/* NOTE: Audio/Video files consume *TWO* rId's:\n\t\t * <Relationship Id=\"rId2\" Target=\"../media/media1.mov\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/video\"/>\n\t\t * <Relationship Id=\"rId3\" Target=\"../media/media1.mov\" Type=\"http://schemas.microsoft.com/office/2007/relationships/media\"/>\n\t\t */\n\n\t\t// A: \"relationships/video\"\n\t\ttarget._relsMedia.push({\n\t\t\tpath: strPath || 'preencoded' + strExtn,\n\t\t\ttype: strType + '/' + strExtn,\n\t\t\textn: strExtn,\n\t\t\tdata: strData || '',\n\t\t\trId: intRels + 0,\n\t\t\tTarget: '../media/media-' + target._slideNum + '-' + (target._relsMedia.length + 1) + '.' + strExtn,\n\t\t})\n\t\tslideData.mediaRid = target._relsMedia[target._relsMedia.length - 1].rId\n\n\t\t// B: \"relationships/media\"\n\t\ttarget._relsMedia.push({\n\t\t\tpath: strPath || 'preencoded' + strExtn,\n\t\t\ttype: strType + '/' + strExtn,\n\t\t\textn: strExtn,\n\t\t\tdata: strData || '',\n\t\t\trId: intRels + 1,\n\t\t\tTarget: '../media/media-' + target._slideNum + '-' + (target._relsMedia.length + 0) + '.' + strExtn,\n\t\t})\n\n\t\t// C: Add preview/overlay image\n\t\ttarget._relsMedia.push({\n\t\t\tdata: IMG_PLAYBTN,\n\t\t\tpath: 'preencoded.png',\n\t\t\ttype: 'image/png',\n\t\t\textn: 'png',\n\t\t\trId: intRels + 2,\n\t\t\tTarget: '../media/image-' + target._slideNum + '-' + (target._relsMedia.length + 1) + '.png',\n\t\t})\n\t}\n\n\t// LAST\n\ttarget._slideObjects.push(slideData)\n}\n\n/**\n * Adds Notes to a slide.\n * @param {String} `notes`\n * @param {Object} opt (*unused*)\n * @param {PresSlide} `target` slide object\n * @since 2.3.0\n */\nexport function addNotesDefinition(target: PresSlide, notes: string) {\n\ttarget._slideObjects.push({\n\t\t_type: SLIDE_OBJECT_TYPES.notes,\n\t\ttext: notes,\n\t})\n}\n\n/**\n * Adds a shape object to a slide definition.\n * @param {PresSlide} target slide object that the shape should be added to\n * @param {SHAPE_NAME} shapeName shape name\n * @param {ShapeProps} opts shape options\n */\nexport function addShapeDefinition(target: PresSlide, shapeName: SHAPE_NAME, opts: ShapeProps) {\n\tlet options = typeof opts === 'object' ? opts : {}\n\toptions.line = options.line || ({ type: 'none' } as ShapeLineProps)\n\tlet newObject: ISlideObject = {\n\t\t_type: SLIDE_OBJECT_TYPES.text,\n\t\tshape: shapeName || SHAPE_TYPE.RECTANGLE,\n\t\toptions: options,\n\t\ttext: null,\n\t}\n\n\t// Reality check\n\tif (!shapeName) throw new Error('Missing/Invalid shape parameter! Example: `addShape(pptxgen.shapes.LINE, {x:1, y:1, w:1, h:1});`')\n\n\t// 1: ShapeLineProps defaults\n\tlet newLineOpts: ShapeLineProps = {\n\t\ttype: options.line.type || 'solid',\n\t\tcolor: options.line.color || DEF_SHAPE_LINE_COLOR,\n\t\ttransparency: options.line.transparency || 0,\n\t\twidth: options.line.width || 1,\n\t\tdashType: options.line.dashType || 'solid',\n\t\tbeginArrowType: options.line.beginArrowType || null,\n\t\tendArrowType: options.line.endArrowType || null,\n\t}\n\tif (typeof options.line === 'object' && options.line.type !== 'none') options.line = newLineOpts\n\n\t// 2: Set options defaults\n\toptions.x = options.x || (options.x === 0 ? 0 : 1)\n\toptions.y = options.y || (options.y === 0 ? 0 : 1)\n\toptions.w = options.w || (options.w === 0 ? 0 : 1)\n\toptions.h = options.h || (options.h === 0 ? 0 : 1)\n\n\t// 3: Handle line (lots of deprecated opts)\n\tif (typeof options.line === 'string') {\n\t\tlet tmpOpts = newLineOpts\n\t\ttmpOpts.color = options.line!.toString() // @deprecated `options.line` string (was line color)\n\t\toptions.line = tmpOpts\n\t}\n\tif (typeof options.lineSize === 'number') options.line.width = options.lineSize // @deprecated (part of `ShapeLineProps` now)\n\tif (typeof options.lineDash === 'string') options.line.dashType = options.lineDash // @deprecated (part of `ShapeLineProps` now)\n\tif (typeof options.lineHead === 'string') options.line.beginArrowType = options.lineHead // @deprecated (part of `ShapeLineProps` now)\n\tif (typeof options.lineTail === 'string') options.line.endArrowType = options.lineTail // @deprecated (part of `ShapeLineProps` now)\n\n\t// 4: Create hyperlink rels\n\tcreateHyperlinkRels(target, newObject)\n\n\t// LAST: Add object to slide\n\ttarget._slideObjects.push(newObject)\n}\n\n/**\n * Adds a table object to a slide definition.\n * @param {PresSlide} target - slide object that the table should be added to\n * @param {TableRow[]} tableRows - table data\n * @param {TableProps} options - table options\n * @param {SlideLayout} slideLayout - Slide layout\n * @param {PresLayout} presLayout - Presentation layout\n * @param {Function} addSlide - method\n * @param {Function} getSlide - method\n */\nexport function addTableDefinition(\n\ttarget: PresSlide,\n\ttableRows: TableRow[],\n\toptions: TableProps,\n\tslideLayout: SlideLayout,\n\tpresLayout: PresLayout,\n\taddSlide: Function,\n\tgetSlide: Function\n) {\n\tlet opt: TableProps = options && typeof options === 'object' ? options : {}\n\tlet slides: PresSlide[] = [target] // Create array of Slides as more may be added by auto-paging\n\n\t// STEP 1: REALITY-CHECK\n\t{\n\t\t// A: check for empty\n\t\tif (tableRows === null || tableRows.length === 0 || !Array.isArray(tableRows)) {\n\t\t\tthrow new Error(`addTable: Array expected! EX: 'slide.addTable( [rows], {options} );' (https://gitbrent.github.io/PptxGenJS/docs/api-tables.html)`)\n\t\t}\n\n\t\t// B: check for non-well-formatted array (ex: rows=['a','b'] instead of [['a','b']])\n\t\tif (!tableRows[0] || !Array.isArray(tableRows[0])) {\n\t\t\tthrow new Error(\n\t\t\t\t`addTable: 'rows' should be an array of cells! EX: 'slide.addTable( [ ['A'], ['B'], {text:'C',options:{align:'center'}} ] );' (https://gitbrent.github.io/PptxGenJS/docs/api-tables.html)`\n\t\t\t)\n\t\t}\n\n\t\t// TODO: FUTURE: This is wacky and wont function right (shows .w value when there is none from demo.js?!) 20191219\n\t\t/*\n\t\tif (opt.w && opt.colW) {\n\t\t\tconsole.warn('addTable: please use either `colW` or `w` - not both (table will use `colW` and ignore `w`)')\n\t\t\tconsole.log(`${opt.w} ${opt.colW}`)\n\t\t}\n\t\t*/\n\t}\n\n\t// STEP 2: Transform `tableRows` into well-formatted TableCell's\n\t// tableRows can be object or plain text array: `[{text:'cell 1'}, {text:'cell 2', options:{color:'ff0000'}}]` | `[\"cell 1\", \"cell 2\"]`\n\tlet arrRows: TableCell[][] = []\n\ttableRows.forEach(row => {\n\t\tlet newRow: TableCell[] = []\n\n\t\tif (Array.isArray(row)) {\n\t\t\trow.forEach((cell: number | string | TableCell) => {\n\t\t\t\t// A:\n\t\t\t\tlet newCell: TableCell = {\n\t\t\t\t\t_type: SLIDE_OBJECT_TYPES.tablecell,\n\t\t\t\t\ttext: '',\n\t\t\t\t\toptions: typeof cell === 'object' && cell.options ? cell.options : {},\n\t\t\t\t}\n\n\t\t\t\t// B:\n\t\t\t\tif (typeof cell === 'string' || typeof cell === 'number') newCell.text = cell.toString()\n\t\t\t\telse if (cell.text) {\n\t\t\t\t\t// Cell can contain complex text type, or string, or number\n\t\t\t\t\tif (typeof cell.text === 'string' || typeof cell.text === 'number') newCell.text = cell.text.toString()\n\t\t\t\t\telse if (cell.text) newCell.text = cell.text\n\t\t\t\t\t// Capture options\n\t\t\t\t\tif (cell.options && typeof cell.options === 'object') newCell.options = cell.options\n\t\t\t\t}\n\n\t\t\t\t// C: Set cell borders\n\t\t\t\tnewCell.options.border = newCell.options.border || opt.border || [{ type: 'none' }, { type: 'none' }, { type: 'none' }, { type: 'none' }]\n\t\t\t\tlet cellBorder = newCell.options.border\n\n\t\t\t\t// CASE 1: border interface is: BorderOptions | [BorderOptions, BorderOptions, BorderOptions, BorderOptions]\n\t\t\t\tif (!Array.isArray(cellBorder) && typeof cellBorder === 'object') newCell.options.border = [cellBorder, cellBorder, cellBorder, cellBorder]\n\t\t\t\t// Handle: [null, null, {type:'solid'}, null]\n\t\t\t\tif (!newCell.options.border[0]) newCell.options.border[0] = { type: 'none' }\n\t\t\t\tif (!newCell.options.border[1]) newCell.options.border[1] = { type: 'none' }\n\t\t\t\tif (!newCell.options.border[2]) newCell.options.border[2] = { type: 'none' }\n\t\t\t\tif (!newCell.options.border[3]) newCell.options.border[3] = { type: 'none' }\n\n\t\t\t\t// set complete BorderOptions for all sides\n\t\t\t\tlet arrSides = [0, 1, 2, 3]\n\t\t\t\tarrSides.forEach(idx => {\n\t\t\t\t\tnewCell.options.border[idx] = {\n\t\t\t\t\t\ttype: newCell.options.border[idx].type || DEF_CELL_BORDER.type,\n\t\t\t\t\t\tcolor: newCell.options.border[idx].color || DEF_CELL_BORDER.color,\n\t\t\t\t\t\tpt: typeof newCell.options.border[idx].pt === 'number' ? newCell.options.border[idx].pt : DEF_CELL_BORDER.pt,\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\t// LAST:\n\t\t\t\tnewRow.push(newCell)\n\t\t\t})\n\t\t} else {\n\t\t\tconsole.log('addTable: tableRows has a bad row. A row should be an array of cells. You provided:')\n\t\t\tconsole.log(row)\n\t\t}\n\n\t\tarrRows.push(newRow)\n\t})\n\n\t// STEP 3: Set options\n\topt.x = getSmartParseNumber(opt.x || (opt.x === 0 ? 0 : EMU / 2), 'X', presLayout)\n\topt.y = getSmartParseNumber(opt.y || (opt.y === 0 ? 0 : EMU / 2), 'Y', presLayout)\n\tif (opt.h) opt.h = getSmartParseNumber(opt.h, 'Y', presLayout) // NOTE: Dont set default `h` - leaving it null triggers auto-rowH in `makeXMLSlide()`\n\topt.fontSize = opt.fontSize || DEF_FONT_SIZE\n\topt.margin = opt.margin === 0 || opt.margin ? opt.margin : DEF_CELL_MARGIN_PT\n\tif (typeof opt.margin === 'number') opt.margin = [Number(opt.margin), Number(opt.margin), Number(opt.margin), Number(opt.margin)]\n\tif (!opt.color) opt.color = opt.color || DEF_FONT_COLOR // Set default color if needed (table option > inherit from Slide > default to black)\n\tif (typeof opt.border === 'string') {\n\t\tconsole.warn(\"addTable `border` option must be an object. Ex: `{border: {type:'none'}}`\")\n\t\topt.border = null\n\t} else if (Array.isArray(opt.border)) {\n\t\t;[0, 1, 2, 3].forEach(idx => {\n\t\t\topt.border[idx] = opt.border[idx]\n\t\t\t\t? { type: opt.border[idx].type || DEF_CELL_BORDER.type, color: opt.border[idx].color || DEF_CELL_BORDER.color, pt: opt.border[idx].pt || DEF_CELL_BORDER.pt }\n\t\t\t\t: { type: 'none' }\n\t\t})\n\t}\n\n\topt.autoPage = typeof opt.autoPage === 'boolean' ? opt.autoPage : false\n\topt.autoPageRepeatHeader = typeof opt.autoPageRepeatHeader === 'boolean' ? opt.autoPageRepeatHeader : false\n\topt.autoPageHeaderRows = typeof opt.autoPageHeaderRows !== 'undefined' && !isNaN(Number(opt.autoPageHeaderRows)) ? Number(opt.autoPageHeaderRows) : 1\n\topt.autoPageLineWeight = typeof opt.autoPageLineWeight !== 'undefined' && !isNaN(Number(opt.autoPageLineWeight)) ? Number(opt.autoPageLineWeight) : 0\n\tif (opt.autoPageLineWeight) {\n\t\tif (opt.autoPageLineWeight > 1) opt.autoPageLineWeight = 1\n\t\telse if (opt.autoPageLineWeight < -1) opt.autoPageLineWeight = -1\n\t}\n\t// autoPage ^^^\n\n\t// Set/Calc table width\n\t// Get slide margins - start with default values, then adjust if master or slide margins exist\n\tlet arrTableMargin = DEF_SLIDE_MARGIN_IN\n\t// Case 1: Master margins\n\tif (slideLayout && typeof slideLayout._margin !== 'undefined') {\n\t\tif (Array.isArray(slideLayout._margin)) arrTableMargin = slideLayout._margin\n\t\telse if (!isNaN(Number(slideLayout._margin)))\n\t\t\tarrTableMargin = [Number(slideLayout._margin), Number(slideLayout._margin), Number(slideLayout._margin), Number(slideLayout._margin)]\n\t}\n\t// Case 2: Table margins\n\t/* FIXME: add `_margin` option to slide options\n\t\telse if ( addNewSlide._margin ) {\n\t\t\tif ( Array.isArray(addNewSlide._margin) ) arrTableMargin = addNewSlide._margin;\n\t\t\telse if ( !isNaN(Number(addNewSlide._margin)) ) arrTableMargin = [Number(addNewSlide._margin), Number(addNewSlide._margin), Number(addNewSlide._margin), Number(addNewSlide._margin)];\n\t\t}\n\t*/\n\n\t/**\n\t * Calc table width depending upon what data we have - several scenarios exist (including bad data, eg: colW doesnt match col count)\n\t * The API does not require a `w` value, but XML generation does, hence, code to calc a width below using colW value(s)\n\t */\n\tif (opt.colW) {\n\t\tlet firstRowColCnt = arrRows[0].reduce((totalLen, c) => {\n\t\t\tif (c && c.options && c.options.colspan && typeof c.options.colspan === 'number') {\n\t\t\t\ttotalLen += c.options.colspan\n\t\t\t} else {\n\t\t\t\ttotalLen += 1\n\t\t\t}\n\t\t\treturn totalLen\n\t\t}, 0)\n\n\t\t// Ex: `colW = 3` or `colW = '3'`\n\t\tif (typeof opt.colW === 'string' || typeof opt.colW === 'number') {\n\t\t\topt.w = Math.floor(Number(opt.colW) * firstRowColCnt)\n\t\t\topt.colW = null // IMPORTANT: Unset `colW` so table is created using `opt.w`, which will evenly divide cols\n\t\t}\n\t\t// Ex: `colW=[3]` but with >1 cols (same as above, user is saying \"use this width for all\")\n\t\telse if (opt.colW && Array.isArray(opt.colW) && opt.colW.length === 1 && firstRowColCnt > 1) {\n\t\t\topt.w = Math.floor(Number(opt.colW) * firstRowColCnt)\n\t\t\topt.colW = null // IMPORTANT: Unset `colW` so table is created using `opt.w`, which will evenly divide cols\n\t\t}\n\t\t// Err: Mismatched colW and cols count\n\t\telse if (opt.colW && Array.isArray(opt.colW) && opt.colW.length !== firstRowColCnt) {\n\t\t\tconsole.warn('addTable: mismatch: (colW.length != data.length) Therefore, defaulting to evenly distributed col widths.')\n\t\t\topt.colW = null\n\t\t}\n\t} else if (opt.w) {\n\t\topt.w = getSmartParseNumber(opt.w, 'X', presLayout)\n\t} else {\n\t\topt.w = Math.floor(presLayout._sizeW / EMU - arrTableMargin[1] - arrTableMargin[3])\n\t}\n\n\t// STEP 4: Convert units to EMU now (we use different logic in makeSlide->table - smartCalc is not used)\n\tif (opt.x && opt.x < 20) opt.x = inch2Emu(opt.x)\n\tif (opt.y && opt.y < 20) opt.y = inch2Emu(opt.y)\n\tif (opt.w && opt.w < 20) opt.w = inch2Emu(opt.w)\n\tif (opt.h && opt.h < 20) opt.h = inch2Emu(opt.h)\n\n\t// STEP 5: Loop over cells: transform each to ITableCell; check to see whether to skip autopaging while here\n\tarrRows.forEach(row => {\n\t\trow.forEach((cell, idy) => {\n\t\t\t// A: Transform cell data if needed\n\t\t\t/* Table rows can be an object or plain text - transform into object when needed\n\t\t\t\t// EX:\n\t\t\t\tvar arrTabRows1 = [\n\t\t\t\t\t[ { text:'A1\\nA2', options:{rowspan:2, fill:'99FFCC'} } ]\n\t\t\t\t\t,[ 'B2', 'C2', 'D2', 'E2' ]\n\t\t\t\t]\n\t\t\t*/\n\t\t\tif (typeof cell === 'number' || typeof cell === 'string') {\n\t\t\t\t// Grab table formatting `opts` to use here so text style/format inherits as it should\n\t\t\t\trow[idy] = { _type: SLIDE_OBJECT_TYPES.tablecell, text: row[idy].toString(), options: opt }\n\t\t\t} else if (typeof cell === 'object') {\n\t\t\t\t// ARG0: `text`\n\t\t\t\tif (typeof cell.text === 'number') row[idy].text = row[idy].text.toString()\n\t\t\t\telse if (typeof cell.text === 'undefined' || cell.text === null) row[idy].text = ''\n\n\t\t\t\t// ARG1: `options`: ensure options exists\n\t\t\t\trow[idy].options = cell.options || {}\n\n\t\t\t\t// Set type to tabelcell\n\t\t\t\trow[idy]._type = SLIDE_OBJECT_TYPES.tablecell\n\t\t\t}\n\n\t\t\t// B: Check for fine-grained formatting, disable auto-page when found\n\t\t\t// Since genXmlTextBody already checks for text array ( text:[{},..{}] ) we're done!\n\t\t\t// Text in individual cells will be formatted as they are added by calls to genXmlTextBody within table builder\n\t\t\tif (cell.text && Array.isArray(cell.text)) opt.autoPage = false\n\t\t})\n\t})\n\n\t// STEP 6: Auto-Paging: (via {options} and used internally)\n\t// (used internally by `tableToSlides()` to not engage recursion - we've already paged the table data, just add this one)\n\tif (opt && opt.autoPage === false) {\n\t\t// Create hyperlink rels (IMPORTANT: Wait until table has been shredded across Slides or all rels will end-up on Slide 1!)\n\t\tcreateHyperlinkRels(target, arrRows)\n\n\t\t// Add slideObjects (NOTE: Use `extend` to avoid mutation)\n\t\ttarget._slideObjects.push({\n\t\t\t_type: SLIDE_OBJECT_TYPES.table,\n\t\t\tarrTabRows: arrRows,\n\t\t\toptions: Object.assign({}, opt),\n\t\t})\n\t} else {\n\t\tif (opt.autoPageRepeatHeader) opt._arrObjTabHeadRows = arrRows.filter((_row, idx) => idx < opt.autoPageHeaderRows)\n\n\t\t// Loop over rows and create 1-N tables as needed (ISSUE#21)\n\t\tgetSlidesForTableRows(arrRows, opt, presLayout, slideLayout).forEach((slide, idx) => {\n\t\t\t// A: Create new Slide when needed, otherwise, use existing (NOTE: More than 1 table can be on a Slide, so we will go up AND down the Slide chain)\n\t\t\tif (!getSlide(target._slideNum + idx)) slides.push(addSlide(slideLayout ? slideLayout._name : null))\n\n\t\t\t// B: Reset opt.y to `option`/`margin` after first Slide (ISSUE#43, ISSUE#47, ISSUE#48)\n\t\t\tif (idx > 0) opt.y = inch2Emu(opt.autoPageSlideStartY || opt.newSlideStartY || arrTableMargin[0])\n\n\t\t\t// C: Add this table to new Slide\n\t\t\t{\n\t\t\t\tlet newSlide: PresSlide = getSlide(target._slideNum + idx)\n\n\t\t\t\topt.autoPage = false\n\n\t\t\t\t// Create hyperlink rels (IMPORTANT: Wait until table has been shredded across Slides or all rels will end-up on Slide 1!)\n\t\t\t\tcreateHyperlinkRels(newSlide, slide.rows)\n\n\t\t\t\t// Add rows to new slide\n\t\t\t\tnewSlide.addTable(slide.rows, Object.assign({}, opt))\n\t\t\t}\n\t\t})\n\t}\n}\n\n/**\n * Adds a text object to a slide definition.\n * @param {PresSlide} target - slide object that the text should be added to\n * @param {string|TextProps[]} text text string or object\n * @param {TextPropsOptions} opts text options\n * @param {boolean} isPlaceholder` is this a placeholder object\n * @since: 1.0.0\n */\nexport function addTextDefinition(target: PresSlide, text: string | TextProps[], opts: TextPropsOptions, isPlaceholder: boolean) {\n\tlet opt: TextPropsOptions = opts || {}\n\topt.line = opt.line || ({} as ShapeLineProps)\n\tif (!opt._bodyProp) opt._bodyProp = {}\n\tlet newObject = {\n\t\t_type: isPlaceholder ? SLIDE_OBJECT_TYPES.placeholder : SLIDE_OBJECT_TYPES.text,\n\t\tshape: opt.shape || SHAPE_TYPE.RECTANGLE,\n\t\ttext: (Array.isArray(text) && text.length === 0 ? '' : text || '') || '',\n\t\toptions: opt,\n\t}\n\t// TODO: copy \"newLineOpts\" from addShape above! 20200609\n\n\t// STEP 1: Set some options\n\t{\n\t\t// A.1: Placeholders should inherit their colors or override them, so don't default them\n\t\tif (!opt.placeholder) {\n\t\t\topt.color = opt.color || target.color || DEF_FONT_COLOR // Set color (options > inherit from Slide > default to black)\n\t\t}\n\n\t\t// A.2: Placeholder should inherit their bullets or override them, so don't default them\n\t\tif (opt.placeholder || isPlaceholder) {\n\t\t\topt.bullet = opt.bullet || false\n\t\t}\n\n\t\t// B\n\t\tif (opt.shape === SHAPE_TYPE.LINE) {\n\t\t\t// ShapeLineProps defaults\n\t\t\tlet newLineOpts: ShapeLineProps = {\n\t\t\t\ttype: opt.line.type || 'solid',\n\t\t\t\tcolor: opt.line.color || DEF_SHAPE_LINE_COLOR,\n\t\t\t\ttransparency: opt.line.transparency || 0,\n\t\t\t\twidth: opt.line.width || 1,\n\t\t\t\tdashType: opt.line.dashType || 'solid',\n\t\t\t\tbeginArrowType: opt.line.beginArrowType || null,\n\t\t\t\tendArrowType: opt.line.endArrowType || null,\n\t\t\t}\n\t\t\tif (typeof opt.line === 'object') opt.line = newLineOpts\n\n\t\t\t// 3: Handle line (lots of deprecated opts)\n\t\t\tif (typeof opt.line === 'string') {\n\t\t\t\tlet tmpOpts = newLineOpts\n\t\t\t\ttmpOpts.color = opt.line!.toString() // @deprecated `opt.line` string (was line color)\n\t\t\t\topt.line = tmpOpts\n\t\t\t}\n\t\t\tif (typeof opt.lineSize === 'number') opt.line.width = opt.lineSize // @deprecated (part of `ShapeLineProps` now)\n\t\t\tif (typeof opt.lineDash === 'string') opt.line.dashType = opt.lineDash // @deprecated (part of `ShapeLineProps` now)\n\t\t\tif (typeof opt.lineHead === 'string') opt.line.beginArrowType = opt.lineHead // @deprecated (part of `ShapeLineProps` now)\n\t\t\tif (typeof opt.lineTail === 'string') opt.line.endArrowType = opt.lineTail // @deprecated (part of `ShapeLineProps` now)\n\t\t}\n\n\t\t// C\n\t\tnewObject.options.lineSpacing = opt.lineSpacing && !isNaN(opt.lineSpacing) ? opt.lineSpacing : null\n\n\t\t// D: Transform text options to bodyProperties as thats how we build XML\n\t\tnewObject.options._bodyProp.autoFit = opt.autoFit || false // @deprecated (3.3.0) If true, shape will collapse to text size (Fit To shape)\n\t\tnewObject.options._bodyProp.anchor = !opt.placeholder ? TEXT_VALIGN.ctr : null // VALS: [t,ctr,b]\n\t\tnewObject.options._bodyProp.vert = opt.vert || null // VALS: [eaVert,horz,mongolianVert,vert,vert270,wordArtVert,wordArtVertRtl]\n\n\t\tif ((opt.inset && !isNaN(Number(opt.inset))) || opt.inset === 0) {\n\t\t\tnewObject.options._bodyProp.lIns = inch2Emu(opt.inset)\n\t\t\tnewObject.options._bodyProp.rIns = inch2Emu(opt.inset)\n\t\t\tnewObject.options._bodyProp.tIns = inch2Emu(opt.inset)\n\t\t\tnewObject.options._bodyProp.bIns = inch2Emu(opt.inset)\n\t\t}\n\t}\n\n\t// STEP 2: Transform `align`/`valign` to XML values, store in _bodyProp for XML gen\n\t{\n\t\tif ((newObject.options.align || '').toLowerCase().indexOf('c') === 0) newObject.options._bodyProp.align = TEXT_HALIGN.center\n\t\telse if ((newObject.options.align || '').toLowerCase().indexOf('l') === 0) newObject.options._bodyProp.align = TEXT_HALIGN.left\n\t\telse if ((newObject.options.align || '').toLowerCase().indexOf('r') === 0) newObject.options._bodyProp.align = TEXT_HALIGN.right\n\t\telse if ((newObject.options.align || '').toLowerCase().indexOf('j') === 0) newObject.options._bodyProp.align = TEXT_HALIGN.justify\n\n\t\tif ((newObject.options.valign || '').toLowerCase().indexOf('b') === 0) newObject.options._bodyProp.anchor = TEXT_VALIGN.b\n\t\telse if ((newObject.options.valign || '').toLowerCase().indexOf('m') === 0) newObject.options._bodyProp.anchor = TEXT_VALIGN.ctr\n\t\telse if ((newObject.options.valign || '').toLowerCase().indexOf('t') === 0) newObject.options._bodyProp.anchor = TEXT_VALIGN.t\n\t}\n\n\t// STEP 3: ROBUST: Set rational values for some shadow props if needed\n\tcorrectShadowOptions(opt.shadow)\n\n\t// STEP 4: Create hyperlinks\n\tif (typeof text === 'string' || typeof text === 'number') newObject.text = [{ text: text, options: newObject.options }]\n\tcreateHyperlinkRels(target, newObject.text || '')\n\n\t// LAST: Add object to Slide\n\ttarget._slideObjects.push(newObject)\n}\n\n/**\n * Adds placeholder objects to slide\n * @param {PresSlide} slide - slide object containing layouts\n */\nexport function addPlaceholdersToSlideLayouts(slide: PresSlide) {\n\t// Add all placeholders on this Slide that dont already exist\n\t;(slide._slideLayout._slideObjects || []).forEach(slideLayoutObj => {\n\t\tif (slideLayoutObj._type === SLIDE_OBJECT_TYPES.placeholder) {\n\t\t\t// A: Search for this placeholder on Slide before we add\n\t\t\t// NOTE: Check to ensure a placeholder does not already exist on the Slide\n\t\t\t// They are created when they have been populated with text (ex: `slide.addText('Hi', { placeholder:'title' });`)\n\t\t\tif (slide._slideObjects.filter(slideObj => slideObj.options && slideObj.options.placeholder === slideLayoutObj.options.placeholder).length === 0) {\n\t\t\t\taddTextDefinition(slide, '', { placeholder: slideLayoutObj.options.placeholder }, false)\n\t\t\t}\n\t\t}\n\t})\n}\n\n/* -------------------------------------------------------------------------------- */\n\n/**\n * Adds a background image or color to a slide definition.\n * @param {BackgroundProps} bkg - color string or an object with image definition\n * @param {PresSlide} target - slide object that the background is set to\n */\nexport function addBackgroundDefinition(bkg: BackgroundProps, target: SlideLayout) {\n\tif (typeof bkg === 'object' && (bkg.path || bkg.data)) {\n\t\t// Allow the use of only the data key (`path` isnt reqd)\n\t\tbkg.path = bkg.path || 'preencoded.png'\n\t\tlet strImgExtn = (bkg.path.split('.').pop() || 'png').split('?')[0] // Handle \"blah.jpg?width=540\" etc.\n\t\tif (strImgExtn === 'jpg') strImgExtn = 'jpeg' // base64-encoded jpg's come out as \"data:image/jpeg;base64,/9j/[...]\", so correct exttnesion to avoid content warnings at PPT startup\n\n\t\ttarget._relsMedia = target._relsMedia || []\n\t\tlet intRels = target._relsMedia.length + 1\n\t\t// NOTE: `Target` cannot have spaces (eg:\"Slide 1-image-1.jpg\") or a \"presentation is corrupt\" warning comes up\n\t\ttarget._relsMedia.push({\n\t\t\tpath: bkg.path,\n\t\t\ttype: SLIDE_OBJECT_TYPES.image,\n\t\t\textn: strImgExtn,\n\t\t\tdata: bkg.data || null,\n\t\t\trId: intRels,\n\t\t\tTarget: `../media/${(target._name || '').replace(/\\s+/gi, '-')}-image-${target._relsMedia.length + 1}.${strImgExtn}`,\n\t\t})\n\t\ttarget._bkgdImgRid = intRels\n\t} else if (bkg && bkg.fill && typeof bkg.fill === 'string') {\n\t\ttarget.bkgd = bkg.fill\n\t}\n}\n\n/**\n * Parses text/text-objects from `addText()` and `addTable()` methods; creates 'hyperlink'-type Slide Rels for each hyperlink found\n * @param {PresSlide} target - slide object that any hyperlinks will be be added to\n * @param {number | string | TextProps | TextProps[] | ITableCell[][]} text - text to parse\n */\nfunction createHyperlinkRels(target: PresSlide, text: number | string | ISlideObject | TextProps | TextProps[] | TableCell[][]) {\n\tlet textObjs = []\n\n\t// Only text objects can have hyperlinks, bail when text param is plain text\n\tif (typeof text === 'string' || typeof text === 'number') return\n\t// IMPORTANT: \"else if\" Array.isArray must come before typeof===object! Otherwise, code will exhaust recursion!\n\telse if (Array.isArray(text)) textObjs = text\n\telse if (typeof text === 'object') textObjs = [text]\n\n\ttextObjs.forEach((text: TextProps) => {\n\t\t// `text` can be an array of other `text` objects (table cell word-level formatting), continue parsing using recursion\n\t\tif (Array.isArray(text)) createHyperlinkRels(target, text)\n\t\telse if (text && typeof text === 'object' && text.options && text.options.hyperlink && !text.options.hyperlink._rId) {\n\t\t\tif (typeof text.options.hyperlink !== 'object') console.log(\"ERROR: text `hyperlink` option should be an object. Ex: `hyperlink: {url:'https://github.com'}` \")\n\t\t\telse if (!text.options.hyperlink.url && !text.options.hyperlink.slide) console.log(\"ERROR: 'hyperlink requires either: `url` or `slide`'\")\n\t\t\telse {\n\t\t\t\tlet relId = getNewRelId(target)\n\n\t\t\t\ttarget._rels.push({\n\t\t\t\t\ttype: SLIDE_OBJECT_TYPES.hyperlink,\n\t\t\t\t\tdata: text.options.hyperlink.slide ? 'slide' : 'dummy',\n\t\t\t\t\trId: relId,\n\t\t\t\t\tTarget: encodeXmlEntities(text.options.hyperlink.url) || text.options.hyperlink.slide.toString(),\n\t\t\t\t})\n\n\t\t\t\ttext.options.hyperlink._rId = relId\n\t\t\t}\n\t\t}\n\t})\n}\n","/**\n * PptxGenJS: Slide Class\n */\n\nimport { CHART_NAME, SHAPE_NAME } from './core-enums'\nimport {\n\tBackgroundProps,\n\tHexColor,\n\tIChartMulti,\n\tIChartOpts,\n\tIChartOptsLib,\n\tImageProps,\n\tPresLayout,\n\tSlideLayout,\n\tSlideNumberProps,\n\tISlideObject,\n\tISlideRel,\n\tISlideRelChart,\n\tISlideRelMedia,\n\tTableProps,\n\tTextProps,\n\tTextPropsOptions,\n\tMediaProps,\n\tShapeProps,\n\tTableRow,\n} from './core-interfaces'\nimport * as genObj from './gen-objects'\n\nexport default class Slide {\n\tprivate _setSlideNum: Function\n\n\tpublic addSlide: Function\n\tpublic getSlide: Function\n\tpublic _name: string\n\tpublic _presLayout: PresLayout\n\tpublic _rels: ISlideRel[]\n\tpublic _relsChart: ISlideRelChart[]\n\tpublic _relsMedia: ISlideRelMedia[]\n\tpublic _rId: number\n\tpublic _slideId: number\n\tpublic _slideLayout: SlideLayout\n\tpublic _slideNum: number\n\tpublic _slideNumberProps: SlideNumberProps\n\tpublic _slideObjects: ISlideObject[]\n\n\tconstructor(params: {\n\t\taddSlide: Function\n\t\tgetSlide: Function\n\t\tpresLayout: PresLayout\n\t\tsetSlideNum: Function\n\t\tslideId: number\n\t\tslideRId: number\n\t\tslideNumber: number\n\t\tslideLayout?: SlideLayout\n\t}) {\n\t\tthis.addSlide = params.addSlide\n\t\tthis.getSlide = params.getSlide\n\t\tthis._name = 'Slide ' + params.slideNumber\n\t\tthis._presLayout = params.presLayout\n\t\tthis._rId = params.slideRId\n\t\tthis._rels = []\n\t\tthis._relsChart = []\n\t\tthis._relsMedia = []\n\t\tthis._setSlideNum = params.setSlideNum\n\t\tthis._slideId = params.slideId\n\t\tthis._slideLayout = params.slideLayout || null\n\t\tthis._slideNum = params.slideNumber\n\t\tthis._slideObjects = []\n\t\t/** NOTE: Slide Numbers: In order for Slide Numbers to function they need to be in all 3 files: master/layout/slide\n\t\t * `defineSlideMaster` and `addNewSlide.slideNumber` will add {slideNumber} to `this.masterSlide` and `this.slideLayouts`\n\t\t * so, lastly, add to the Slide now.\n\t\t */\n\t\tthis._slideNumberProps = this._slideLayout && this._slideLayout._slideNumberProps ? this._slideLayout._slideNumberProps : null\n\t}\n\n\t/**\n\t * Background color\n\t * @type {string}\n\t * @deprecated in v3.3.0 - use `background` instead\n\t */\n\tprivate _bkgd: string\n\tpublic set bkgd(value: string) {\n\t\tthis._bkgd = value\n\t}\n\tpublic get bkgd(): string {\n\t\treturn this._bkgd\n\t}\n\n\t/**\n\t * Background color or image\n\t * @type {BackgroundProps}\n\t * @example solid color `background: {fill:'FF0000'}\n\t * @example base64 `background: {data:'image/png;base64,ABC[...]123'}`\n\t * @example url  `background: {path:'https://some.url/image.jpg'}`\n\t * @since v3.3.0\n\t */\n\tprivate _background: BackgroundProps\n\tpublic set background(value: BackgroundProps) {\n\t\tgenObj.addBackgroundDefinition(value, this)\n\t}\n\tpublic get background(): BackgroundProps {\n\t\treturn this._background\n\t}\n\n\t/**\n\t * Default font color\n\t * @type {HexColor}\n\t */\n\tprivate _color: HexColor\n\tpublic set color(value: HexColor) {\n\t\tthis._color = value\n\t}\n\tpublic get color(): HexColor {\n\t\treturn this._color\n\t}\n\n\t/**\n\t * @type {boolean}\n\t */\n\tprivate _hidden: boolean\n\tpublic set hidden(value: boolean) {\n\t\tthis._hidden = value\n\t}\n\tpublic get hidden(): boolean {\n\t\treturn this._hidden\n\t}\n\n\t/**\n\t * @type {SlideNumberProps}\n\t */\n\tpublic set slideNumber(value: SlideNumberProps) {\n\t\t// NOTE: Slide Numbers: In order for Slide Numbers to function they need to be in all 3 files: master/layout/slide\n\t\tthis._slideNumberProps = value\n\t\tthis._setSlideNum(value)\n\t}\n\tpublic get slideNumber(): SlideNumberProps {\n\t\treturn this._slideNumberProps\n\t}\n\n\t/**\n\t * Add chart to Slide\n\t * @param {CHART_NAME|IChartMulti[]} type - chart type\n\t * @param {object[]} data - data object\n\t * @param {IChartOpts} options - chart options\n\t * @return {Slide} this Slide\n\t */\n\taddChart(type: CHART_NAME | IChartMulti[], data: any[], options?: IChartOpts): Slide {\n\t\t// FUTURE: TODO-VERSION-4: Remove first arg - only take data and opts, with \"type\" required on opts\n\t\t// Set `_type` on IChartOptsLib as its what is used as object is passed around\n\t\tlet optionsWithType: IChartOptsLib = options || {}\n\t\toptionsWithType._type = type\n\t\tgenObj.addChartDefinition(this, type, data, options)\n\t\treturn this\n\t}\n\n\t/**\n\t * Add image to Slide\n\t * @param {ImageProps} options - image options\n\t * @return {Slide} this Slide\n\t */\n\taddImage(options: ImageProps): Slide {\n\t\tgenObj.addImageDefinition(this, options)\n\t\treturn this\n\t}\n\n\t/**\n\t * Add media (audio/video) to Slide\n\t * @param {MediaProps} options - media options\n\t * @return {Slide} this Slide\n\t */\n\taddMedia(options: MediaProps): Slide {\n\t\tgenObj.addMediaDefinition(this, options)\n\t\treturn this\n\t}\n\n\t/**\n\t * Add speaker notes to Slide\n\t * @docs https://gitbrent.github.io/PptxGenJS/docs/speaker-notes.html\n\t * @param {string} notes - notes to add to slide\n\t * @return {Slide} this Slide\n\t */\n\taddNotes(notes: string): Slide {\n\t\tgenObj.addNotesDefinition(this, notes)\n\t\treturn this\n\t}\n\n\t/**\n\t * Add shape to Slide\n\t * @param {SHAPE_NAME} shapeName - shape name\n\t * @param {ShapeProps} options - shape options\n\t * @return {Slide} this Slide\n\t */\n\taddShape(shapeName: SHAPE_NAME, options?: ShapeProps): Slide {\n\t\t// NOTE: As of v3.1.0, <script> users are passing the old shape object from the shapes file (orig to the project)\n\t\t// But React/TypeScript users are passing the shapeName from an enum, which is a simple string, so lets cast\n\t\t// <script./> => `pptx.shapes.RECTANGLE` [string] \"rect\" ... shapeName['name'] = 'rect'\n\t\t// TypeScript => `pptxgen.shapes.RECTANGLE` [string] \"rect\" ... shapeName = 'rect'\n\t\t//let shapeNameDecode = typeof shapeName === 'object' && shapeName['name'] ? shapeName['name'] : shapeName\n\t\tgenObj.addShapeDefinition(this, shapeName, options)\n\t\treturn this\n\t}\n\n\t/**\n\t * Add table to Slide\n\t * @param {TableRow[]} tableRows - table rows\n\t * @param {TableProps} options - table options\n\t * @return {Slide} this Slide\n\t */\n\taddTable(tableRows: TableRow[], options?: TableProps): Slide {\n\t\t// FUTURE: we pass `this` - we dont need to pass layouts - they can be read from this!\n\t\tgenObj.addTableDefinition(this, tableRows, options, this._slideLayout, this._presLayout, this.addSlide, this.getSlide)\n\t\treturn this\n\t}\n\n\t/**\n\t * Add text to Slide\n\t * @param {string|TextProps[]} text - text string or complex object\n\t * @param {TextPropsOptions} options - text options\n\t * @return {Slide} this Slide\n\t */\n\taddText(text: string | TextProps[], options?: TextPropsOptions): Slide {\n\t\tgenObj.addTextDefinition(this, text, options, false)\n\t\treturn this\n\t}\n}\n","/**\n * PptxGenJS: Chart Generation\n */\n\nimport {\n\tAXIS_ID_CATEGORY_PRIMARY,\n\tAXIS_ID_CATEGORY_SECONDARY,\n\tAXIS_ID_SERIES_PRIMARY,\n\tAXIS_ID_VALUE_PRIMARY,\n\tAXIS_ID_VALUE_SECONDARY,\n\tBARCHART_COLORS,\n\tCHART_NAME,\n\tCHART_TYPE,\n\tDEF_CHART_GRIDLINE,\n\tDEF_FONT_COLOR,\n\tDEF_FONT_SIZE,\n\tDEF_FONT_TITLE_SIZE,\n\tDEF_SHAPE_SHADOW,\n\tLETTERS,\n} from './core-enums'\nimport { IChartOptsLib, ISlideRelChart, ShadowProps, OptsChartData, IChartTitleOpts, OptsChartGridLine } from './core-interfaces'\nimport { createColorElement, genXmlColorSelection, convertRotationDegrees, encodeXmlEntities, getMix, getUuid, valToPts } from './gen-utils'\nimport * as JSZip from 'jszip'\n\n/**\n * Based on passed data, creates Excel Worksheet that is used as a data source for a chart.\n * @param {ISlideRelChart} chartObject - chart object\n * @param {JSZip} zip - file that the resulting XLSX should be added to\n * @return {Promise} promise of generating the XLSX file\n */\nexport function createExcelWorksheet(chartObject: ISlideRelChart, zip: JSZip): Promise<any> {\n\tlet data = chartObject.data\n\n\treturn new Promise((resolve, reject) => {\n\t\tlet zipExcel = new JSZip()\n\t\tlet intBubbleCols = (data.length - 1) * 2 + 1 // 1 for \"X-Values\", then 2 for every Y-Axis\n\n\t\t// A: Add folders\n\t\tzipExcel.folder('_rels')\n\t\tzipExcel.folder('docProps')\n\t\tzipExcel.folder('xl/_rels')\n\t\tzipExcel.folder('xl/tables')\n\t\tzipExcel.folder('xl/theme')\n\t\tzipExcel.folder('xl/worksheets')\n\t\tzipExcel.folder('xl/worksheets/_rels')\n\n\t\t// B: Add core contents\n\t\t{\n\t\t\tzipExcel.file(\n\t\t\t\t'[Content_Types].xml',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' +\n\t\t\t\t\t'  <Default Extension=\"xml\" ContentType=\"application/xml\"/>' +\n\t\t\t\t\t'  <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>' +\n\t\t\t\t\t//+ '  <Default Extension=\"jpeg\" ContentType=\"image/jpg\"/><Default Extension=\"png\" ContentType=\"image/png\"/>'\n\t\t\t\t\t//+ '  <Default Extension=\"bmp\" ContentType=\"image/bmp\"/><Default Extension=\"gif\" ContentType=\"image/gif\"/><Default Extension=\"tif\" ContentType=\"image/tif\"/><Default Extension=\"pdf\" ContentType=\"application/pdf\"/><Default Extension=\"mov\" ContentType=\"application/movie\"/><Default Extension=\"vml\" ContentType=\"application/vnd.openxmlformats-officedocument.vmlDrawing\"/>'\n\t\t\t\t\t//+ '  <Default Extension=\"xlsx\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"/>'\n\t\t\t\t\t'  <Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\"/>' +\n\t\t\t\t\t'  <Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\"/>' +\n\t\t\t\t\t'  <Override PartName=\"/xl/theme/theme1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.theme+xml\"/>' +\n\t\t\t\t\t'  <Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\"/>' +\n\t\t\t\t\t'  <Override PartName=\"/xl/sharedStrings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\"/>' +\n\t\t\t\t\t'  <Override PartName=\"/xl/tables/table1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml\"/>' +\n\t\t\t\t\t'  <Override PartName=\"/docProps/core.xml\" ContentType=\"application/vnd.openxmlformats-package.core-properties+xml\"/>' +\n\t\t\t\t\t'  <Override PartName=\"/docProps/app.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.extended-properties+xml\"/>' +\n\t\t\t\t\t'</Types>\\n'\n\t\t\t)\n\t\t\tzipExcel.file(\n\t\t\t\t'_rels/.rels',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\n\t\t\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\" Target=\"docProps/core.xml\"/>' +\n\t\t\t\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties\" Target=\"docProps/app.xml\"/>' +\n\t\t\t\t\t'<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>' +\n\t\t\t\t\t'</Relationships>\\n'\n\t\t\t)\n\t\t\tzipExcel.file(\n\t\t\t\t'docProps/app.xml',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><Properties xmlns=\"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties\" xmlns:vt=\"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes\">' +\n\t\t\t\t\t'<Application>Microsoft Excel</Application>' +\n\t\t\t\t\t'<DocSecurity>0</DocSecurity>' +\n\t\t\t\t\t'<ScaleCrop>false</ScaleCrop>' +\n\t\t\t\t\t'<HeadingPairs><vt:vector size=\"2\" baseType=\"variant\"><vt:variant><vt:lpstr>Worksheets</vt:lpstr></vt:variant><vt:variant><vt:i4>1</vt:i4></vt:variant></vt:vector></HeadingPairs><TitlesOfParts><vt:vector size=\"1\" baseType=\"lpstr\"><vt:lpstr>Sheet1</vt:lpstr></vt:vector></TitlesOfParts>' +\n\t\t\t\t\t'</Properties>\\n'\n\t\t\t)\n\t\t\tzipExcel.file(\n\t\t\t\t'docProps/core.xml',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?><cp:coreProperties xmlns:cp=\"http://schemas.openxmlformats.org/package/2006/metadata/core-properties\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:dcterms=\"http://purl.org/dc/terms/\" xmlns:dcmitype=\"http://purl.org/dc/dcmitype/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">' +\n\t\t\t\t\t'<dc:creator>PptxGenJS</dc:creator>' +\n\t\t\t\t\t'<cp:lastModifiedBy>Ely, Brent</cp:lastModifiedBy>' +\n\t\t\t\t\t'<dcterms:created xsi:type=\"dcterms:W3CDTF\">' +\n\t\t\t\t\tnew Date().toISOString() +\n\t\t\t\t\t'</dcterms:created>' +\n\t\t\t\t\t'<dcterms:modified xsi:type=\"dcterms:W3CDTF\">' +\n\t\t\t\t\tnew Date().toISOString() +\n\t\t\t\t\t'</dcterms:modified>' +\n\t\t\t\t\t'</cp:coreProperties>\\n'\n\t\t\t)\n\t\t\tzipExcel.file(\n\t\t\t\t'xl/_rels/workbook.xml.rels',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\n\t\t\t\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\n\t\t\t\t\t'<Relationship Id=\"rId3\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' +\n\t\t\t\t\t'<Relationship Id=\"rId4\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings\" Target=\"sharedStrings.xml\"/>' +\n\t\t\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>' +\n\t\t\t\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme\" Target=\"theme/theme1.xml\"/>' +\n\t\t\t\t\t'</Relationships>\\n'\n\t\t\t)\n\t\t\tzipExcel.file(\n\t\t\t\t'xl/styles.xml',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\"><numFmts count=\"1\"><numFmt numFmtId=\"0\" formatCode=\"General\"/></numFmts><fonts count=\"4\"><font><sz val=\"9\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"9\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"10\"/><color indexed=\"8\"/><name val=\"Geneva\"/></font><font><sz val=\"18\"/><color indexed=\"8\"/>' +\n\t\t\t\t\t'<name val=\"Arial\"/></font></fonts><fills count=\"2\"><fill><patternFill patternType=\"none\"/></fill><fill><patternFill patternType=\"gray125\"/></fill></fills><borders count=\"1\"><border><left/><right/><top/><bottom/><diagonal/></border></borders><dxfs count=\"0\"/><tableStyles count=\"0\"/><colors><indexedColors><rgbColor rgb=\"ff000000\"/><rgbColor rgb=\"ffffffff\"/><rgbColor rgb=\"ffff0000\"/><rgbColor rgb=\"ff00ff00\"/><rgbColor rgb=\"ff0000ff\"/>' +\n\t\t\t\t\t'<rgbColor rgb=\"ffffff00\"/><rgbColor rgb=\"ffff00ff\"/><rgbColor rgb=\"ff00ffff\"/><rgbColor rgb=\"ff000000\"/><rgbColor rgb=\"ffffffff\"/><rgbColor rgb=\"ff878787\"/><rgbColor rgb=\"fff9f9f9\"/></indexedColors></colors></styleSheet>\\n'\n\t\t\t)\n\t\t\tzipExcel.file(\n\t\t\t\t'xl/theme/theme1.xml',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><a:theme xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" name=\"Office Theme\"><a:themeElements><a:clrScheme name=\"Office\"><a:dk1><a:sysClr val=\"windowText\" lastClr=\"000000\"/></a:dk1><a:lt1><a:sysClr val=\"window\" lastClr=\"FFFFFF\"/></a:lt1><a:dk2><a:srgbClr val=\"44546A\"/></a:dk2><a:lt2><a:srgbClr val=\"E7E6E6\"/></a:lt2><a:accent1><a:srgbClr val=\"4472C4\"/></a:accent1><a:accent2><a:srgbClr val=\"ED7D31\"/></a:accent2><a:accent3><a:srgbClr val=\"A5A5A5\"/></a:accent3><a:accent4><a:srgbClr val=\"FFC000\"/></a:accent4><a:accent5><a:srgbClr val=\"5B9BD5\"/></a:accent5><a:accent6><a:srgbClr val=\"70AD47\"/></a:accent6><a:hlink><a:srgbClr val=\"0563C1\"/></a:hlink><a:folHlink><a:srgbClr val=\"954F72\"/></a:folHlink></a:clrScheme><a:fontScheme name=\"Office\"><a:majorFont><a:latin typeface=\"Calibri Light\" panose=\"020F0302020204030204\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"Yu Gothic Light\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"DengXian Light\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Times New Roman\"/><a:font script=\"Hebr\" typeface=\"Times New Roman\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"MoolBoran\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Times New Roman\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:majorFont><a:minorFont><a:latin typeface=\"Calibri\" panose=\"020F0502020204030204\"/><a:ea typeface=\"\"/><a:cs typeface=\"\"/><a:font script=\"Jpan\" typeface=\"Yu Gothic\"/><a:font script=\"Hang\" typeface=\"맑은 고딕\"/><a:font script=\"Hans\" typeface=\"DengXian\"/><a:font script=\"Hant\" typeface=\"新細明體\"/><a:font script=\"Arab\" typeface=\"Arial\"/><a:font script=\"Hebr\" typeface=\"Arial\"/><a:font script=\"Thai\" typeface=\"Tahoma\"/><a:font script=\"Ethi\" typeface=\"Nyala\"/><a:font script=\"Beng\" typeface=\"Vrinda\"/><a:font script=\"Gujr\" typeface=\"Shruti\"/><a:font script=\"Khmr\" typeface=\"DaunPenh\"/><a:font script=\"Knda\" typeface=\"Tunga\"/><a:font script=\"Guru\" typeface=\"Raavi\"/><a:font script=\"Cans\" typeface=\"Euphemia\"/><a:font script=\"Cher\" typeface=\"Plantagenet Cherokee\"/><a:font script=\"Yiii\" typeface=\"Microsoft Yi Baiti\"/><a:font script=\"Tibt\" typeface=\"Microsoft Himalaya\"/><a:font script=\"Thaa\" typeface=\"MV Boli\"/><a:font script=\"Deva\" typeface=\"Mangal\"/><a:font script=\"Telu\" typeface=\"Gautami\"/><a:font script=\"Taml\" typeface=\"Latha\"/><a:font script=\"Syrc\" typeface=\"Estrangelo Edessa\"/><a:font script=\"Orya\" typeface=\"Kalinga\"/><a:font script=\"Mlym\" typeface=\"Kartika\"/><a:font script=\"Laoo\" typeface=\"DokChampa\"/><a:font script=\"Sinh\" typeface=\"Iskoola Pota\"/><a:font script=\"Mong\" typeface=\"Mongolian Baiti\"/><a:font script=\"Viet\" typeface=\"Arial\"/><a:font script=\"Uigh\" typeface=\"Microsoft Uighur\"/><a:font script=\"Geor\" typeface=\"Sylfaen\"/></a:minorFont></a:fontScheme><a:fmtScheme name=\"Office\"><a:fillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"110000\"/><a:satMod val=\"105000\"/><a:tint val=\"67000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"105000\"/><a:satMod val=\"103000\"/><a:tint val=\"73000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"105000\"/><a:satMod val=\"109000\"/><a:tint val=\"81000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:satMod val=\"103000\"/><a:lumMod val=\"102000\"/><a:tint val=\"94000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:satMod val=\"110000\"/><a:lumMod val=\"100000\"/><a:shade val=\"100000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:lumMod val=\"99000\"/><a:satMod val=\"120000\"/><a:shade val=\"78000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w=\"6350\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln><a:ln w=\"12700\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln><a:ln w=\"19050\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:prstDash val=\"solid\"/><a:miter lim=\"800000\"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst/></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad=\"57150\" dist=\"19050\" dir=\"5400000\" algn=\"ctr\" rotWithShape=\"0\"><a:srgbClr val=\"000000\"><a:alpha val=\"63000\"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val=\"phClr\"/></a:solidFill><a:solidFill><a:schemeClr val=\"phClr\"><a:tint val=\"95000\"/><a:satMod val=\"170000\"/></a:schemeClr></a:solidFill><a:gradFill rotWithShape=\"1\"><a:gsLst><a:gs pos=\"0\"><a:schemeClr val=\"phClr\"><a:tint val=\"93000\"/><a:satMod val=\"150000\"/><a:shade val=\"98000\"/><a:lumMod val=\"102000\"/></a:schemeClr></a:gs><a:gs pos=\"50000\"><a:schemeClr val=\"phClr\"><a:tint val=\"98000\"/><a:satMod val=\"130000\"/><a:shade val=\"90000\"/><a:lumMod val=\"103000\"/></a:schemeClr></a:gs><a:gs pos=\"100000\"><a:schemeClr val=\"phClr\"><a:shade val=\"63000\"/><a:satMod val=\"120000\"/></a:schemeClr></a:gs></a:gsLst><a:lin ang=\"5400000\" scaled=\"0\"/></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/><a:extLst><a:ext uri=\"{05A4C25C-085E-4340-85A3-A5531E510DB2}\"><thm15:themeFamily xmlns:thm15=\"http://schemas.microsoft.com/office/thememl/2012/main\" name=\"Office Theme\" id=\"{62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F}\" vid=\"{4A3C46E8-61CC-4603-A589-7422A47A8E4A}\"/></a:ext></a:extLst></a:theme>'\n\t\t\t)\n\t\t\tzipExcel.file(\n\t\t\t\t'xl/workbook.xml',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +\n\t\t\t\t\t'<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x15\" xmlns:x15=\"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main\">' +\n\t\t\t\t\t'<fileVersion appName=\"xl\" lastEdited=\"6\" lowestEdited=\"6\" rupBuild=\"14420\"/>' +\n\t\t\t\t\t'<workbookPr />' +\n\t\t\t\t\t'<bookViews><workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"15960\" windowHeight=\"18080\"/></bookViews>' +\n\t\t\t\t\t'<sheets><sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\" /></sheets>' +\n\t\t\t\t\t'<calcPr calcId=\"171026\" concurrentCalc=\"0\"/>' +\n\t\t\t\t\t'</workbook>\\n'\n\t\t\t)\n\t\t\tzipExcel.file(\n\t\t\t\t'xl/worksheets/_rels/sheet1.xml.rels',\n\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\n\t\t\t\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\n\t\t\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table\" Target=\"../tables/table1.xml\"/>' +\n\t\t\t\t\t'</Relationships>\\n'\n\t\t\t)\n\t\t}\n\n\t\t// sharedStrings.xml\n\t\t{\n\t\t\t// A: Start XML\n\t\t\tlet strSharedStrings = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'\n\t\t\tif (chartObject.opts._type === CHART_TYPE.BUBBLE) {\n\t\t\t\tstrSharedStrings +=\n\t\t\t\t\t'<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' + (intBubbleCols + 1) + '\" uniqueCount=\"' + (intBubbleCols + 1) + '\">'\n\t\t\t} else if (chartObject.opts._type === CHART_TYPE.SCATTER) {\n\t\t\t\tstrSharedStrings +=\n\t\t\t\t\t'<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' + (data.length + 1) + '\" uniqueCount=\"' + (data.length + 1) + '\">'\n\t\t\t} else {\n\t\t\t\tstrSharedStrings +=\n\t\t\t\t\t'<sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"' +\n\t\t\t\t\t(data[0].labels.length + data.length + 1) +\n\t\t\t\t\t'\" uniqueCount=\"' +\n\t\t\t\t\t(data[0].labels.length + data.length + 1) +\n\t\t\t\t\t'\">'\n\t\t\t\t// B: Add 'blank' for A1\n\t\t\t\tstrSharedStrings += '<si><t xml:space=\"preserve\"></t></si>'\n\t\t\t}\n\n\t\t\t// C: Add `name`/Series\n\t\t\tif (chartObject.opts._type === CHART_TYPE.BUBBLE) {\n\t\t\t\tdata.forEach((objData, idx) => {\n\t\t\t\t\tif (idx === 0) strSharedStrings += '<si><t>X-Axis</t></si>'\n\t\t\t\t\telse {\n\t\t\t\t\t\tstrSharedStrings += '<si><t>' + encodeXmlEntities(objData.name || ' ') + '</t></si>'\n\t\t\t\t\t\tstrSharedStrings += '<si><t>' + encodeXmlEntities('Size ' + idx) + '</t></si>'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tdata.forEach(objData => {\n\t\t\t\t\tstrSharedStrings += '<si><t>' + encodeXmlEntities((objData.name || ' ').replace('X-Axis', 'X-Values')) + '</t></si>'\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t// D: Add `labels`/Categories\n\t\t\tif (chartObject.opts._type !== CHART_TYPE.BUBBLE && chartObject.opts._type !== CHART_TYPE.SCATTER) {\n\t\t\t\tdata[0].labels.forEach(label => {\n\t\t\t\t\tstrSharedStrings += '<si><t>' + encodeXmlEntities(label) + '</t></si>'\n\t\t\t\t})\n\t\t\t}\n\n\t\t\tstrSharedStrings += '</sst>\\n'\n\t\t\tzipExcel.file('xl/sharedStrings.xml', strSharedStrings)\n\t\t}\n\n\t\t// tables/table1.xml\n\t\t{\n\t\t\tlet strTableXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'\n\t\t\tif (chartObject.opts._type === CHART_TYPE.BUBBLE) {\n\t\t\t\t/*\n\t\t\t\tstrTableXml += '<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Table1\" displayName=\"Table1\" ref=\"A1:'+ LETTERS[data.length-1] + (data[0].values.length+1) +'\" totalsRowShown=\"0\">';\n\t\t\t\tstrTableXml += '<tableColumns count=\"' + (data.length) +'\">';\n\t\t\t\tdata.forEach(function(obj,idx){ strTableXml += '<tableColumn id=\"'+ (idx+1) +'\" name=\"'+ (idx==0 ? 'X-Values' : 'Y-Value '+idx) +'\" />' });\n\t\t\t\t*/\n\t\t\t} else if (chartObject.opts._type === CHART_TYPE.SCATTER) {\n\t\t\t\tstrTableXml +=\n\t\t\t\t\t'<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Table1\" displayName=\"Table1\" ref=\"A1:' +\n\t\t\t\t\tLETTERS[data.length - 1] +\n\t\t\t\t\t(data[0].values.length + 1) +\n\t\t\t\t\t'\" totalsRowShown=\"0\">'\n\t\t\t\tstrTableXml += '<tableColumns count=\"' + data.length + '\">'\n\t\t\t\tdata.forEach((_obj, idx) => {\n\t\t\t\t\tstrTableXml += '<tableColumn id=\"' + (idx + 1) + '\" name=\"' + (idx === 0 ? 'X-Values' : 'Y-Value ' + idx) + '\" />'\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tstrTableXml +=\n\t\t\t\t\t'<table xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" id=\"1\" name=\"Table1\" displayName=\"Table1\" ref=\"A1:' +\n\t\t\t\t\tLETTERS[data.length] +\n\t\t\t\t\t(data[0].labels.length + 1) +\n\t\t\t\t\t'\" totalsRowShown=\"0\">'\n\t\t\t\tstrTableXml += '<tableColumns count=\"' + (data.length + 1) + '\">'\n\t\t\t\tstrTableXml += '<tableColumn id=\"1\" name=\" \" />'\n\t\t\t\tdata.forEach((obj, idx) => {\n\t\t\t\t\tstrTableXml += '<tableColumn id=\"' + (idx + 2) + '\" name=\"' + encodeXmlEntities(obj.name) + '\" />'\n\t\t\t\t})\n\t\t\t}\n\t\t\tstrTableXml += '</tableColumns>'\n\t\t\tstrTableXml += '<tableStyleInfo showFirstColumn=\"0\" showLastColumn=\"0\" showRowStripes=\"1\" showColumnStripes=\"0\" />'\n\t\t\tstrTableXml += '</table>'\n\t\t\tzipExcel.file('xl/tables/table1.xml', strTableXml)\n\t\t}\n\n\t\t// worksheets/sheet1.xml\n\t\t{\n\t\t\tlet strSheetXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'\n\t\t\tstrSheetXml +=\n\t\t\t\t'<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'\n\t\t\tif (chartObject.opts._type === CHART_TYPE.BUBBLE) {\n\t\t\t\tstrSheetXml += '<dimension ref=\"A1:' + LETTERS[intBubbleCols - 1] + (data[0].values.length + 1) + '\" />'\n\t\t\t} else if (chartObject.opts._type === CHART_TYPE.SCATTER) {\n\t\t\t\tstrSheetXml += '<dimension ref=\"A1:' + LETTERS[data.length - 1] + (data[0].values.length + 1) + '\" />'\n\t\t\t} else {\n\t\t\t\tstrSheetXml += '<dimension ref=\"A1:' + LETTERS[data.length] + (data[0].labels.length + 1) + '\" />'\n\t\t\t}\n\n\t\t\tstrSheetXml += '<sheetViews><sheetView tabSelected=\"1\" workbookViewId=\"0\"><selection activeCell=\"B1\" sqref=\"B1\" /></sheetView></sheetViews>'\n\t\t\tstrSheetXml += '<sheetFormatPr baseColWidth=\"10\" defaultColWidth=\"11.5\" defaultRowHeight=\"12\" />'\n\t\t\tif (chartObject.opts._type === CHART_TYPE.BUBBLE) {\n\t\t\t\tstrSheetXml += '<cols>'\n\t\t\t\tstrSheetXml += '<col min=\"1\" max=\"' + data.length + '\" width=\"11\" customWidth=\"1\" />'\n\t\t\t\tstrSheetXml += '</cols>'\n\t\t\t\t/* EX: INPUT: `data`\n\t\t\t\t[\n\t\t\t\t\t{ name:'X-Axis'  , values:[10,11,12,13,14,15,16,17,18,19,20] },\n\t\t\t\t\t{ name:'Y-Axis 1', values:[ 1, 6, 7, 8, 9], sizes:[ 4, 5, 6, 7, 8] },\n\t\t\t\t\t{ name:'Y-Axis 2', values:[33,32,42,53,63], sizes:[11,12,13,14,15] }\n\t\t\t\t];\n\t\t\t\t*/\n\t\t\t\t/* EX: OUTPUT: bubbleChart Worksheet:\n\t\t\t\t\t-|----A-----|------B-----|------C-----|------D-----|------E-----|\n\t\t\t\t\t1| X-Values | Y-Values 1 | Y-Sizes 1  | Y-Values 2 | Y-Sizes 2  |\n\t\t\t\t\t2|    11    |     22     |      4     |     33     |      8     |\n\t\t\t\t\t-|----------|------------|------------|------------|------------|\n\t\t\t\t*/\n\t\t\t\tstrSheetXml += '<sheetData>'\n\n\t\t\t\t// A: Create header row first (NOTE: Start at index=1 as headers cols start with 'B')\n\t\t\t\tstrSheetXml += '<row r=\"1\" spans=\"1:' + intBubbleCols + '\">'\n\t\t\t\tstrSheetXml += '<c r=\"A1\" t=\"s\"><v>0</v></c>'\n\t\t\t\tfor (let idxBc = 1; idxBc < intBubbleCols; idxBc++) {\n\t\t\t\t\tstrSheetXml += '<c r=\"' + (idxBc < 26 ? LETTERS[idxBc] : 'A' + LETTERS[idxBc % LETTERS.length]) + '1\" t=\"s\">' // NOTE: use `t=\"s\"` for label cols!\n\t\t\t\t\tstrSheetXml += '<v>' + idxBc + '</v>'\n\t\t\t\t\tstrSheetXml += '</c>'\n\t\t\t\t}\n\t\t\t\tstrSheetXml += '</row>'\n\n\t\t\t\t// B: Add row for each X-Axis value (Y-Axis* value is optional)\n\t\t\t\tdata[0].values.forEach((val, idx) => {\n\t\t\t\t\t// Leading col is reserved for the 'X-Axis' value, so hard-code it, then loop over col values\n\t\t\t\t\tstrSheetXml += '<row r=\"' + (idx + 2) + '\" spans=\"1:' + intBubbleCols + '\">'\n\t\t\t\t\tstrSheetXml += '<c r=\"A' + (idx + 2) + '\"><v>' + val + '</v></c>'\n\t\t\t\t\t// Add Y-Axis 1->N (idy=0 = Xaxis)\n\t\t\t\t\tlet idxColLtr = 1\n\t\t\t\t\tfor (let idy = 1; idy < data.length; idy++) {\n\t\t\t\t\t\t// y-value\n\t\t\t\t\t\tstrSheetXml += '<c r=\"' + (idxColLtr < 26 ? LETTERS[idxColLtr] : 'A' + LETTERS[idxColLtr % LETTERS.length]) + '' + (idx + 2) + '\">'\n\t\t\t\t\t\tstrSheetXml += '<v>' + (data[idy].values[idx] || '') + '</v>'\n\t\t\t\t\t\tstrSheetXml += '</c>'\n\t\t\t\t\t\tidxColLtr++\n\t\t\t\t\t\t// y-size\n\t\t\t\t\t\tstrSheetXml += '<c r=\"' + (idxColLtr < 26 ? LETTERS[idxColLtr] : 'A' + LETTERS[idxColLtr % LETTERS.length]) + '' + (idx + 2) + '\">'\n\t\t\t\t\t\tstrSheetXml += '<v>' + (data[idy].sizes[idx] || '') + '</v>'\n\t\t\t\t\t\tstrSheetXml += '</c>'\n\t\t\t\t\t\tidxColLtr++\n\t\t\t\t\t}\n\t\t\t\t\tstrSheetXml += '</row>'\n\t\t\t\t})\n\t\t\t} else if (chartObject.opts._type === CHART_TYPE.SCATTER) {\n\t\t\t\tstrSheetXml += '<cols>'\n\t\t\t\tstrSheetXml += '<col min=\"1\" max=\"' + data.length + '\" width=\"11\" customWidth=\"1\" />'\n\t\t\t\t//data.forEach((obj,idx)=>{ strSheetXml += '<col min=\"'+(idx+1)+'\" max=\"'+(idx+1)+'\" width=\"11\" customWidth=\"1\" />' });\n\t\t\t\tstrSheetXml += '</cols>'\n\t\t\t\t/* EX: INPUT: `data`\n\t\t\t\t[\n\t\t\t\t\t{ name:'X-Axis'  , values:[10,11,12,13,14,15,16,17,18,19,20] },\n\t\t\t\t\t{ name:'Y-Axis 1', values:[ 1, 6, 7, 8, 9] },\n\t\t\t\t\t{ name:'Y-Axis 2', values:[33,32,42,53,63] }\n\t\t\t\t];\n\t\t\t\t*/\n\t\t\t\t/* EX: OUTPUT: scatterChart Worksheet:\n\t\t\t\t\t-|----A-----|------B-----|\n\t\t\t\t\t1| X-Values | Y-Values 1 |\n\t\t\t\t\t2|    11    |     22     |\n\t\t\t\t\t-|----------|------------|\n\t\t\t\t*/\n\t\t\t\tstrSheetXml += '<sheetData>'\n\n\t\t\t\t// A: Create header row first (NOTE: Start at index=1 as headers cols start with 'B')\n\t\t\t\tstrSheetXml += '<row r=\"1\" spans=\"1:' + data.length + '\">'\n\t\t\t\tstrSheetXml += '<c r=\"A1\" t=\"s\"><v>0</v></c>'\n\t\t\t\tfor (let idxSd = 1; idxSd < data.length; idxSd++) {\n\t\t\t\t\tstrSheetXml += '<c r=\"' + (idxSd < 26 ? LETTERS[idxSd] : 'A' + LETTERS[idxSd % LETTERS.length]) + '1\" t=\"s\">' // NOTE: use `t=\"s\"` for label cols!\n\t\t\t\t\tstrSheetXml += '<v>' + idxSd + '</v>'\n\t\t\t\t\tstrSheetXml += '</c>'\n\t\t\t\t}\n\t\t\t\tstrSheetXml += '</row>'\n\n\t\t\t\t// B: Add row for each X-Axis value (Y-Axis* value is optional)\n\t\t\t\tdata[0].values.forEach((val, idx) => {\n\t\t\t\t\t// Leading col is reserved for the 'X-Axis' value, so hard-code it, then loop over col values\n\t\t\t\t\tstrSheetXml += '<row r=\"' + (idx + 2) + '\" spans=\"1:' + data.length + '\">'\n\t\t\t\t\tstrSheetXml += '<c r=\"A' + (idx + 2) + '\"><v>' + val + '</v></c>'\n\t\t\t\t\t// Add Y-Axis 1->N\n\t\t\t\t\tfor (let idy = 1; idy < data.length; idy++) {\n\t\t\t\t\t\tstrSheetXml += '<c r=\"' + (idy < 26 ? LETTERS[idy] : 'A' + LETTERS[idy % LETTERS.length]) + '' + (idx + 2) + '\">'\n\t\t\t\t\t\tstrSheetXml += '<v>' + (data[idy].values[idx] || data[idy].values[idx] === 0 ? data[idy].values[idx] : '') + '</v>'\n\t\t\t\t\t\tstrSheetXml += '</c>'\n\t\t\t\t\t}\n\t\t\t\t\tstrSheetXml += '</row>'\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tstrSheetXml += '<cols>'\n\t\t\t\tstrSheetXml += '<col min=\"1\" max=\"1\" width=\"11\" customWidth=\"1\" />'\n\t\t\t\t//data.forEach(function(){ strSheetXml += '<col min=\"10\" max=\"100\" width=\"10\" customWidth=\"1\" />' });\n\t\t\t\tstrSheetXml += '</cols>'\n\t\t\t\tstrSheetXml += '<sheetData>'\n\n\t\t\t\t/* EX: INPUT: `data`\n\t\t\t\t[\n\t\t\t\t\t{ name:'Red', labels:['Jan..May-17'], values:[11,13,14,15,16] },\n\t\t\t\t\t{ name:'Amb', labels:['Jan..May-17'], values:[22, 6, 7, 8, 9] },\n\t\t\t\t\t{ name:'Grn', labels:['Jan..May-17'], values:[33,32,42,53,63] }\n\t\t\t\t];\n\t\t\t\t*/\n\t\t\t\t/* EX: OUTPUT: lineChart Worksheet:\n\t\t\t\t\t-|---A---|--B--|--C--|--D--|\n\t\t\t\t\t1|       | Red | Amb | Grn |\n\t\t\t\t\t2|Jan-17 |   11|   22|   33|\n\t\t\t\t\t3|Feb-17 |   55|   43|   70|\n\t\t\t\t\t4|Mar-17 |   56|  143|   99|\n\t\t\t\t\t5|Apr-17 |   65|    3|  120|\n\t\t\t\t\t6|May-17 |   75|   93|  170|\n\t\t\t\t\t-|-------|-----|-----|-----|\n\t\t\t\t*/\n\n\t\t\t\t// A: Create header row first (NOTE: Start at index=1 as headers cols start with 'B')\n\t\t\t\tstrSheetXml += '<row r=\"1\" spans=\"1:' + (data.length + 1) + '\">'\n\t\t\t\tstrSheetXml += '<c r=\"A1\" t=\"s\"><v>0</v></c>'\n\t\t\t\tfor (let idx = 1; idx <= data.length; idx++) {\n\t\t\t\t\t// FIXME: Max cols is 52\n\t\t\t\t\tstrSheetXml += '<c r=\"' + (idx < 26 ? LETTERS[idx] : 'A' + LETTERS[idx % LETTERS.length]) + '1\" t=\"s\">' // NOTE: use `t=\"s\"` for label cols!\n\t\t\t\t\tstrSheetXml += '<v>' + idx + '</v>'\n\t\t\t\t\tstrSheetXml += '</c>'\n\t\t\t\t}\n\t\t\t\tstrSheetXml += '</row>'\n\n\t\t\t\t// B: Add data row(s) for each category\n\t\t\t\tdata[0].labels.forEach((_cat, idx) => {\n\t\t\t\t\t// Leading col is reserved for the label, so hard-code it, then loop over col values\n\t\t\t\t\tstrSheetXml += '<row r=\"' + (idx + 2) + '\" spans=\"1:' + (data.length + 1) + '\">'\n\t\t\t\t\tstrSheetXml += '<c r=\"A' + (idx + 2) + '\" t=\"s\">'\n\t\t\t\t\tstrSheetXml += '<v>' + (data.length + idx + 1) + '</v>'\n\t\t\t\t\tstrSheetXml += '</c>'\n\t\t\t\t\tfor (let idy = 0; idy < data.length; idy++) {\n\t\t\t\t\t\tstrSheetXml += '<c r=\"' + (idy + 1 < 26 ? LETTERS[idy + 1] : 'A' + LETTERS[(idy + 1) % LETTERS.length]) + '' + (idx + 2) + '\">'\n\t\t\t\t\t\tstrSheetXml += '<v>' + (data[idy].values[idx] || '') + '</v>'\n\t\t\t\t\t\tstrSheetXml += '</c>'\n\t\t\t\t\t}\n\t\t\t\t\tstrSheetXml += '</row>'\n\t\t\t\t})\n\t\t\t}\n\t\t\tstrSheetXml += '</sheetData>'\n\t\t\tstrSheetXml += '<pageMargins left=\"0.7\" right=\"0.7\" top=\"0.75\" bottom=\"0.75\" header=\"0.3\" footer=\"0.3\" />'\n\t\t\t// Link the `table1.xml` file to define an actual Table in Excel\n\t\t\t// NOTE: This only works with scatter charts - all others give a \"cannot find linked file\" error\n\t\t\t// ....: Since we dont need the table anyway (chart data can be edited/range selected, etc.), just dont use this\n\t\t\t// ....: Leaving this so nobody foolishly attempts to add this in the future\n\t\t\t// strSheetXml += '<tableParts count=\"1\"><tablePart r:id=\"rId1\" /></tableParts>';\n\t\t\tstrSheetXml += '</worksheet>\\n'\n\t\t\tzipExcel.file('xl/worksheets/sheet1.xml', strSheetXml)\n\t\t}\n\n\t\t// C: Add XLSX to PPTX export\n\t\tzipExcel\n\t\t\t.generateAsync({ type: 'base64' })\n\t\t\t.then(content => {\n\t\t\t\t// 1: Create the embedded Excel worksheet with labels and data\n\t\t\t\tzip.file('ppt/embeddings/Microsoft_Excel_Worksheet' + chartObject.globalId + '.xlsx', content, { base64: true })\n\n\t\t\t\t// 2: Create the chart.xml and rel files\n\t\t\t\tzip.file(\n\t\t\t\t\t'ppt/charts/_rels/' + chartObject.fileName + '.rels',\n\t\t\t\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' +\n\t\t\t\t\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' +\n\t\t\t\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/package\" Target=\"../embeddings/Microsoft_Excel_Worksheet' +\n\t\t\t\t\t\tchartObject.globalId +\n\t\t\t\t\t\t'.xlsx\"/>' +\n\t\t\t\t\t\t'</Relationships>'\n\t\t\t\t)\n\t\t\t\tzip.file('ppt/charts/' + chartObject.fileName, makeXmlCharts(chartObject))\n\n\t\t\t\t// 3: Done\n\t\t\t\tresolve()\n\t\t\t})\n\t\t\t.catch(strErr => {\n\t\t\t\treject(strErr)\n\t\t\t})\n\t})\n}\n\n/**\n * Main entry point method for create charts\n * @see: http://www.datypic.com/sc/ooxml/s-dml-chart.xsd.html\n * @param {ISlideRelChart} rel - chart object\n * @return {string} XML\n */\nexport function makeXmlCharts(rel: ISlideRelChart): string {\n\tlet strXml = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'\n\tlet usesSecondaryValAxis = false\n\n\t// STEP 1: Create chart\n\t{\n\t\t// CHARTSPACE: BEGIN vvv\n\t\tstrXml +=\n\t\t\t'<c:chartSpace xmlns:c=\"http://schemas.openxmlformats.org/drawingml/2006/chart\" xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">'\n\t\tstrXml += '<c:date1904 val=\"0\"/>' // ppt defaults to 1904 dates, excel to 1900\n\t\tstrXml += '<c:chart>'\n\n\t\t// OPTION: Title\n\t\tif (rel.opts.showTitle) {\n\t\t\tstrXml += genXmlTitle({\n\t\t\t\ttitle: rel.opts.title || 'Chart Title',\n\t\t\t\tfontSize: rel.opts.titleFontSize || DEF_FONT_TITLE_SIZE,\n\t\t\t\tcolor: rel.opts.titleColor,\n\t\t\t\tfontFace: rel.opts.titleFontFace,\n\t\t\t\trotate: rel.opts.titleRotate,\n\t\t\t\ttitleAlign: rel.opts.titleAlign,\n\t\t\t\ttitlePos: rel.opts.titlePos,\n\t\t\t})\n\t\t\tstrXml += '<c:autoTitleDeleted val=\"0\"/>'\n\t\t} else {\n\t\t\t// NOTE: Add autoTitleDeleted tag in else to prevent default creation of chart title even when showTitle is set to false\n\t\t\tstrXml += '<c:autoTitleDeleted val=\"1\"/>'\n\t\t}\n\t\t/** Add 3D view tag\n\t\t * @see: https://c-rex.net/projects/samples/ooxml/e1/Part4/OOXML_P4_DOCX_perspective_topic_ID0E6BUQB.html\n\t\t */\n\t\tif (rel.opts._type === CHART_TYPE.BAR3D) {\n\t\t\tstrXml += '<c:view3D>'\n\t\t\tstrXml += ' <c:rotX val=\"' + rel.opts.v3DRotX + '\"/>'\n\t\t\tstrXml += ' <c:rotY val=\"' + rel.opts.v3DRotY + '\"/>'\n\t\t\tstrXml += ' <c:rAngAx val=\"' + (rel.opts.v3DRAngAx === false ? 0 : 1) + '\"/>'\n\t\t\tstrXml += ' <c:perspective val=\"' + rel.opts.v3DPerspective + '\"/>'\n\t\t\tstrXml += '</c:view3D>'\n\t\t}\n\n\t\tstrXml += '<c:plotArea>'\n\t\t// IMPORTANT: Dont specify layout to enable auto-fit: PPT does a great job maximizing space with all 4 TRBL locations\n\t\tif (rel.opts.layout) {\n\t\t\tstrXml += '<c:layout>'\n\t\t\tstrXml += ' <c:manualLayout>'\n\t\t\tstrXml += '  <c:layoutTarget val=\"inner\" />'\n\t\t\tstrXml += '  <c:xMode val=\"edge\" />'\n\t\t\tstrXml += '  <c:yMode val=\"edge\" />'\n\t\t\tstrXml += '  <c:x val=\"' + (rel.opts.layout.x || 0) + '\" />'\n\t\t\tstrXml += '  <c:y val=\"' + (rel.opts.layout.y || 0) + '\" />'\n\t\t\tstrXml += '  <c:w val=\"' + (rel.opts.layout.w || 1) + '\" />'\n\t\t\tstrXml += '  <c:h val=\"' + (rel.opts.layout.h || 1) + '\" />'\n\t\t\tstrXml += ' </c:manualLayout>'\n\t\t\tstrXml += '</c:layout>'\n\t\t} else {\n\t\t\tstrXml += '<c:layout/>'\n\t\t}\n\t}\n\n\t// A: Create Chart XML -----------------------------------------------------------\n\tif (Array.isArray(rel.opts._type)) {\n\t\trel.opts._type.forEach(type => {\n\t\t\t// TODO: FIXME: theres `options` on chart rels??\n\t\t\tlet options = getMix(rel.opts, type.options) as IChartOptsLib\n\t\t\t//let options: IChartOptsLib = { type: type.type, }\n\t\t\tlet valAxisId = options['secondaryValAxis'] ? AXIS_ID_VALUE_SECONDARY : AXIS_ID_VALUE_PRIMARY\n\t\t\tlet catAxisId = options['secondaryCatAxis'] ? AXIS_ID_CATEGORY_SECONDARY : AXIS_ID_CATEGORY_PRIMARY\n\t\t\tusesSecondaryValAxis = usesSecondaryValAxis || options.secondaryValAxis\n\t\t\tstrXml += makeChartType(type.type, type.data, options, valAxisId, catAxisId, true)\n\t\t})\n\t} else {\n\t\tstrXml += makeChartType(rel.opts._type, rel.data, rel.opts, AXIS_ID_VALUE_PRIMARY, AXIS_ID_CATEGORY_PRIMARY, false)\n\t}\n\n\t// B: Axes -----------------------------------------------------------\n\tif (rel.opts._type !== CHART_TYPE.PIE && rel.opts._type !== CHART_TYPE.DOUGHNUT) {\n\t\t// Param check\n\t\tif (rel.opts.valAxes && rel.opts.valAxes.length > 1 && !usesSecondaryValAxis) {\n\t\t\tthrow new Error('Secondary axis must be used by one of the multiple charts')\n\t\t}\n\n\t\tif (rel.opts.catAxes) {\n\t\t\tif (!rel.opts.valAxes || rel.opts.valAxes.length !== rel.opts.catAxes.length) {\n\t\t\t\tthrow new Error('There must be the same number of value and category axes.')\n\t\t\t}\n\t\t\tstrXml += makeCatAxis(getMix(rel.opts, rel.opts.catAxes[0]) as IChartOptsLib, AXIS_ID_CATEGORY_PRIMARY, AXIS_ID_VALUE_PRIMARY)\n\t\t\tif (rel.opts.catAxes[1]) {\n\t\t\t\tstrXml += makeCatAxis(getMix(rel.opts, rel.opts.catAxes[1]) as IChartOptsLib, AXIS_ID_CATEGORY_SECONDARY, AXIS_ID_VALUE_PRIMARY)\n\t\t\t}\n\t\t} else {\n\t\t\tstrXml += makeCatAxis(rel.opts, AXIS_ID_CATEGORY_PRIMARY, AXIS_ID_VALUE_PRIMARY)\n\t\t}\n\n\t\tif (rel.opts.valAxes) {\n\t\t\tstrXml += makeValAxis(getMix(rel.opts, rel.opts.valAxes[0]) as IChartOptsLib, AXIS_ID_VALUE_PRIMARY)\n\t\t\tif (rel.opts.valAxes[1]) {\n\t\t\t\tstrXml += makeValAxis(getMix(rel.opts, rel.opts.valAxes[1]) as IChartOptsLib, AXIS_ID_VALUE_SECONDARY)\n\t\t\t}\n\t\t} else {\n\t\t\tstrXml += makeValAxis(rel.opts, AXIS_ID_VALUE_PRIMARY)\n\n\t\t\t// Add series axis for 3D bar\n\t\t\tif (rel.opts._type === CHART_TYPE.BAR3D) {\n\t\t\t\tstrXml += makeSerAxis(rel.opts, AXIS_ID_SERIES_PRIMARY, AXIS_ID_VALUE_PRIMARY)\n\t\t\t}\n\t\t}\n\t}\n\n\t// C: Chart Properties and plotArea Options: Border, Data Table, Fill, Legend\n\t{\n\t\t// NOTE: DataTable goes between '</c:valAx>' and '<c:spPr>'\n\t\tif (rel.opts.showDataTable) {\n\t\t\tstrXml += '<c:dTable>'\n\t\t\tstrXml += '  <c:showHorzBorder val=\"' + (rel.opts.showDataTableHorzBorder === false ? 0 : 1) + '\"/>'\n\t\t\tstrXml += '  <c:showVertBorder val=\"' + (rel.opts.showDataTableVertBorder === false ? 0 : 1) + '\"/>'\n\t\t\tstrXml += '  <c:showOutline    val=\"' + (rel.opts.showDataTableOutline === false ? 0 : 1) + '\"/>'\n\t\t\tstrXml += '  <c:showKeys       val=\"' + (rel.opts.showDataTableKeys === false ? 0 : 1) + '\"/>'\n\t\t\tstrXml += '  <c:spPr>'\n\t\t\tstrXml += '    <a:noFill/>'\n\t\t\tstrXml +=\n\t\t\t\t'    <a:ln w=\"9525\" cap=\"flat\" cmpd=\"sng\" algn=\"ctr\"><a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"15000\"/><a:lumOff val=\"85000\"/></a:schemeClr></a:solidFill><a:round/></a:ln>'\n\t\t\tstrXml += '    <a:effectLst/>'\n\t\t\tstrXml += '  </c:spPr>'\n\t\t\tstrXml += '  <c:txPr>'\n\t\t\tstrXml += '\t  <a:bodyPr rot=\"0\" spcFirstLastPara=\"1\" vertOverflow=\"ellipsis\" vert=\"horz\" wrap=\"square\" anchor=\"ctr\" anchorCtr=\"1\"/>'\n\t\t\tstrXml += '\t  <a:lstStyle/>'\n\t\t\tstrXml += '\t  <a:p>'\n\t\t\tstrXml += '\t\t<a:pPr rtl=\"0\">'\n\t\t\tstrXml += `       <a:defRPr sz=\"${rel.opts.dataTableFontSize || DEF_FONT_SIZE}00\" b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\" kern=\"1200\" baseline=\"0\">`\n\t\t\tstrXml += '\t\t\t<a:solidFill><a:schemeClr val=\"tx1\"><a:lumMod val=\"65000\"/><a:lumOff val=\"35000\"/></a:schemeClr></a:solidFill>'\n\t\t\tstrXml += '\t\t\t<a:latin typeface=\"+mn-lt\"/>'\n\t\t\tstrXml += '\t\t\t<a:ea typeface=\"+mn-ea\"/>'\n\t\t\tstrXml += '\t\t\t<a:cs typeface=\"+mn-cs\"/>'\n\t\t\tstrXml += '\t\t  </a:defRPr>'\n\t\t\tstrXml += '\t\t</a:pPr>'\n\t\t\tstrXml += '\t\t<a:endParaRPr lang=\"en-US\"/>'\n\t\t\tstrXml += '\t  </a:p>'\n\t\t\tstrXml += '\t</c:txPr>'\n\t\t\tstrXml += '</c:dTable>'\n\t\t}\n\n\t\tstrXml += '  <c:spPr>'\n\n\t\t// OPTION: Fill\n\t\tstrXml += rel.opts.fill ? genXmlColorSelection(rel.opts.fill) : '<a:noFill/>'\n\n\t\t// OPTION: Border\n\t\tstrXml += rel.opts.border ? `<a:ln w=\"${valToPts(rel.opts.border.pt)}\" cap=\"flat\">${genXmlColorSelection(rel.opts.border.color)}</a:ln>` : '<a:ln><a:noFill/></a:ln>'\n\n\t\t// Close shapeProp/plotArea before Legend\n\t\tstrXml += '    <a:effectLst/>'\n\t\tstrXml += '  </c:spPr>'\n\t\tstrXml += '</c:plotArea>'\n\n\t\t// OPTION: Legend\n\t\t// IMPORTANT: Dont specify layout to enable auto-fit: PPT does a great job maximizing space with all 4 TRBL locations\n\t\tif (rel.opts.showLegend) {\n\t\t\tstrXml += '<c:legend>'\n\t\t\tstrXml += '<c:legendPos val=\"' + rel.opts.legendPos + '\"/>'\n\t\t\t//strXml += '<c:layout/>'\n\t\t\tstrXml += '<c:overlay val=\"0\"/>'\n\t\t\tif (rel.opts.legendFontFace || rel.opts.legendFontSize || rel.opts.legendColor) {\n\t\t\t\tstrXml += '<c:txPr>'\n\t\t\t\tstrXml += '  <a:bodyPr/>'\n\t\t\t\tstrXml += '  <a:lstStyle/>'\n\t\t\t\tstrXml += '  <a:p>'\n\t\t\t\tstrXml += '    <a:pPr>'\n\t\t\t\tstrXml += rel.opts.legendFontSize ? '<a:defRPr sz=\"' + Number(rel.opts.legendFontSize) * 100 + '\">' : '<a:defRPr>'\n\t\t\t\tif (rel.opts.legendColor) strXml += genXmlColorSelection(rel.opts.legendColor)\n\t\t\t\tif (rel.opts.legendFontFace) strXml += '<a:latin typeface=\"' + rel.opts.legendFontFace + '\"/>'\n\t\t\t\tif (rel.opts.legendFontFace) strXml += '<a:cs    typeface=\"' + rel.opts.legendFontFace + '\"/>'\n\t\t\t\tstrXml += '      </a:defRPr>'\n\t\t\t\tstrXml += '    </a:pPr>'\n\t\t\t\tstrXml += '    <a:endParaRPr lang=\"en-US\"/>'\n\t\t\t\tstrXml += '  </a:p>'\n\t\t\t\tstrXml += '</c:txPr>'\n\t\t\t}\n\t\t\tstrXml += '</c:legend>'\n\t\t}\n\t}\n\n\tstrXml += '  <c:plotVisOnly val=\"1\"/>'\n\tstrXml += '  <c:dispBlanksAs val=\"' + rel.opts.displayBlanksAs + '\"/>'\n\tif (rel.opts._type === CHART_TYPE.SCATTER) strXml += '<c:showDLblsOverMax val=\"1\"/>'\n\n\tstrXml += '</c:chart>'\n\n\t// D: CHARTSPACE SHAPE PROPS\n\tstrXml += '<c:spPr>'\n\tstrXml += '  <a:noFill/>'\n\tstrXml += '  <a:ln w=\"12700\" cap=\"flat\"><a:noFill/><a:miter lim=\"400000\"/></a:ln>'\n\tstrXml += '  <a:effectLst/>'\n\tstrXml += '</c:spPr>'\n\n\t// E: DATA (Add relID)\n\tstrXml += '<c:externalData r:id=\"rId1\"><c:autoUpdate val=\"0\"/></c:externalData>'\n\n\t// LAST: chartSpace end\n\tstrXml += '</c:chartSpace>'\n\n\treturn strXml\n}\n\n/**\n * Create XML string for any given chart type\n * @param {CHART_NAME} `chartType` chart type name\n * @param {OptsChartData[]} `data` chart data\n * @param {IChartOptsLib} `opts` chart options\n * @param {string} `valAxisId`\n * @param {string} `catAxisId`\n * @param {boolean} `isMultiTypeChart`\n * @example '<c:bubbleChart>'\n * @example '<c:lineChart>'\n * @return {string} XML\n */\nfunction makeChartType(chartType: CHART_NAME, data: OptsChartData[], opts: IChartOptsLib, valAxisId: string, catAxisId: string, isMultiTypeChart: boolean): string {\n\t// NOTE: \"Chart Range\" (as shown in \"select Chart Area dialog\") is calculated.\n\t// ....: Ensure each X/Y Axis/Col has same row height (esp. applicable to XY Scatter where X can often be larger than Y's)\n\tlet strXml: string = ''\n\n\tswitch (chartType) {\n\t\tcase CHART_TYPE.AREA:\n\t\tcase CHART_TYPE.BAR:\n\t\tcase CHART_TYPE.BAR3D:\n\t\tcase CHART_TYPE.LINE:\n\t\tcase CHART_TYPE.RADAR:\n\t\t\t// 1: Start Chart\n\t\t\tstrXml += '<c:' + chartType + 'Chart>'\n\t\t\tif (chartType === CHART_TYPE.AREA && opts.barGrouping === 'stacked') {\n\t\t\t\tstrXml += '<c:grouping val=\"' + opts.barGrouping + '\"/>'\n\t\t\t}\n\n\t\t\tif (chartType === CHART_TYPE.BAR || chartType === CHART_TYPE.BAR3D) {\n\t\t\t\tstrXml += '<c:barDir val=\"' + opts.barDir + '\"/>'\n\t\t\t\tstrXml += '<c:grouping val=\"' + opts.barGrouping + '\"/>'\n\t\t\t}\n\n\t\t\tif (chartType === CHART_TYPE.RADAR) {\n\t\t\t\tstrXml += '<c:radarStyle val=\"' + opts.radarStyle + '\"/>'\n\t\t\t}\n\n\t\t\tstrXml += '<c:varyColors val=\"0\"/>'\n\n\t\t\t// 2: \"Series\" block for every data row\n\t\t\t/* EX:\n\t\t\t\tdata: [\n\t\t\t\t {\n\t\t\t\t   name: 'Region 1',\n\t\t\t\t   labels: ['April', 'May', 'June', 'July'],\n\t\t\t\t   values: [17, 26, 53, 96]\n\t\t\t\t },\n\t\t\t\t {\n\t\t\t\t   name: 'Region 2',\n\t\t\t\t   labels: ['April', 'May', 'June', 'July'],\n\t\t\t\t   values: [55, 43, 70, 58]\n\t\t\t\t }\n\t\t\t\t]\n\t\t\t*/\n\t\t\tlet colorIndex = -1 // Maintain the color index by region\n\t\t\tdata.forEach(obj => {\n\t\t\t\tcolorIndex++\n\t\t\t\tlet idx = obj.index\n\t\t\t\tstrXml += '<c:ser>'\n\t\t\t\tstrXml += '  <c:idx val=\"' + idx + '\"/>'\n\t\t\t\tstrXml += '  <c:order val=\"' + idx + '\"/>'\n\t\t\t\tstrXml += '  <c:tx>'\n\t\t\t\tstrXml += '    <c:strRef>'\n\t\t\t\tstrXml += '      <c:f>Sheet1!$' + getExcelColName(idx + 1) + '$1</c:f>'\n\t\t\t\tstrXml += '      <c:strCache><c:ptCount val=\"1\"/><c:pt idx=\"0\"><c:v>' + encodeXmlEntities(obj.name) + '</c:v></c:pt></c:strCache>'\n\t\t\t\tstrXml += '    </c:strRef>'\n\t\t\t\tstrXml += '  </c:tx>'\n\t\t\t\tstrXml += '  <c:invertIfNegative val=\"0\"/>'\n\n\t\t\t\t// Fill and Border\n\t\t\t\t// TODO: CURRENT: Pull#727\n\t\t\t\t// WIP: let seriesColor = obj.color ? obj.color : opts.chartColors ? opts.chartColors[colorIndex % opts.chartColors.length] : null\n\t\t\t\tlet seriesColor = opts.chartColors ? opts.chartColors[colorIndex % opts.chartColors.length] : null\n\n\t\t\t\tstrXml += '  <c:spPr>'\n\t\t\t\tif (seriesColor === 'transparent') {\n\t\t\t\t\tstrXml += '<a:noFill/>'\n\t\t\t\t} else if (opts.chartColorsOpacity) {\n\t\t\t\t\tstrXml += '<a:solidFill>' + createColorElement(seriesColor, '<a:alpha val=\"' + opts.chartColorsOpacity + '000\"/>') + '</a:solidFill>'\n\t\t\t\t} else {\n\t\t\t\t\tstrXml += '<a:solidFill>' + createColorElement(seriesColor) + '</a:solidFill>'\n\t\t\t\t}\n\n\t\t\t\tif (chartType === CHART_TYPE.LINE) {\n\t\t\t\t\tif (opts.lineSize === 0) {\n\t\t\t\t\t\tstrXml += '<a:ln><a:noFill/></a:ln>'\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrXml += '<a:ln w=\"' + valToPts(opts.lineSize) + '\" cap=\"flat\"><a:solidFill>' + createColorElement(seriesColor) + '</a:solidFill>'\n\t\t\t\t\t\tstrXml += '<a:prstDash val=\"' + (opts.lineDash || 'solid') + '\"/><a:round/></a:ln>'\n\t\t\t\t\t}\n\t\t\t\t} else if (opts.dataBorder) {\n\t\t\t\t\tstrXml +=\n\t\t\t\t\t\t'<a:ln w=\"' +\n\t\t\t\t\t\tvalToPts(opts.dataBorder.pt) +\n\t\t\t\t\t\t'\" cap=\"flat\"><a:solidFill>' +\n\t\t\t\t\t\tcreateColorElement(opts.dataBorder.color) +\n\t\t\t\t\t\t'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>'\n\t\t\t\t}\n\n\t\t\t\tstrXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW)\n\n\t\t\t\tstrXml += '  </c:spPr>'\n\n\t\t\t\t// Data Labels per series\n\t\t\t\t// [20190117] NOTE: Adding these to RADAR chart causes unrecoverable corruption!\n\t\t\t\tif (chartType !== CHART_TYPE.RADAR) {\n\t\t\t\t\tstrXml += '  <c:dLbls>'\n\t\t\t\t\tstrXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>'\n\t\t\t\t\tif (opts.dataLabelBkgrdColors) {\n\t\t\t\t\t\tstrXml += '    <c:spPr>'\n\t\t\t\t\t\tstrXml += '       <a:solidFill>' + createColorElement(seriesColor) + '</a:solidFill>'\n\t\t\t\t\t\tstrXml += '    </c:spPr>'\n\t\t\t\t\t}\n\t\t\t\t\tstrXml += '    <c:txPr>'\n\t\t\t\t\tstrXml += '      <a:bodyPr/>'\n\t\t\t\t\tstrXml += '      <a:lstStyle/>'\n\t\t\t\t\tstrXml += '      <a:p><a:pPr>'\n\t\t\t\t\tstrXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">'\n\t\t\t\t\tstrXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>'\n\t\t\t\t\tstrXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>'\n\t\t\t\t\tstrXml += '        </a:defRPr>'\n\t\t\t\t\tstrXml += '      </a:pPr></a:p>'\n\t\t\t\t\tstrXml += '    </c:txPr>'\n\t\t\t\t\t// Setting dLblPos tag for bar3D seems to break the generated chart\n\t\t\t\t\tif (chartType !== CHART_TYPE.AREA && chartType !== CHART_TYPE.BAR3D) {\n\t\t\t\t\t\tif (opts.dataLabelPosition) strXml += ' <c:dLblPos val=\"' + opts.dataLabelPosition + '\"/>'\n\t\t\t\t\t}\n\t\t\t\t\tstrXml += '    <c:showLegendKey val=\"0\"/>'\n\t\t\t\t\tstrXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>'\n\t\t\t\t\tstrXml += '    <c:showCatName val=\"0\"/>'\n\t\t\t\t\tstrXml += '    <c:showSerName val=\"0\"/>'\n\t\t\t\t\tstrXml += '    <c:showPercent val=\"0\"/>'\n\t\t\t\t\tstrXml += '    <c:showBubbleSize val=\"0\"/>'\n\t\t\t\t\tstrXml += `    <c:showLeaderLines val=\"${opts.showLeaderLines ? '1' : '0'}\"/>`\n\t\t\t\t\tstrXml += '  </c:dLbls>'\n\t\t\t\t}\n\n\t\t\t\t// 'c:marker' tag: `lineDataSymbol`\n\t\t\t\tif (chartType === CHART_TYPE.LINE || chartType === CHART_TYPE.RADAR) {\n\t\t\t\t\tstrXml += '<c:marker>'\n\t\t\t\t\tstrXml += '  <c:symbol val=\"' + opts.lineDataSymbol + '\"/>'\n\t\t\t\t\tif (opts.lineDataSymbolSize) {\n\t\t\t\t\t\t// Defaults to \"auto\" otherwise (but this is usually too small, so there is a default)\n\t\t\t\t\t\tstrXml += '  <c:size val=\"' + opts.lineDataSymbolSize + '\"/>'\n\t\t\t\t\t}\n\t\t\t\t\tstrXml += '  <c:spPr>'\n\t\t\t\t\tstrXml +=\n\t\t\t\t\t\t'    <a:solidFill>' +\n\t\t\t\t\t\tcreateColorElement(opts.chartColors[idx + 1 > opts.chartColors.length ? Math.floor(Math.random() * opts.chartColors.length) : idx]) +\n\t\t\t\t\t\t'</a:solidFill>'\n\n\t\t\t\t\tstrXml +=\n\t\t\t\t\t\t'    <a:ln w=\"' +\n\t\t\t\t\t\topts.lineDataSymbolLineSize +\n\t\t\t\t\t\t'\" cap=\"flat\"><a:solidFill>' +\n\t\t\t\t\t\tcreateColorElement(opts.lineDataSymbolLineColor || seriesColor) +\n\t\t\t\t\t\t'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>'\n\t\t\t\t\tstrXml += '    <a:effectLst/>'\n\t\t\t\t\tstrXml += '  </c:spPr>'\n\t\t\t\t\tstrXml += '</c:marker>'\n\t\t\t\t}\n\n\t\t\t\t// Color chart bars various colors\n\t\t\t\t// Allow users with a single data set to pass their own array of colors (check for this using != ours)\n\t\t\t\tif ((chartType === CHART_TYPE.BAR || chartType === CHART_TYPE.BAR3D) && (data.length === 1 || opts.valueBarColors) && opts.chartColors !== BARCHART_COLORS) {\n\t\t\t\t\t// Series Data Point colors\n\t\t\t\t\tobj.values.forEach((value, index) => {\n\t\t\t\t\t\tlet arrColors = value < 0 ? opts.invertedColors || opts.chartColors || BARCHART_COLORS : opts.chartColors || []\n\n\t\t\t\t\t\tstrXml += '  <c:dPt>'\n\t\t\t\t\t\tstrXml += '    <c:idx val=\"' + index + '\"/>'\n\t\t\t\t\t\tstrXml += '      <c:invertIfNegative val=\"0\"/>'\n\t\t\t\t\t\tstrXml += '    <c:bubble3D val=\"0\"/>'\n\t\t\t\t\t\tstrXml += '    <c:spPr>'\n\t\t\t\t\t\tif (opts.lineSize === 0) {\n\t\t\t\t\t\t\tstrXml += '<a:ln><a:noFill/></a:ln>'\n\t\t\t\t\t\t} else if (chartType === CHART_TYPE.BAR) {\n\t\t\t\t\t\t\tstrXml += '<a:solidFill>'\n\t\t\t\t\t\t\tstrXml += '  <a:srgbClr val=\"' + arrColors[index % arrColors.length] + '\"/>'\n\t\t\t\t\t\t\tstrXml += '</a:solidFill>'\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstrXml += '<a:ln>'\n\t\t\t\t\t\t\tstrXml += '  <a:solidFill>'\n\t\t\t\t\t\t\tstrXml += '   <a:srgbClr val=\"' + arrColors[index % arrColors.length] + '\"/>'\n\t\t\t\t\t\t\tstrXml += '  </a:solidFill>'\n\t\t\t\t\t\t\tstrXml += '</a:ln>'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstrXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW)\n\t\t\t\t\t\tstrXml += '    </c:spPr>'\n\t\t\t\t\t\tstrXml += '  </c:dPt>'\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// 2: \"Categories\"\n\t\t\t\t{\n\t\t\t\t\tstrXml += '<c:cat>'\n\t\t\t\t\tif (opts.catLabelFormatCode) {\n\t\t\t\t\t\t// Use 'numRef' as catLabelFormatCode implies that we are expecting numbers here\n\t\t\t\t\t\tstrXml += '  <c:numRef>'\n\t\t\t\t\t\tstrXml += '    <c:f>Sheet1!$A$2:$A$' + (obj.labels.length + 1) + '</c:f>'\n\t\t\t\t\t\tstrXml += '    <c:numCache>'\n\t\t\t\t\t\tstrXml += '      <c:formatCode>' + (opts.catLabelFormatCode || 'General') + '</c:formatCode>'\n\t\t\t\t\t\tstrXml += '      <c:ptCount val=\"' + obj.labels.length + '\"/>'\n\t\t\t\t\t\tobj.labels.forEach((label, idx) => {\n\t\t\t\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + encodeXmlEntities(label) + '</c:v></c:pt>'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tstrXml += '    </c:numCache>'\n\t\t\t\t\t\tstrXml += '  </c:numRef>'\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrXml += '  <c:strRef>'\n\t\t\t\t\t\tstrXml += '    <c:f>Sheet1!$A$2:$A$' + (obj.labels.length + 1) + '</c:f>'\n\t\t\t\t\t\tstrXml += '    <c:strCache>'\n\t\t\t\t\t\tstrXml += '\t     <c:ptCount val=\"' + obj.labels.length + '\"/>'\n\t\t\t\t\t\tobj.labels.forEach((label, idx) => {\n\t\t\t\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + encodeXmlEntities(label) + '</c:v></c:pt>'\n\t\t\t\t\t\t})\n\t\t\t\t\t\tstrXml += '    </c:strCache>'\n\t\t\t\t\t\tstrXml += '  </c:strRef>'\n\t\t\t\t\t}\n\t\t\t\t\tstrXml += '</c:cat>'\n\t\t\t\t}\n\n\t\t\t\t// 3: \"Values\"\n\t\t\t\t{\n\t\t\t\t\tstrXml += '<c:val>'\n\t\t\t\t\tstrXml += '  <c:numRef>'\n\t\t\t\t\tstrXml += '    <c:f>Sheet1!$' + getExcelColName(idx + 1) + '$2:$' + getExcelColName(idx + 1) + '$' + (obj.labels.length + 1) + '</c:f>'\n\t\t\t\t\tstrXml += '    <c:numCache>'\n\t\t\t\t\tstrXml += '      <c:formatCode>' + (opts.valLabelFormatCode || opts.dataTableFormatCode || 'General') + '</c:formatCode>'\n\t\t\t\t\tstrXml += '      <c:ptCount val=\"' + obj.labels.length + '\"/>'\n\t\t\t\t\tobj.values.forEach((value, idx) => {\n\t\t\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || value === 0 ? value : '') + '</c:v></c:pt>'\n\t\t\t\t\t})\n\t\t\t\t\tstrXml += '    </c:numCache>'\n\t\t\t\t\tstrXml += '  </c:numRef>'\n\t\t\t\t\tstrXml += '</c:val>'\n\t\t\t\t}\n\n\t\t\t\t// Option: `smooth`\n\t\t\t\tif (chartType === CHART_TYPE.LINE) strXml += '<c:smooth val=\"' + (opts.lineSmooth ? '1' : '0') + '\"/>'\n\n\t\t\t\t// 4: Close \"SERIES\"\n\t\t\t\tstrXml += '</c:ser>'\n\t\t\t})\n\n\t\t\t// 3: \"Data Labels\"\n\t\t\t{\n\t\t\t\tstrXml += '  <c:dLbls>'\n\t\t\t\tstrXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>'\n\t\t\t\tstrXml += '    <c:txPr>'\n\t\t\t\tstrXml += '      <a:bodyPr/>'\n\t\t\t\tstrXml += '      <a:lstStyle/>'\n\t\t\t\tstrXml += '      <a:p><a:pPr>'\n\t\t\t\tstrXml +=\n\t\t\t\t\t'        <a:defRPr b=\"' + (opts.dataLabelFontBold ? 1 : 0) + '\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">'\n\t\t\t\tstrXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>'\n\t\t\t\tstrXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>'\n\t\t\t\tstrXml += '        </a:defRPr>'\n\t\t\t\tstrXml += '      </a:pPr></a:p>'\n\t\t\t\tstrXml += '    </c:txPr>'\n\t\t\t\t// NOTE: Throwing an error while creating a multi type chart which contains area chart as the below line appears for the other chart type.\n\t\t\t\t// Either the given change can be made or the below line can be removed to stop the slide containing multi type chart with area to crash.\n\t\t\t\tif (opts._type !== CHART_TYPE.AREA && opts._type !== CHART_TYPE.RADAR && !isMultiTypeChart)\n\t\t\t\t\tif (opts.dataLabelPosition) strXml += ' <c:dLblPos val=\"' + opts.dataLabelPosition + '\"/>'\n\t\t\t\tstrXml += '    <c:showLegendKey val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>'\n\t\t\t\tstrXml += '    <c:showCatName val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showSerName val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showPercent val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showBubbleSize val=\"0\"/>'\n\t\t\t\tstrXml += `    <c:showLeaderLines val=\"${opts.showLeaderLines ? '1' : '0'}\"/>`\n\t\t\t\tstrXml += '  </c:dLbls>'\n\t\t\t}\n\n\t\t\t// 4: Add more chart options (gapWidth, line Marker, etc.)\n\t\t\tif (chartType === CHART_TYPE.BAR) {\n\t\t\t\tstrXml += '  <c:gapWidth val=\"' + opts.barGapWidthPct + '\"/>'\n\t\t\t\tstrXml += '  <c:overlap val=\"' + ((opts.barGrouping || '').indexOf('tacked') > -1 ? 100 : 0) + '\"/>'\n\t\t\t} else if (chartType === CHART_TYPE.BAR3D) {\n\t\t\t\tstrXml += '  <c:gapWidth val=\"' + opts.barGapWidthPct + '\"/>'\n\t\t\t\tstrXml += '  <c:gapDepth val=\"' + opts.barGapDepthPct + '\"/>'\n\t\t\t\tstrXml += '  <c:shape val=\"' + opts.bar3DShape + '\"/>'\n\t\t\t} else if (chartType === CHART_TYPE.LINE) {\n\t\t\t\tstrXml += '  <c:marker val=\"1\"/>'\n\t\t\t}\n\n\t\t\t// 5: Add axisId (NOTE: order matters! (category comes first))\n\t\t\tstrXml += '  <c:axId val=\"' + catAxisId + '\"/>'\n\t\t\tstrXml += '  <c:axId val=\"' + valAxisId + '\"/>'\n\t\t\tstrXml += '  <c:axId val=\"' + AXIS_ID_SERIES_PRIMARY + '\"/>'\n\n\t\t\t// 6: Close Chart tag\n\t\t\tstrXml += '</c:' + chartType + 'Chart>'\n\n\t\t\t// end switch\n\t\t\tbreak\n\n\t\tcase CHART_TYPE.SCATTER:\n\t\t\t/*\n\t\t\t\t`data` = [\n\t\t\t\t\t{ name:'X-Axis',    values:[1,2,3,4,5,6,7,8,9,10,11,12] },\n\t\t\t\t\t{ name:'Y-Value 1', values:[13, 20, 21, 25] },\n\t\t\t\t\t{ name:'Y-Value 2', values:[ 1,  2,  5,  9] }\n\t\t\t\t];\n\t\t\t*/\n\n\t\t\t// 1: Start Chart\n\t\t\tstrXml += '<c:' + chartType + 'Chart>'\n\t\t\tstrXml += '<c:scatterStyle val=\"lineMarker\"/>'\n\t\t\tstrXml += '<c:varyColors val=\"0\"/>'\n\n\t\t\t// 2: Series: (One for each Y-Axis)\n\t\t\tcolorIndex = -1\n\t\t\tdata.filter((_obj, idx) => idx > 0).forEach((obj, idx) => {\n\t\t\t\tcolorIndex++\n\t\t\t\tstrXml += '<c:ser>'\n\t\t\t\tstrXml += '  <c:idx val=\"' + idx + '\"/>'\n\t\t\t\tstrXml += '  <c:order val=\"' + idx + '\"/>'\n\t\t\t\tstrXml += '  <c:tx>'\n\t\t\t\tstrXml += '    <c:strRef>'\n\t\t\t\tstrXml += '      <c:f>Sheet1!$' + LETTERS[idx + 1] + '$1</c:f>'\n\t\t\t\tstrXml += '      <c:strCache><c:ptCount val=\"1\"/><c:pt idx=\"0\"><c:v>' + obj.name + '</c:v></c:pt></c:strCache>'\n\t\t\t\tstrXml += '    </c:strRef>'\n\t\t\t\tstrXml += '  </c:tx>'\n\n\t\t\t\t// 'c:spPr': Fill, Border, Line, LineStyle (dash, etc.), Shadow\n\t\t\t\tstrXml += '  <c:spPr>'\n\t\t\t\t{\n\t\t\t\t\tlet tmpSerColor = opts.chartColors[colorIndex % opts.chartColors.length]\n\n\t\t\t\t\tif (tmpSerColor === 'transparent') {\n\t\t\t\t\t\tstrXml += '<a:noFill/>'\n\t\t\t\t\t} else if (opts.chartColorsOpacity) {\n\t\t\t\t\t\tstrXml += '<a:solidFill>' + createColorElement(tmpSerColor, '<a:alpha val=\"' + opts.chartColorsOpacity + '000\"/>') + '</a:solidFill>'\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrXml += '<a:solidFill>' + createColorElement(tmpSerColor) + '</a:solidFill>'\n\t\t\t\t\t}\n\n\t\t\t\t\tif (opts.lineSize === 0) {\n\t\t\t\t\t\tstrXml += '<a:ln><a:noFill/></a:ln>'\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrXml += '<a:ln w=\"' + valToPts(opts.lineSize) + '\" cap=\"flat\"><a:solidFill>' + createColorElement(tmpSerColor) + '</a:solidFill>'\n\t\t\t\t\t\tstrXml += '<a:prstDash val=\"' + (opts.lineDash || 'solid') + '\"/><a:round/></a:ln>'\n\t\t\t\t\t}\n\n\t\t\t\t\t// Shadow\n\t\t\t\t\tstrXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW)\n\t\t\t\t}\n\t\t\t\tstrXml += '  </c:spPr>'\n\n\t\t\t\t// 'c:marker' tag: `lineDataSymbol`\n\t\t\t\t{\n\t\t\t\t\tstrXml += '<c:marker>'\n\t\t\t\t\tstrXml += '  <c:symbol val=\"' + opts.lineDataSymbol + '\"/>'\n\t\t\t\t\tif (opts.lineDataSymbolSize) {\n\t\t\t\t\t\t// Defaults to \"auto\" otherwise (but this is usually too small, so there is a default)\n\t\t\t\t\t\tstrXml += '  <c:size val=\"' + opts.lineDataSymbolSize + '\"/>'\n\t\t\t\t\t}\n\t\t\t\t\tstrXml += '  <c:spPr>'\n\t\t\t\t\tstrXml +=\n\t\t\t\t\t\t'    <a:solidFill>' +\n\t\t\t\t\t\tcreateColorElement(opts.chartColors[idx + 1 > opts.chartColors.length ? Math.floor(Math.random() * opts.chartColors.length) : idx]) +\n\t\t\t\t\t\t'</a:solidFill>'\n\n\t\t\t\t\tstrXml +=\n\t\t\t\t\t\t'    <a:ln w=\"' +\n\t\t\t\t\t\topts.lineDataSymbolLineSize +\n\t\t\t\t\t\t'\" cap=\"flat\"><a:solidFill>' +\n\t\t\t\t\t\tcreateColorElement(opts.lineDataSymbolLineColor || opts.chartColors[colorIndex % opts.chartColors.length]) +\n\t\t\t\t\t\t'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>'\n\t\t\t\t\tstrXml += '    <a:effectLst/>'\n\t\t\t\t\tstrXml += '  </c:spPr>'\n\t\t\t\t\tstrXml += '</c:marker>'\n\t\t\t\t}\n\n\t\t\t\t// Option: scatter data point labels\n\t\t\t\tif (opts.showLabel) {\n\t\t\t\t\tlet chartUuid = getUuid('-xxxx-xxxx-xxxx-xxxxxxxxxxxx')\n\t\t\t\t\tif (obj.labels && (opts.dataLabelFormatScatter === 'custom' || opts.dataLabelFormatScatter === 'customXY')) {\n\t\t\t\t\t\tstrXml += '<c:dLbls>'\n\t\t\t\t\t\tobj.labels.forEach((label, idx) => {\n\t\t\t\t\t\t\tif (opts.dataLabelFormatScatter === 'custom' || opts.dataLabelFormatScatter === 'customXY') {\n\t\t\t\t\t\t\t\tstrXml += '  <c:dLbl>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:idx val=\"' + idx + '\"/>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:tx>'\n\t\t\t\t\t\t\t\tstrXml += '      <c:rich>'\n\t\t\t\t\t\t\t\tstrXml += '\t\t\t<a:bodyPr>'\n\t\t\t\t\t\t\t\tstrXml += '\t\t\t\t<a:spAutoFit/>'\n\t\t\t\t\t\t\t\tstrXml += '\t\t\t</a:bodyPr>'\n\t\t\t\t\t\t\t\tstrXml += '        \t<a:lstStyle/>'\n\t\t\t\t\t\t\t\tstrXml += '        \t<a:p>'\n\t\t\t\t\t\t\t\tstrXml += '\t\t\t\t<a:pPr>'\n\t\t\t\t\t\t\t\tstrXml += '\t\t\t\t\t<a:defRPr/>'\n\t\t\t\t\t\t\t\tstrXml += '\t\t\t\t</a:pPr>'\n\t\t\t\t\t\t\t\tstrXml += '          \t<a:r>'\n\t\t\t\t\t\t\t\tstrXml += '            \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" dirty=\"0\"/>'\n\t\t\t\t\t\t\t\tstrXml += '            \t\t<a:t>' + encodeXmlEntities(label) + '</a:t>'\n\t\t\t\t\t\t\t\tstrXml += '          \t</a:r>'\n\t\t\t\t\t\t\t\t// Apply XY values at end of custom label\n\t\t\t\t\t\t\t\t// Do not apply the values if the label was empty or just spaces\n\t\t\t\t\t\t\t\t// This allows for selective labelling where required\n\t\t\t\t\t\t\t\tif (opts.dataLabelFormatScatter === 'customXY' && !/^ *$/.test(label)) {\n\t\t\t\t\t\t\t\t\tstrXml += '          \t<a:r>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\" dirty=\"0\"/>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:t> (</a:t>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t</a:r>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t<a:fld id=\"{' + getUuid('xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx') + '}\" type=\"XVALUE\">'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\"/>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:pPr>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t\t<a:defRPr/>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t</a:pPr>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:t>[' + encodeXmlEntities(obj.name) + '</a:t>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t</a:fld>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t<a:r>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\" dirty=\"0\"/>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:t>, </a:t>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t</a:r>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t<a:fld id=\"{' + getUuid('xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx') + '}\" type=\"YVALUE\">'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\"/>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:pPr>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t\t<a:defRPr/>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t</a:pPr>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:t>[' + encodeXmlEntities(obj.name) + ']</a:t>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t</a:fld>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t<a:r>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:rPr lang=\"' + (opts.lang || 'en-US') + '\" baseline=\"0\" dirty=\"0\"/>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t\t<a:t>)</a:t>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t</a:r>'\n\t\t\t\t\t\t\t\t\tstrXml += '          \t<a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\" dirty=\"0\"/>'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstrXml += '        \t</a:p>'\n\t\t\t\t\t\t\t\tstrXml += '      </c:rich>'\n\t\t\t\t\t\t\t\tstrXml += '    </c:tx>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:spPr>'\n\t\t\t\t\t\t\t\tstrXml += '    \t<a:noFill/>'\n\t\t\t\t\t\t\t\tstrXml += '    \t<a:ln>'\n\t\t\t\t\t\t\t\tstrXml += '    \t\t<a:noFill/>'\n\t\t\t\t\t\t\t\tstrXml += '    \t</a:ln>'\n\t\t\t\t\t\t\t\tstrXml += '    \t<a:effectLst/>'\n\t\t\t\t\t\t\t\tstrXml += '    </c:spPr>'\n\t\t\t\t\t\t\t\tif (opts.dataLabelPosition) strXml += ' <c:dLblPos val=\"' + opts.dataLabelPosition + '\"/>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:showLegendKey val=\"0\"/>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:showVal val=\"0\"/>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:showCatName val=\"0\"/>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:showSerName val=\"0\"/>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:showPercent val=\"0\"/>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:showBubbleSize val=\"0\"/>'\n\t\t\t\t\t\t\t\tstrXml += '\t   <c:showLeaderLines val=\"1\"/>'\n\t\t\t\t\t\t\t\tstrXml += '    <c:extLst>'\n\t\t\t\t\t\t\t\tstrXml += '      <c:ext uri=\"{CE6537A1-D6FC-4f65-9D91-7224C49458BB}\" xmlns:c15=\"http://schemas.microsoft.com/office/drawing/2012/chart\"/>'\n\t\t\t\t\t\t\t\tstrXml += '      <c:ext uri=\"{C3380CC4-5D6E-409C-BE32-E72D297353CC}\" xmlns:c16=\"http://schemas.microsoft.com/office/drawing/2014/chart\">'\n\t\t\t\t\t\t\t\tstrXml += '\t\t\t<c16:uniqueId val=\"{' + '00000000'.substring(0, 8 - (idx + 1).toString().length).toString() + (idx + 1) + chartUuid + '}\"/>'\n\t\t\t\t\t\t\t\tstrXml += '      </c:ext>'\n\t\t\t\t\t\t\t\tstrXml += '\t\t</c:extLst>'\n\t\t\t\t\t\t\t\tstrXml += '</c:dLbl>'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\tstrXml += '</c:dLbls>'\n\t\t\t\t\t}\n\t\t\t\t\tif (opts.dataLabelFormatScatter === 'XY') {\n\t\t\t\t\t\tstrXml += '<c:dLbls>'\n\t\t\t\t\t\tstrXml += '\t<c:spPr>'\n\t\t\t\t\t\tstrXml += '\t\t<a:noFill/>'\n\t\t\t\t\t\tstrXml += '\t\t<a:ln>'\n\t\t\t\t\t\tstrXml += '\t\t\t<a:noFill/>'\n\t\t\t\t\t\tstrXml += '\t\t</a:ln>'\n\t\t\t\t\t\tstrXml += '\t  \t<a:effectLst/>'\n\t\t\t\t\t\tstrXml += '\t</c:spPr>'\n\t\t\t\t\t\tstrXml += '\t<c:txPr>'\n\t\t\t\t\t\tstrXml += '\t\t<a:bodyPr>'\n\t\t\t\t\t\tstrXml += '\t\t\t<a:spAutoFit/>'\n\t\t\t\t\t\tstrXml += '\t\t</a:bodyPr>'\n\t\t\t\t\t\tstrXml += '\t\t<a:lstStyle/>'\n\t\t\t\t\t\tstrXml += '\t\t<a:p>'\n\t\t\t\t\t\tstrXml += '\t    \t<a:pPr>'\n\t\t\t\t\t\tstrXml += '        \t\t<a:defRPr/>'\n\t\t\t\t\t\tstrXml += '\t    \t</a:pPr>'\n\t\t\t\t\t\tstrXml += '\t    \t<a:endParaRPr lang=\"en-US\"/>'\n\t\t\t\t\t\tstrXml += '\t\t</a:p>'\n\t\t\t\t\t\tstrXml += '\t</c:txPr>'\n\t\t\t\t\t\tif (opts.dataLabelPosition) strXml += ' <c:dLblPos val=\"' + opts.dataLabelPosition + '\"/>'\n\t\t\t\t\t\tstrXml += '\t<c:showLegendKey val=\"0\"/>'\n\t\t\t\t\t\tstrXml += ` <c:showVal val=\"${opts.showLabel ? '1' : '0'}\"/>`\n\t\t\t\t\t\tstrXml += ` <c:showCatName val=\"${opts.showLabel ? '1' : '0'}\"/>`\n\t\t\t\t\t\tstrXml += '\t<c:showSerName val=\"0\"/>'\n\t\t\t\t\t\tstrXml += '\t<c:showPercent val=\"0\"/>'\n\t\t\t\t\t\tstrXml += '\t<c:showBubbleSize val=\"0\"/>'\n\t\t\t\t\t\tstrXml += '\t<c:extLst>'\n\t\t\t\t\t\tstrXml += '\t\t<c:ext uri=\"{CE6537A1-D6FC-4f65-9D91-7224C49458BB}\" xmlns:c15=\"http://schemas.microsoft.com/office/drawing/2012/chart\">'\n\t\t\t\t\t\tstrXml += '\t\t\t<c15:showLeaderLines val=\"1\"/>'\n\t\t\t\t\t\tstrXml += '\t\t</c:ext>'\n\t\t\t\t\t\tstrXml += '\t</c:extLst>'\n\t\t\t\t\t\tstrXml += '</c:dLbls>'\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Color bar chart bars various colors\n\t\t\t\t// Allow users with a single data set to pass their own array of colors (check for this using != ours)\n\t\t\t\tif ((data.length === 1 || opts.valueBarColors) && opts.chartColors !== BARCHART_COLORS) {\n\t\t\t\t\t// Series Data Point colors\n\t\t\t\t\tobj.values.forEach((value, index) => {\n\t\t\t\t\t\tlet arrColors = value < 0 ? opts.invertedColors || BARCHART_COLORS : opts.chartColors || []\n\n\t\t\t\t\t\tstrXml += '  <c:dPt>'\n\t\t\t\t\t\tstrXml += '    <c:idx val=\"' + index + '\"/>'\n\t\t\t\t\t\tstrXml += '      <c:invertIfNegative val=\"0\"/>'\n\t\t\t\t\t\tstrXml += '    <c:bubble3D val=\"0\"/>'\n\t\t\t\t\t\tstrXml += '    <c:spPr>'\n\t\t\t\t\t\tif (opts.lineSize === 0) {\n\t\t\t\t\t\t\tstrXml += '<a:ln><a:noFill/></a:ln>'\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstrXml += '<a:solidFill>'\n\t\t\t\t\t\t\tstrXml += ' <a:srgbClr val=\"' + arrColors[index % arrColors.length] + '\"/>'\n\t\t\t\t\t\t\tstrXml += '</a:solidFill>'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstrXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW)\n\t\t\t\t\t\tstrXml += '    </c:spPr>'\n\t\t\t\t\t\tstrXml += '  </c:dPt>'\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\t// 3: \"Values\": Scatter Chart has 2: `xVal` and `yVal`\n\t\t\t\t{\n\t\t\t\t\t// X-Axis is always the same\n\t\t\t\t\tstrXml += '<c:xVal>'\n\t\t\t\t\tstrXml += '  <c:numRef>'\n\t\t\t\t\tstrXml += '    <c:f>Sheet1!$A$2:$A$' + (data[0].values.length + 1) + '</c:f>'\n\t\t\t\t\tstrXml += '    <c:numCache>'\n\t\t\t\t\tstrXml += '      <c:formatCode>General</c:formatCode>'\n\t\t\t\t\tstrXml += '      <c:ptCount val=\"' + data[0].values.length + '\"/>'\n\t\t\t\t\tdata[0].values.forEach((value, idx) => {\n\t\t\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || value === 0 ? value : '') + '</c:v></c:pt>'\n\t\t\t\t\t})\n\t\t\t\t\tstrXml += '    </c:numCache>'\n\t\t\t\t\tstrXml += '  </c:numRef>'\n\t\t\t\t\tstrXml += '</c:xVal>'\n\n\t\t\t\t\t// Y-Axis vals are this object's `values`\n\t\t\t\t\tstrXml += '<c:yVal>'\n\t\t\t\t\tstrXml += '  <c:numRef>'\n\t\t\t\t\tstrXml += '    <c:f>Sheet1!$' + getExcelColName(idx + 1) + '$2:$' + getExcelColName(idx + 1) + '$' + (data[0].values.length + 1) + '</c:f>'\n\t\t\t\t\tstrXml += '    <c:numCache>'\n\t\t\t\t\tstrXml += '      <c:formatCode>General</c:formatCode>'\n\t\t\t\t\t// NOTE: Use pt count and iterate over data[0] (X-Axis) as user can have more values than data (eg: timeline where only first few months are populated)\n\t\t\t\t\tstrXml += '      <c:ptCount val=\"' + data[0].values.length + '\"/>'\n\t\t\t\t\tdata[0].values.forEach((_value, idx) => {\n\t\t\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (obj.values[idx] || obj.values[idx] === 0 ? obj.values[idx] : '') + '</c:v></c:pt>'\n\t\t\t\t\t})\n\t\t\t\t\tstrXml += '    </c:numCache>'\n\t\t\t\t\tstrXml += '  </c:numRef>'\n\t\t\t\t\tstrXml += '</c:yVal>'\n\t\t\t\t}\n\n\t\t\t\t// Option: `smooth`\n\t\t\t\tstrXml += '<c:smooth val=\"' + (opts.lineSmooth ? '1' : '0') + '\"/>'\n\n\t\t\t\t// 4: Close \"SERIES\"\n\t\t\t\tstrXml += '</c:ser>'\n\t\t\t})\n\n\t\t\t// 3: Data Labels\n\t\t\t{\n\t\t\t\tstrXml += '  <c:dLbls>'\n\t\t\t\tstrXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>'\n\t\t\t\tstrXml += '    <c:txPr>'\n\t\t\t\tstrXml += '      <a:bodyPr/>'\n\t\t\t\tstrXml += '      <a:lstStyle/>'\n\t\t\t\tstrXml += '      <a:p><a:pPr>'\n\t\t\t\tstrXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">'\n\t\t\t\tstrXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>'\n\t\t\t\tstrXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>'\n\t\t\t\tstrXml += '        </a:defRPr>'\n\t\t\t\tstrXml += '      </a:pPr></a:p>'\n\t\t\t\tstrXml += '    </c:txPr>'\n\t\t\t\tif (opts.dataLabelPosition) strXml += ' <c:dLblPos val=\"' + opts.dataLabelPosition + '\"/>'\n\t\t\t\tstrXml += '    <c:showLegendKey val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>'\n\t\t\t\tstrXml += '    <c:showCatName val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showSerName val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showPercent val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showBubbleSize val=\"0\"/>'\n\t\t\t\tstrXml += '  </c:dLbls>'\n\t\t\t}\n\n\t\t\t// 4: Add axisId (NOTE: order matters! (category comes first))\n\t\t\tstrXml += '  <c:axId val=\"' + catAxisId + '\"/>'\n\t\t\tstrXml += '  <c:axId val=\"' + valAxisId + '\"/>'\n\n\t\t\t// 5: Close Chart tag\n\t\t\tstrXml += '</c:' + chartType + 'Chart>'\n\n\t\t\t// end switch\n\t\t\tbreak\n\n\t\tcase CHART_TYPE.BUBBLE:\n\t\t\t/*\n\t\t\t\t`data` = [\n\t\t\t\t\t{ name:'X-Axis',     values:[1,2,3,4,5,6,7,8,9,10,11,12] },\n\t\t\t\t\t{ name:'Y-Values 1', values:[13, 20, 21, 25], sizes:[10, 5, 20, 15] },\n\t\t\t\t\t{ name:'Y-Values 2', values:[ 1,  2,  5,  9], sizes:[ 5, 3,  9,  3] }\n\t\t\t\t];\n\t\t\t*/\n\n\t\t\t// 1: Start Chart\n\t\t\tstrXml += '<c:' + chartType + 'Chart>'\n\t\t\tstrXml += '<c:varyColors val=\"0\"/>'\n\n\t\t\t// 2: Series: (One for each Y-Axis)\n\t\t\tcolorIndex = -1\n\t\t\tlet idxColLtr = 1\n\t\t\tdata.filter((_obj, idx) => idx > 0).forEach((obj, idx) => {\n\t\t\t\tcolorIndex++\n\t\t\t\tstrXml += '<c:ser>'\n\t\t\t\tstrXml += '  <c:idx val=\"' + idx + '\"/>'\n\t\t\t\tstrXml += '  <c:order val=\"' + idx + '\"/>'\n\n\t\t\t\t// A: `<c:tx>`\n\t\t\t\tstrXml += '  <c:tx>'\n\t\t\t\tstrXml += '    <c:strRef>'\n\t\t\t\tstrXml += '      <c:f>Sheet1!$' + LETTERS[idxColLtr] + '$1</c:f>'\n\t\t\t\tstrXml += '      <c:strCache><c:ptCount val=\"1\"/><c:pt idx=\"0\"><c:v>' + obj.name + '</c:v></c:pt></c:strCache>'\n\t\t\t\tstrXml += '    </c:strRef>'\n\t\t\t\tstrXml += '  </c:tx>'\n\n\t\t\t\t// B: '<c:spPr>': Fill, Border, Line, LineStyle (dash, etc.), Shadow\n\t\t\t\t{\n\t\t\t\t\tstrXml += '<c:spPr>'\n\n\t\t\t\t\tlet tmpSerColor = opts.chartColors[colorIndex % opts.chartColors.length]\n\n\t\t\t\t\tif (tmpSerColor === 'transparent') {\n\t\t\t\t\t\tstrXml += '<a:noFill/>'\n\t\t\t\t\t} else if (opts.chartColorsOpacity) {\n\t\t\t\t\t\tstrXml += '<a:solidFill>' + createColorElement(tmpSerColor, '<a:alpha val=\"' + opts.chartColorsOpacity + '000\"/>') + '</a:solidFill>'\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrXml += '<a:solidFill>' + createColorElement(tmpSerColor) + '</a:solidFill>'\n\t\t\t\t\t}\n\n\t\t\t\t\tif (opts.lineSize === 0) {\n\t\t\t\t\t\tstrXml += '<a:ln><a:noFill/></a:ln>'\n\t\t\t\t\t} else if (opts.dataBorder) {\n\t\t\t\t\t\tstrXml +=\n\t\t\t\t\t\t\t'<a:ln w=\"' +\n\t\t\t\t\t\t\tvalToPts(opts.dataBorder.pt) +\n\t\t\t\t\t\t\t'\" cap=\"flat\"><a:solidFill>' +\n\t\t\t\t\t\t\tcreateColorElement(opts.dataBorder.color) +\n\t\t\t\t\t\t\t'</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>'\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrXml += '<a:ln w=\"' + valToPts(opts.lineSize) + '\" cap=\"flat\"><a:solidFill>' + createColorElement(tmpSerColor) + '</a:solidFill>'\n\t\t\t\t\t\tstrXml += '<a:prstDash val=\"' + (opts.lineDash || 'solid') + '\"/><a:round/></a:ln>'\n\t\t\t\t\t}\n\n\t\t\t\t\t// Shadow\n\t\t\t\t\tstrXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW)\n\n\t\t\t\t\tstrXml += '</c:spPr>'\n\t\t\t\t}\n\n\t\t\t\t// C: '<c:dLbls>' \"Data Labels\"\n\t\t\t\t// Let it be defaulted for now\n\n\t\t\t\t// D: '<c:xVal>'/'<c:yVal>' \"Values\": Scatter Chart has 2: `xVal` and `yVal`\n\t\t\t\t{\n\t\t\t\t\t// X-Axis is always the same\n\t\t\t\t\tstrXml += '<c:xVal>'\n\t\t\t\t\tstrXml += '  <c:numRef>'\n\t\t\t\t\tstrXml += '    <c:f>Sheet1!$A$2:$A$' + (data[0].values.length + 1) + '</c:f>'\n\t\t\t\t\tstrXml += '    <c:numCache>'\n\t\t\t\t\tstrXml += '      <c:formatCode>General</c:formatCode>'\n\t\t\t\t\tstrXml += '      <c:ptCount val=\"' + data[0].values.length + '\"/>'\n\t\t\t\t\tdata[0].values.forEach((value, idx) => {\n\t\t\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || value === 0 ? value : '') + '</c:v></c:pt>'\n\t\t\t\t\t})\n\t\t\t\t\tstrXml += '    </c:numCache>'\n\t\t\t\t\tstrXml += '  </c:numRef>'\n\t\t\t\t\tstrXml += '</c:xVal>'\n\n\t\t\t\t\t// Y-Axis vals are this object's `values`\n\t\t\t\t\tstrXml += '<c:yVal>'\n\t\t\t\t\tstrXml += '  <c:numRef>'\n\t\t\t\t\tstrXml += '    <c:f>Sheet1!$' + getExcelColName(idxColLtr) + '$2:$' + getExcelColName(idxColLtr) + '$' + (data[0].values.length + 1) + '</c:f>'\n\t\t\t\t\tidxColLtr++\n\t\t\t\t\tstrXml += '    <c:numCache>'\n\t\t\t\t\tstrXml += '      <c:formatCode>General</c:formatCode>'\n\t\t\t\t\t// NOTE: Use pt count and iterate over data[0] (X-Axis) as user can have more values than data (eg: timeline where only first few months are populated)\n\t\t\t\t\tstrXml += '      <c:ptCount val=\"' + data[0].values.length + '\"/>'\n\t\t\t\t\tdata[0].values.forEach((_value, idx) => {\n\t\t\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (obj.values[idx] || obj.values[idx] === 0 ? obj.values[idx] : '') + '</c:v></c:pt>'\n\t\t\t\t\t})\n\t\t\t\t\tstrXml += '    </c:numCache>'\n\t\t\t\t\tstrXml += '  </c:numRef>'\n\t\t\t\t\tstrXml += '</c:yVal>'\n\t\t\t\t}\n\n\t\t\t\t// E: '<c:bubbleSize>'\n\t\t\t\tstrXml += '  <c:bubbleSize>'\n\t\t\t\tstrXml += '    <c:numRef>'\n\t\t\t\tstrXml += '      <c:f>Sheet1!$' + getExcelColName(idxColLtr) + '$2:$' + getExcelColName(idx + 2) + '$' + (obj.sizes.length + 1) + '</c:f>'\n\t\t\t\tidxColLtr++\n\t\t\t\tstrXml += '      <c:numCache>'\n\t\t\t\tstrXml += '        <c:formatCode>General</c:formatCode>'\n\t\t\t\tstrXml += '\t       <c:ptCount val=\"' + obj.sizes.length + '\"/>'\n\t\t\t\tobj.sizes.forEach((value, idx) => {\n\t\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || '') + '</c:v></c:pt>'\n\t\t\t\t})\n\t\t\t\tstrXml += '      </c:numCache>'\n\t\t\t\tstrXml += '    </c:numRef>'\n\t\t\t\tstrXml += '  </c:bubbleSize>'\n\t\t\t\tstrXml += '  <c:bubble3D val=\"0\"/>'\n\n\t\t\t\t// F: Close \"SERIES\"\n\t\t\t\tstrXml += '</c:ser>'\n\t\t\t})\n\n\t\t\t// 3: Data Labels\n\t\t\t{\n\t\t\t\tstrXml += '  <c:dLbls>'\n\t\t\t\tstrXml += '    <c:numFmt formatCode=\"' + opts.dataLabelFormatCode + '\" sourceLinked=\"0\"/>'\n\t\t\t\tstrXml += '    <c:txPr>'\n\t\t\t\tstrXml += '      <a:bodyPr/>'\n\t\t\t\tstrXml += '      <a:lstStyle/>'\n\t\t\t\tstrXml += '      <a:p><a:pPr>'\n\t\t\t\tstrXml += '        <a:defRPr b=\"0\" i=\"0\" strike=\"noStrike\" sz=\"' + (opts.dataLabelFontSize || DEF_FONT_SIZE) + '00\" u=\"none\">'\n\t\t\t\tstrXml += '          <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>'\n\t\t\t\tstrXml += '          <a:latin typeface=\"' + (opts.dataLabelFontFace || 'Arial') + '\"/>'\n\t\t\t\tstrXml += '        </a:defRPr>'\n\t\t\t\tstrXml += '      </a:pPr></a:p>'\n\t\t\t\tstrXml += '    </c:txPr>'\n\t\t\t\tif (opts.dataLabelPosition) strXml += ' <c:dLblPos val=\"' + opts.dataLabelPosition + '\"/>'\n\t\t\t\tstrXml += '    <c:showLegendKey val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>'\n\t\t\t\tstrXml += '    <c:showCatName val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showSerName val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showPercent val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showBubbleSize val=\"0\"/>'\n\t\t\t\tstrXml += '  </c:dLbls>'\n\t\t\t}\n\n\t\t\t// 4: Add bubble options\n\t\t\t//strXml += '  <c:bubbleScale val=\"100\"/>';\n\t\t\t//strXml += '  <c:showNegBubbles val=\"0\"/>';\n\t\t\t// Commented out to let it default to PPT until we create options\n\n\t\t\t// 5: Add axisId (NOTE: order matters! (category comes first))\n\t\t\tstrXml += '  <c:axId val=\"' + catAxisId + '\"/>'\n\t\t\tstrXml += '  <c:axId val=\"' + valAxisId + '\"/>'\n\n\t\t\t// 6: Close Chart tag\n\t\t\tstrXml += '</c:' + chartType + 'Chart>'\n\n\t\t\t// end switch\n\t\t\tbreak\n\n\t\tcase CHART_TYPE.DOUGHNUT:\n\t\tcase CHART_TYPE.PIE:\n\t\t\t// Use the same let name so code blocks from barChart are interchangeable\n\t\t\tlet obj = data[0]\n\n\t\t\t/* EX:\n\t\t\t\tdata: [\n\t\t\t\t {\n\t\t\t\t   name: 'Project Status',\n\t\t\t\t   labels: ['Red', 'Amber', 'Green', 'Unknown'],\n\t\t\t\t   values: [10, 20, 38, 2]\n\t\t\t\t }\n\t\t\t\t]\n\t\t\t*/\n\n\t\t\t// 1: Start Chart\n\t\t\tstrXml += '<c:' + chartType + 'Chart>'\n\t\t\tstrXml += '  <c:varyColors val=\"0\"/>'\n\t\t\tstrXml += '<c:ser>'\n\t\t\tstrXml += '  <c:idx val=\"0\"/>'\n\t\t\tstrXml += '  <c:order val=\"0\"/>'\n\t\t\tstrXml += '  <c:tx>'\n\t\t\tstrXml += '    <c:strRef>'\n\t\t\tstrXml += '      <c:f>Sheet1!$B$1</c:f>'\n\t\t\tstrXml += '      <c:strCache>'\n\t\t\tstrXml += '        <c:ptCount val=\"1\"/>'\n\t\t\tstrXml += '        <c:pt idx=\"0\"><c:v>' + encodeXmlEntities(obj.name) + '</c:v></c:pt>'\n\t\t\tstrXml += '      </c:strCache>'\n\t\t\tstrXml += '    </c:strRef>'\n\t\t\tstrXml += '  </c:tx>'\n\t\t\tstrXml += '  <c:spPr>'\n\t\t\tstrXml += '    <a:solidFill><a:schemeClr val=\"accent1\"/></a:solidFill>'\n\t\t\tstrXml += '    <a:ln w=\"9525\" cap=\"flat\"><a:solidFill><a:srgbClr val=\"F9F9F9\"/></a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>'\n\t\t\tif (opts.dataNoEffects) {\n\t\t\t\tstrXml += '<a:effectLst/>'\n\t\t\t} else {\n\t\t\t\tstrXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW)\n\t\t\t}\n\t\t\tstrXml += '  </c:spPr>'\n\t\t\t//strXml += '<c:explosion val=\"0\"/>'\n\n\t\t\t// 2: \"Data Point\" block for every data row\n\t\t\tobj.labels.forEach((_label, idx) => {\n\t\t\t\tstrXml += '<c:dPt>'\n\t\t\t\tstrXml += ` <c:idx val=\"${idx}\"/>`\n\t\t\t\tstrXml += ' <c:bubble3D val=\"0\"/>'\n\t\t\t\tstrXml += ' <c:spPr>'\n\t\t\t\tstrXml += `<a:solidFill>${createColorElement(\n\t\t\t\t\topts.chartColors[idx + 1 > opts.chartColors.length ? Math.floor(Math.random() * opts.chartColors.length) : idx]\n\t\t\t\t)}</a:solidFill>`\n\t\t\t\tif (opts.dataBorder) {\n\t\t\t\t\tstrXml += `<a:ln w=\"${valToPts(opts.dataBorder.pt)}\" cap=\"flat\"><a:solidFill>${createColorElement(\n\t\t\t\t\t\topts.dataBorder.color\n\t\t\t\t\t)}</a:solidFill><a:prstDash val=\"solid\"/><a:round/></a:ln>`\n\t\t\t\t}\n\t\t\t\tstrXml += createShadowElement(opts.shadow, DEF_SHAPE_SHADOW)\n\t\t\t\tstrXml += '  </c:spPr>'\n\t\t\t\tstrXml += '</c:dPt>'\n\t\t\t})\n\n\t\t\t// 3: \"Data Label\" block for every data Label\n\t\t\tstrXml += '<c:dLbls>'\n\t\t\tobj.labels.forEach((_label, idx) => {\n\t\t\t\tstrXml += '<c:dLbl>'\n\t\t\t\tstrXml += ` <c:idx val=\"${idx}\"/>`\n\t\t\t\tstrXml += `  <c:numFmt formatCode=\"${opts.dataLabelFormatCode || 'General'}\" sourceLinked=\"0\"/>`\n\t\t\t\tstrXml += '  <c:spPr/><c:txPr>'\n\t\t\t\tstrXml += '   <a:bodyPr/><a:lstStyle/>'\n\t\t\t\tstrXml += '   <a:p><a:pPr>'\n\t\t\t\tstrXml += `   <a:defRPr sz=\"${opts.dataLabelFontSize || DEF_FONT_SIZE}00\" b=\"${opts.dataLabelFontBold ? 1 : 0}\" i=\"0\" u=\"none\" strike=\"noStrike\">`\n\t\t\t\tstrXml += '    <a:solidFill>' + createColorElement(opts.dataLabelColor || DEF_FONT_COLOR) + '</a:solidFill>'\n\t\t\t\tstrXml += `    <a:latin typeface=\"${opts.dataLabelFontFace || 'Arial'}\"/>`\n\t\t\t\tstrXml += '   </a:defRPr>'\n\t\t\t\tstrXml += '      </a:pPr></a:p>'\n\t\t\t\tstrXml += '    </c:txPr>'\n\t\t\t\tif (chartType === CHART_TYPE.PIE) `<c:dLblPos val=\"${opts.dataLabelPosition || 'inEnd'}\"/>`\n\t\t\t\tstrXml += '    <c:showLegendKey val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showVal val=\"' + (opts.showValue ? '1' : '0') + '\"/>'\n\t\t\t\tstrXml += '    <c:showCatName val=\"' + (opts.showLabel ? '1' : '0') + '\"/>'\n\t\t\t\tstrXml += '    <c:showSerName val=\"0\"/>'\n\t\t\t\tstrXml += '    <c:showPercent val=\"' + (opts.showPercent ? '1' : '0') + '\"/>'\n\t\t\t\tstrXml += '    <c:showBubbleSize val=\"0\"/>'\n\t\t\t\tstrXml += '  </c:dLbl>'\n\t\t\t})\n\t\t\tstrXml += ` <c:numFmt formatCode=\"${opts.dataLabelFormatCode || 'General'}\" sourceLinked=\"0\"/>`\n\t\t\tstrXml += '\t<c:txPr>'\n\t\t\tstrXml += '\t  <a:bodyPr/>'\n\t\t\tstrXml += '\t  <a:lstStyle/>'\n\t\t\tstrXml += '\t  <a:p>'\n\t\t\tstrXml += '\t\t<a:pPr>'\n\t\t\tstrXml += '\t\t  <a:defRPr sz=\"1800\" b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\">'\n\t\t\tstrXml += '\t\t\t<a:solidFill><a:srgbClr val=\"000000\"/></a:solidFill><a:latin typeface=\"Arial\"/>'\n\t\t\tstrXml += '\t\t  </a:defRPr>'\n\t\t\tstrXml += '\t\t</a:pPr>'\n\t\t\tstrXml += '\t  </a:p>'\n\t\t\tstrXml += '\t</c:txPr>'\n\t\t\tstrXml += chartType === CHART_TYPE.PIE ? '<c:dLblPos val=\"ctr\"/>' : ''\n\t\t\tstrXml += '\t<c:showLegendKey val=\"0\"/>'\n\t\t\tstrXml += '\t<c:showVal val=\"0\"/>'\n\t\t\tstrXml += '\t<c:showCatName val=\"1\"/>'\n\t\t\tstrXml += '\t<c:showSerName val=\"0\"/>'\n\t\t\tstrXml += '\t<c:showPercent val=\"1\"/>'\n\t\t\tstrXml += '\t<c:showBubbleSize val=\"0\"/>'\n\t\t\tstrXml += ` <c:showLeaderLines val=\"${opts.showLeaderLines ? '1' : '0'}\"/>`\n\t\t\tstrXml += '</c:dLbls>'\n\n\t\t\t// 2: \"Categories\"\n\t\t\tstrXml += '<c:cat>'\n\t\t\tstrXml += '  <c:strRef>'\n\t\t\tstrXml += '    <c:f>Sheet1!$A$2:$A$' + (obj.labels.length + 1) + '</c:f>'\n\t\t\tstrXml += '    <c:strCache>'\n\t\t\tstrXml += '\t     <c:ptCount val=\"' + obj.labels.length + '\"/>'\n\t\t\tobj.labels.forEach((label, idx) => {\n\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + encodeXmlEntities(label) + '</c:v></c:pt>'\n\t\t\t})\n\t\t\tstrXml += '    </c:strCache>'\n\t\t\tstrXml += '  </c:strRef>'\n\t\t\tstrXml += '</c:cat>'\n\n\t\t\t// 3: Create vals\n\t\t\tstrXml += '  <c:val>'\n\t\t\tstrXml += '    <c:numRef>'\n\t\t\tstrXml += '      <c:f>Sheet1!$B$2:$B$' + (obj.labels.length + 1) + '</c:f>'\n\t\t\tstrXml += '      <c:numCache>'\n\t\t\tstrXml += '\t       <c:ptCount val=\"' + obj.labels.length + '\"/>'\n\t\t\tobj.values.forEach((value, idx) => {\n\t\t\t\tstrXml += '<c:pt idx=\"' + idx + '\"><c:v>' + (value || value === 0 ? value : '') + '</c:v></c:pt>'\n\t\t\t})\n\t\t\tstrXml += '      </c:numCache>'\n\t\t\tstrXml += '    </c:numRef>'\n\t\t\tstrXml += '  </c:val>'\n\n\t\t\t// 4: Close \"SERIES\"\n\t\t\tstrXml += '  </c:ser>'\n\t\t\tstrXml += '  <c:firstSliceAng val=\"0\"/>'\n\t\t\tif (chartType === CHART_TYPE.DOUGHNUT) strXml += '  <c:holeSize val=\"' + (opts.holeSize || 50) + '\"/>'\n\t\t\tstrXml += '</c:' + chartType + 'Chart>'\n\n\t\t\t// Done with Doughnut/Pie\n\t\t\tbreak\n\t\tdefault:\n\t\t\tstrXml += ''\n\t\t\tbreak\n\t}\n\n\treturn strXml\n}\n\n/**\n * Create Category axis\n * @param {IChartOptsLib} opts - chart options\n * @param {string} axisId - value\n * @param {string} valAxisId - value\n * @return {string} XML\n */\nfunction makeCatAxis(opts: IChartOptsLib, axisId: string, valAxisId: string): string {\n\tlet strXml = ''\n\n\t// Build cat axis tag\n\t// NOTE: Scatter and Bubble chart need two Val axises as they display numbers on x axis\n\tif (opts._type === CHART_TYPE.SCATTER || opts._type === CHART_TYPE.BUBBLE) {\n\t\tstrXml += '<c:valAx>'\n\t} else {\n\t\tstrXml += '<c:' + (opts.catLabelFormatCode ? 'dateAx' : 'catAx') + '>'\n\t}\n\tstrXml += '  <c:axId val=\"' + axisId + '\"/>'\n\tstrXml += '  <c:scaling>'\n\tstrXml += '<c:orientation val=\"' + (opts.catAxisOrientation || (opts.barDir === 'col' ? 'minMax' : 'minMax')) + '\"/>'\n\tif (opts.catAxisMaxVal || opts.catAxisMaxVal === 0) strXml += '<c:max val=\"' + opts.catAxisMaxVal + '\"/>'\n\tif (opts.catAxisMinVal || opts.catAxisMinVal === 0) strXml += '<c:min val=\"' + opts.catAxisMinVal + '\"/>'\n\tstrXml += '</c:scaling>'\n\tstrXml += '  <c:delete val=\"' + (opts.catAxisHidden ? 1 : 0) + '\"/>'\n\tstrXml += '  <c:axPos val=\"' + (opts.barDir === 'col' ? 'b' : 'l') + '\"/>'\n\tstrXml += opts.catGridLine.style !== 'none' ? createGridLineElement(opts.catGridLine) : ''\n\t// '<c:title>' comes between '</c:majorGridlines>' and '<c:numFmt>'\n\tif (opts.showCatAxisTitle) {\n\t\tstrXml += genXmlTitle({\n\t\t\tcolor: opts.catAxisTitleColor,\n\t\t\tfontFace: opts.catAxisTitleFontFace,\n\t\t\tfontSize: opts.catAxisTitleFontSize,\n\t\t\trotate: opts.catAxisTitleRotate,\n\t\t\ttitle: opts.catAxisTitle || 'Axis Title',\n\t\t})\n\t}\n\t// NOTE: Adding Val Axis Formatting if scatter or bubble charts\n\tif (opts._type === CHART_TYPE.SCATTER || opts._type === CHART_TYPE.BUBBLE) {\n\t\tstrXml += '  <c:numFmt formatCode=\"' + (opts.valAxisLabelFormatCode ? opts.valAxisLabelFormatCode : 'General') + '\" sourceLinked=\"0\"/>'\n\t} else {\n\t\tstrXml += '  <c:numFmt formatCode=\"' + (opts.catLabelFormatCode || 'General') + '\" sourceLinked=\"0\"/>'\n\t}\n\tif (opts._type === CHART_TYPE.SCATTER) {\n\t\tstrXml += '  <c:majorTickMark val=\"none\"/>'\n\t\tstrXml += '  <c:minorTickMark val=\"none\"/>'\n\t\tstrXml += '  <c:tickLblPos val=\"nextTo\"/>'\n\t} else {\n\t\tstrXml += '  <c:majorTickMark val=\"' + (opts.catAxisMajorTickMark || 'out') + '\"/>'\n\t\tstrXml += '  <c:minorTickMark val=\"' + (opts.catAxisMajorTickMark || 'none') + '\"/>'\n\t\tstrXml += '  <c:tickLblPos val=\"' + (opts.catAxisLabelPos || (opts.barDir === 'col' ? 'low' : 'nextTo')) + '\"/>'\n\t}\n\tstrXml += '  <c:spPr>'\n\tstrXml += '    <a:ln w=\"12700\" cap=\"flat\">'\n\tstrXml += opts.catAxisLineShow === false ? '<a:noFill/>' : '<a:solidFill><a:srgbClr val=\"' + DEF_CHART_GRIDLINE.color + '\"/></a:solidFill>'\n\tstrXml += '      <a:prstDash val=\"solid\"/>'\n\tstrXml += '      <a:round/>'\n\tstrXml += '    </a:ln>'\n\tstrXml += '  </c:spPr>'\n\tstrXml += '  <c:txPr>'\n\tstrXml += '    <a:bodyPr' + (opts.catAxisLabelRotate ? ' rot=\"' + convertRotationDegrees(opts.catAxisLabelRotate) + '\"' : '') + '/>' // don't specify rot 0 so we get the auto behavior\n\tstrXml += '    <a:lstStyle/>'\n\tstrXml += '    <a:p>'\n\tstrXml += '    <a:pPr>'\n\tstrXml += '    <a:defRPr sz=\"' + (opts.catAxisLabelFontSize || DEF_FONT_SIZE) + '00\" b=\"' + (opts.catAxisLabelFontBold ? 1 : 0) + '\" i=\"0\" u=\"none\" strike=\"noStrike\">'\n\tstrXml += '      <a:solidFill><a:srgbClr val=\"' + (opts.catAxisLabelColor || DEF_FONT_COLOR) + '\"/></a:solidFill>'\n\tstrXml += '      <a:latin typeface=\"' + (opts.catAxisLabelFontFace || 'Arial') + '\"/>'\n\tstrXml += '   </a:defRPr>'\n\tstrXml += '  </a:pPr>'\n\tstrXml += '  <a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\"/>'\n\tstrXml += '  </a:p>'\n\tstrXml += ' </c:txPr>'\n\tstrXml += ' <c:crossAx val=\"' + valAxisId + '\"/>'\n\tstrXml += ' <c:' + (typeof opts.valAxisCrossesAt === 'number' ? 'crossesAt' : 'crosses') + ' val=\"' + opts.valAxisCrossesAt + '\"/>'\n\tstrXml += ' <c:auto val=\"1\"/>'\n\tstrXml += ' <c:lblAlgn val=\"ctr\"/>'\n\tstrXml += ' <c:noMultiLvlLbl val=\"1\"/>'\n\tif (opts.catAxisLabelFrequency) strXml += ' <c:tickLblSkip val=\"' + opts.catAxisLabelFrequency + '\"/>'\n\n\t// Issue#149: PPT will auto-adjust these as needed after calcing the date bounds, so we only include them when specified by user\n\tif (opts.catLabelFormatCode) {\n\t\t;['catAxisBaseTimeUnit', 'catAxisMajorTimeUnit', 'catAxisMinorTimeUnit'].forEach(opt => {\n\t\t\t// Validate input as poorly chosen/garbage options will cause chart corruption and it wont render at all!\n\t\t\tif (opts[opt] && (typeof opts[opt] !== 'string' || ['days', 'months', 'years'].indexOf(opts[opt].toLowerCase()) === -1)) {\n\t\t\t\tconsole.warn('`' + opt + \"` must be one of: 'days','months','years' !\")\n\t\t\t\topts[opt] = null\n\t\t\t}\n\t\t})\n\t\tif (opts.catAxisBaseTimeUnit) strXml += '<c:baseTimeUnit val=\"' + opts.catAxisBaseTimeUnit.toLowerCase() + '\"/>'\n\t\tif (opts.catAxisMajorTimeUnit) strXml += '<c:majorTimeUnit val=\"' + opts.catAxisMajorTimeUnit.toLowerCase() + '\"/>'\n\t\tif (opts.catAxisMinorTimeUnit) strXml += '<c:minorTimeUnit val=\"' + opts.catAxisMinorTimeUnit.toLowerCase() + '\"/>'\n\t\tif (opts.catAxisMajorUnit) strXml += '<c:majorUnit val=\"' + opts.catAxisMajorUnit + '\"/>'\n\t\tif (opts.catAxisMinorUnit) strXml += '<c:minorUnit val=\"' + opts.catAxisMinorUnit + '\"/>'\n\t}\n\n\t// Close cat axis tag\n\t// NOTE: Added closing tag of val or cat axis based on chart type\n\tif (opts._type === CHART_TYPE.SCATTER || opts._type === CHART_TYPE.BUBBLE) {\n\t\tstrXml += '</c:valAx>'\n\t} else {\n\t\tstrXml += '</c:' + (opts.catLabelFormatCode ? 'dateAx' : 'catAx') + '>'\n\t}\n\n\treturn strXml\n}\n\n/**\n * Create Value Axis (Used by `bar3D`)\n * @param {IChartOptsLib} opts - chart options\n * @param {string} valAxisId - value\n * @return {string} XML\n */\nfunction makeValAxis(opts: IChartOptsLib, valAxisId: string): string {\n\tlet axisPos = valAxisId === AXIS_ID_VALUE_PRIMARY ? (opts.barDir === 'col' ? 'l' : 'b') : opts.barDir !== 'col' ? 'r' : 't'\n\tlet strXml = ''\n\tlet isRight = axisPos === 'r' || axisPos === 't'\n\tlet crosses = isRight ? 'max' : 'autoZero'\n\tlet crossAxId = valAxisId === AXIS_ID_VALUE_PRIMARY ? AXIS_ID_CATEGORY_PRIMARY : AXIS_ID_CATEGORY_SECONDARY\n\n\tstrXml += '<c:valAx>'\n\tstrXml += '  <c:axId val=\"' + valAxisId + '\"/>'\n\tstrXml += '  <c:scaling>'\n\tstrXml += '    <c:orientation val=\"' + (opts.valAxisOrientation || (opts.barDir === 'col' ? 'minMax' : 'minMax')) + '\"/>'\n\tif (opts.valAxisMaxVal || opts.valAxisMaxVal === 0) strXml += '<c:max val=\"' + opts.valAxisMaxVal + '\"/>'\n\tif (opts.valAxisMinVal || opts.valAxisMinVal === 0) strXml += '<c:min val=\"' + opts.valAxisMinVal + '\"/>'\n\tstrXml += '  </c:scaling>'\n\tstrXml += '  <c:delete val=\"' + (opts.valAxisHidden ? 1 : 0) + '\"/>'\n\tstrXml += '  <c:axPos val=\"' + axisPos + '\"/>'\n\tif (opts.valGridLine.style !== 'none') strXml += createGridLineElement(opts.valGridLine)\n\t// '<c:title>' comes between '</c:majorGridlines>' and '<c:numFmt>'\n\tif (opts.showValAxisTitle) {\n\t\tstrXml += genXmlTitle({\n\t\t\tcolor: opts.valAxisTitleColor,\n\t\t\tfontFace: opts.valAxisTitleFontFace,\n\t\t\tfontSize: opts.valAxisTitleFontSize,\n\t\t\trotate: opts.valAxisTitleRotate,\n\t\t\ttitle: opts.valAxisTitle || 'Axis Title',\n\t\t})\n\t}\n\tstrXml += ' <c:numFmt formatCode=\"' + (opts.valAxisLabelFormatCode ? opts.valAxisLabelFormatCode : 'General') + '\" sourceLinked=\"0\"/>'\n\tif (opts._type === CHART_TYPE.SCATTER) {\n\t\tstrXml += '  <c:majorTickMark val=\"none\"/>'\n\t\tstrXml += '  <c:minorTickMark val=\"none\"/>'\n\t\tstrXml += '  <c:tickLblPos val=\"nextTo\"/>'\n\t} else {\n\t\tstrXml += ' <c:majorTickMark val=\"' + (opts.valAxisMajorTickMark || 'out') + '\"/>'\n\t\tstrXml += ' <c:minorTickMark val=\"' + (opts.valAxisMinorTickMark || 'none') + '\"/>'\n\t\tstrXml += ' <c:tickLblPos val=\"' + (opts.valAxisLabelPos || (opts.barDir === 'col' ? 'nextTo' : 'low')) + '\"/>'\n\t}\n\tstrXml += ' <c:spPr>'\n\tstrXml += '   <a:ln w=\"12700\" cap=\"flat\">'\n\tstrXml += opts.valAxisLineShow === false ? '<a:noFill/>' : '<a:solidFill><a:srgbClr val=\"' + DEF_CHART_GRIDLINE.color + '\"/></a:solidFill>'\n\tstrXml += '     <a:prstDash val=\"solid\"/>'\n\tstrXml += '     <a:round/>'\n\tstrXml += '   </a:ln>'\n\tstrXml += ' </c:spPr>'\n\tstrXml += ' <c:txPr>'\n\tstrXml += '  <a:bodyPr ' + (opts.valAxisLabelRotate ? 'rot=\"' + convertRotationDegrees(opts.valAxisLabelRotate) + '\"' : '') + '/>' // don't specify rot 0 so we get the auto behavior\n\tstrXml += '  <a:lstStyle/>'\n\tstrXml += '  <a:p>'\n\tstrXml += '    <a:pPr>'\n\tstrXml += '      <a:defRPr sz=\"' + (opts.valAxisLabelFontSize || DEF_FONT_SIZE) + '00\" b=\"' + (opts.valAxisLabelFontBold ? 1 : 0) + '\" i=\"0\" u=\"none\" strike=\"noStrike\">'\n\tstrXml += '        <a:solidFill><a:srgbClr val=\"' + (opts.valAxisLabelColor || DEF_FONT_COLOR) + '\"/></a:solidFill>'\n\tstrXml += '        <a:latin typeface=\"' + (opts.valAxisLabelFontFace || 'Arial') + '\"/>'\n\tstrXml += '      </a:defRPr>'\n\tstrXml += '    </a:pPr>'\n\tstrXml += '  <a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\"/>'\n\tstrXml += '  </a:p>'\n\tstrXml += ' </c:txPr>'\n\tstrXml += ' <c:crossAx val=\"' + crossAxId + '\"/>'\n\tstrXml += ' <c:crosses val=\"' + crosses + '\"/>'\n\tstrXml +=\n\t\t' <c:crossBetween val=\"' +\n\t\t(opts._type === CHART_TYPE.SCATTER || (Array.isArray(opts._type) && opts._type.filter(type => type.type === CHART_TYPE.AREA).length > 0 ? true : false)\n\t\t\t? 'midCat'\n\t\t\t: 'between') +\n\t\t'\"/>'\n\tif (opts.valAxisMajorUnit) strXml += ' <c:majorUnit val=\"' + opts.valAxisMajorUnit + '\"/>'\n\tif (opts.valAxisDisplayUnit)\n\t\tstrXml += `<c:dispUnits><c:builtInUnit val=\"${opts.valAxisDisplayUnit}\"/>${opts.valAxisDisplayUnitLabel ? '<c:dispUnitsLbl/>' : ''}</c:dispUnits>`\n\n\tstrXml += '</c:valAx>'\n\n\treturn strXml\n}\n\n/**\n * Create Series Axis (Used by `bar3D`)\n * @param {IChartOptsLib} opts - chart options\n * @param {string} axisId - axis ID\n * @param {string} valAxisId - value\n * @return {string} XML\n */\nfunction makeSerAxis(opts: IChartOptsLib, axisId: string, valAxisId: string): string {\n\tlet strXml = ''\n\n\t// Build ser axis tag\n\tstrXml += '<c:serAx>'\n\tstrXml += '  <c:axId val=\"' + axisId + '\"/>'\n\tstrXml += '  <c:scaling><c:orientation val=\"' + (opts.serAxisOrientation || (opts.barDir === 'col' ? 'minMax' : 'minMax')) + '\"/></c:scaling>'\n\tstrXml += '  <c:delete val=\"' + (opts.serAxisHidden ? 1 : 0) + '\"/>'\n\tstrXml += '  <c:axPos val=\"' + (opts.barDir === 'col' ? 'b' : 'l') + '\"/>'\n\tstrXml += opts.serGridLine.style !== 'none' ? createGridLineElement(opts.serGridLine) : ''\n\t// '<c:title>' comes between '</c:majorGridlines>' and '<c:numFmt>'\n\tif (opts.showSerAxisTitle) {\n\t\tstrXml += genXmlTitle({\n\t\t\tcolor: opts.serAxisTitleColor,\n\t\t\tfontFace: opts.serAxisTitleFontFace,\n\t\t\tfontSize: opts.serAxisTitleFontSize,\n\t\t\trotate: opts.serAxisTitleRotate,\n\t\t\ttitle: opts.serAxisTitle || 'Axis Title',\n\t\t})\n\t}\n\tstrXml += '  <c:numFmt formatCode=\"' + (opts.serLabelFormatCode || 'General') + '\" sourceLinked=\"0\"/>'\n\tstrXml += '  <c:majorTickMark val=\"out\"/>'\n\tstrXml += '  <c:minorTickMark val=\"none\"/>'\n\tstrXml += '  <c:tickLblPos val=\"' + (opts.serAxisLabelPos || opts.barDir === 'col' ? 'low' : 'nextTo') + '\"/>'\n\tstrXml += '  <c:spPr>'\n\tstrXml += '    <a:ln w=\"12700\" cap=\"flat\">'\n\tstrXml += opts.serAxisLineShow === false ? '<a:noFill/>' : '<a:solidFill><a:srgbClr val=\"' + DEF_CHART_GRIDLINE.color + '\"/></a:solidFill>'\n\tstrXml += '      <a:prstDash val=\"solid\"/>'\n\tstrXml += '      <a:round/>'\n\tstrXml += '    </a:ln>'\n\tstrXml += '  </c:spPr>'\n\tstrXml += '  <c:txPr>'\n\tstrXml += '    <a:bodyPr/>' // don't specify rot 0 so we get the auto behavior\n\tstrXml += '    <a:lstStyle/>'\n\tstrXml += '    <a:p>'\n\tstrXml += '    <a:pPr>'\n\tstrXml += '    <a:defRPr sz=\"' + (opts.serAxisLabelFontSize || DEF_FONT_SIZE) + '00\" b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\">'\n\tstrXml += '      <a:solidFill><a:srgbClr val=\"' + (opts.serAxisLabelColor || DEF_FONT_COLOR) + '\"/></a:solidFill>'\n\tstrXml += '      <a:latin typeface=\"' + (opts.serAxisLabelFontFace || 'Arial') + '\"/>'\n\tstrXml += '   </a:defRPr>'\n\tstrXml += '  </a:pPr>'\n\tstrXml += '  <a:endParaRPr lang=\"' + (opts.lang || 'en-US') + '\"/>'\n\tstrXml += '  </a:p>'\n\tstrXml += ' </c:txPr>'\n\tstrXml += ' <c:crossAx val=\"' + valAxisId + '\"/>'\n\tstrXml += ' <c:crosses val=\"autoZero\"/>'\n\tif (opts.serAxisLabelFrequency) strXml += ' <c:tickLblSkip val=\"' + opts.serAxisLabelFrequency + '\"/>'\n\n\t// Issue#149: PPT will auto-adjust these as needed after calcing the date bounds, so we only include them when specified by user\n\tif (opts.serLabelFormatCode) {\n\t\t;['serAxisBaseTimeUnit', 'serAxisMajorTimeUnit', 'serAxisMinorTimeUnit'].forEach(opt => {\n\t\t\t// Validate input as poorly chosen/garbage options will cause chart corruption and it wont render at all!\n\t\t\tif (opts[opt] && (typeof opts[opt] !== 'string' || ['days', 'months', 'years'].indexOf(opt.toLowerCase()) === -1)) {\n\t\t\t\tconsole.warn('`' + opt + \"` must be one of: 'days','months','years' !\")\n\t\t\t\topts[opt] = null\n\t\t\t}\n\t\t})\n\t\tif (opts.serAxisBaseTimeUnit) strXml += ' <c:baseTimeUnit  val=\"' + opts.serAxisBaseTimeUnit.toLowerCase() + '\"/>'\n\t\tif (opts.serAxisMajorTimeUnit) strXml += ' <c:majorTimeUnit val=\"' + opts.serAxisMajorTimeUnit.toLowerCase() + '\"/>'\n\t\tif (opts.serAxisMinorTimeUnit) strXml += ' <c:minorTimeUnit val=\"' + opts.serAxisMinorTimeUnit.toLowerCase() + '\"/>'\n\t\tif (opts.serAxisMajorUnit) strXml += ' <c:majorUnit     val=\"' + opts.serAxisMajorUnit + '\"/>'\n\t\tif (opts.serAxisMinorUnit) strXml += ' <c:minorUnit     val=\"' + opts.serAxisMinorUnit + '\"/>'\n\t}\n\n\t// Close ser axis tag\n\tstrXml += '</c:serAx>'\n\n\treturn strXml\n}\n\n/**\n * Create char title elements\n * @param {IChartTitleOpts} opts - options\n * @return {string} XML `<c:title>`\n */\nfunction genXmlTitle(opts: IChartTitleOpts): string {\n\tlet align = opts.titleAlign === 'left' || opts.titleAlign === 'right' ? `<a:pPr algn=\"${opts.titleAlign.substring(0, 1)}\">` : `<a:pPr>`\n\tlet rotate = opts.rotate ? `<a:bodyPr rot=\"${convertRotationDegrees(opts.rotate)}\"/>` : `<a:bodyPr/>` // don't specify rotation to get default (ex. vertical for cat axis)\n\tlet sizeAttr = opts.fontSize ? 'sz=\"' + Math.round(opts.fontSize) + '00\"' : '' // only set the font size if specified.  Powerpoint will handle the default size\n\tlet layout =\n\t\topts.titlePos && opts.titlePos.x && opts.titlePos.y\n\t\t\t? `<c:layout><c:manualLayout><c:xMode val=\"edge\"/><c:yMode val=\"edge\"/><c:x val=\"${opts.titlePos.x}\"/><c:y val=\"${opts.titlePos.y}\"/></c:manualLayout></c:layout>`\n\t\t\t: `<c:layout/>`\n\n\treturn `<c:title>\n\t  <c:tx>\n\t    <c:rich>\n\t      ${rotate}\n\t      <a:lstStyle/>\n\t      <a:p>\n\t        ${align}\n\t        <a:defRPr ${sizeAttr} b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\">\n\t          <a:solidFill><a:srgbClr val=\"${opts.color || DEF_FONT_COLOR}\"/></a:solidFill>\n\t          <a:latin typeface=\"${opts.fontFace || 'Arial'}\"/>\n\t        </a:defRPr>\n\t      </a:pPr>\n\t      <a:r>\n\t        <a:rPr ${sizeAttr} b=\"0\" i=\"0\" u=\"none\" strike=\"noStrike\">\n\t          <a:solidFill><a:srgbClr val=\"${opts.color || DEF_FONT_COLOR}\"/></a:solidFill>\n\t          <a:latin typeface=\"${opts.fontFace || 'Arial'}\"/>\n\t        </a:rPr>\n\t        <a:t>${encodeXmlEntities(opts.title) || ''}</a:t>\n\t      </a:r>\n\t    </a:p>\n\t    </c:rich>\n\t  </c:tx>\n\t  ${layout}\n\t  <c:overlay val=\"0\"/>\n\t</c:title>`\n}\n\n/**\n * Calc and return excel column name for a given column length\n * @param {number} length - col length\n * @return {string} column name (ex: 'A2')\n */\nfunction getExcelColName(length: number): string {\n\tlet strName = ''\n\n\tif (length <= 26) {\n\t\tstrName = LETTERS[length]\n\t} else {\n\t\tstrName += LETTERS[Math.floor(length / LETTERS.length) - 1]\n\t\tstrName += LETTERS[length % LETTERS.length]\n\t}\n\n\treturn strName\n}\n\n/**\n * Creates `a:innerShdw` or `a:outerShdw` depending on pass options `opts`.\n * @param {Object} opts optional shadow properties\n * @param {Object} defaults defaults for unspecified properties in `opts`\n * @see http://officeopenxml.com/drwSp-effects.php\n * @example { type: 'outer', blur: 3, offset: (23000 / 12700), angle: 90, color: '000000', opacity: 0.35, rotateWithShape: true };\n * @return {string} XML\n */\nfunction createShadowElement(options: ShadowProps, defaults: object): string {\n\tif (!options) {\n\t\treturn '<a:effectLst/>'\n\t} else if (typeof options !== 'object') {\n\t\tconsole.warn(\"`shadow` options must be an object. Ex: `{shadow: {type:'none'}}`\")\n\t\treturn '<a:effectLst/>'\n\t}\n\n\tlet strXml = '<a:effectLst>',\n\t\topts = getMix(defaults, options),\n\t\ttype = opts['type'] || 'outer',\n\t\tblur = valToPts(opts['blur']),\n\t\toffset = valToPts(opts['offset']),\n\t\tangle = opts['angle'] * 60000,\n\t\tcolor = opts['color'],\n\t\topacity = opts['opacity'] * 100000,\n\t\trotateWithShape = opts['rotateWithShape'] ? 1 : 0\n\n\tstrXml += '<a:' + type + 'Shdw sx=\"100000\" sy=\"100000\" kx=\"0\" ky=\"0\"  algn=\"bl\" blurRad=\"' + blur + '\" '\n\tstrXml += 'rotWithShape=\"' + +rotateWithShape + '\"'\n\tstrXml += ' dist=\"' + offset + '\" dir=\"' + angle + '\">'\n\tstrXml += '<a:srgbClr val=\"' + color + '\">'\n\tstrXml += '<a:alpha val=\"' + opacity + '\"/></a:srgbClr>'\n\tstrXml += '</a:' + type + 'Shdw>'\n\tstrXml += '</a:effectLst>'\n\n\treturn strXml\n}\n\n/**\n * Create Grid Line Element\n * @param {OptsChartGridLine} glOpts {size, color, style}\n * @return {string} XML\n */\nfunction createGridLineElement(glOpts: OptsChartGridLine): string {\n\tlet strXml: string = '<c:majorGridlines>'\n\tstrXml += ' <c:spPr>'\n\tstrXml += '  <a:ln w=\"' + valToPts(glOpts.size || DEF_CHART_GRIDLINE.size) + '\" cap=\"flat\">'\n\tstrXml += '  <a:solidFill><a:srgbClr val=\"' + (glOpts.color || DEF_CHART_GRIDLINE.color) + '\"/></a:solidFill>' // should accept scheme colors as implemented in [Pull #135]\n\tstrXml += '   <a:prstDash val=\"' + (glOpts.style || DEF_CHART_GRIDLINE.style) + '\"/><a:round/>'\n\tstrXml += '  </a:ln>'\n\tstrXml += ' </c:spPr>'\n\tstrXml += '</c:majorGridlines>'\n\n\treturn strXml\n}\n","/**\n * PptxGenJS: Media Methods\n */\n\nimport { IMG_BROKEN } from './core-enums'\nimport { PresSlide, SlideLayout, ISlideRelMedia } from './core-interfaces'\n\n/**\n * Encode Image/Audio/Video into base64\n * @param {PresSlide | SlideLayout} layout - slide layout\n * @return {Promise} promise\n */\nexport function encodeSlideMediaRels(layout: PresSlide | SlideLayout): Promise<string>[] {\n\tconst fs = typeof require !== 'undefined' && typeof window === 'undefined' ? require('fs') : null // NodeJS\n\tconst https = typeof require !== 'undefined' && typeof window === 'undefined' ? require('https') : null // NodeJS\n\tlet imageProms: Promise<string>[] = []\n\n\t// A: Read/Encode each audio/image/video thats not already encoded (eg: base64 provided by user)\n\tlayout._relsMedia\n\t\t.filter(rel => rel.type !== 'online' && !rel.data && (!rel.path || (rel.path && rel.path.indexOf('preencoded') === -1)))\n\t\t.forEach(rel => {\n\t\t\timageProms.push(\n\t\t\t\tnew Promise((resolve, reject) => {\n\t\t\t\t\tif (fs && rel.path.indexOf('http') !== 0) {\n\t\t\t\t\t\t// DESIGN: Node local-file encoding is syncronous, so we can load all images here, then call export with a callback (if any)\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tlet bitmap = fs.readFileSync(rel.path)\n\t\t\t\t\t\t\trel.data = Buffer.from(bitmap).toString('base64')\n\t\t\t\t\t\t\tresolve('done')\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\trel.data = IMG_BROKEN\n\t\t\t\t\t\t\treject('ERROR: Unable to read media: \"' + rel.path + '\"\\n' + ex.toString())\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (fs && https && rel.path.indexOf('http') === 0) {\n\t\t\t\t\t\thttps.get(rel.path, res => {\n\t\t\t\t\t\t\tlet rawData = ''\n\t\t\t\t\t\t\tres.setEncoding('binary') // IMPORTANT: Only binary encoding works\n\t\t\t\t\t\t\tres.on('data', chunk => (rawData += chunk))\n\t\t\t\t\t\t\tres.on('end', () => {\n\t\t\t\t\t\t\t\trel.data = Buffer.from(rawData, 'binary').toString('base64')\n\t\t\t\t\t\t\t\tresolve('done')\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tres.on('error', ex => {\n\t\t\t\t\t\t\t\trel.data = IMG_BROKEN\n\t\t\t\t\t\t\t\treject(`ERROR! Unable to load image (https.get): ${rel.path}`)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// A: Declare XHR and onload/onerror handlers\n\t\t\t\t\t\t// DESIGN: `XMLHttpRequest()` plus `FileReader()` = Ablity to read any file into base64!\n\t\t\t\t\t\tlet xhr = new XMLHttpRequest()\n\t\t\t\t\t\txhr.onload = () => {\n\t\t\t\t\t\t\tlet reader = new FileReader()\n\t\t\t\t\t\t\treader.onloadend = () => {\n\t\t\t\t\t\t\t\trel.data = reader.result\n\t\t\t\t\t\t\t\tif (!rel.isSvgPng) {\n\t\t\t\t\t\t\t\t\tresolve('done')\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcreateSvgPngPreview(rel)\n\t\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\t\tresolve('done')\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t.catch(ex => {\n\t\t\t\t\t\t\t\t\t\t\treject(ex)\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treader.readAsDataURL(xhr.response)\n\t\t\t\t\t\t}\n\t\t\t\t\t\txhr.onerror = ex => {\n\t\t\t\t\t\t\trel.data = IMG_BROKEN\n\t\t\t\t\t\t\treject(`ERROR! Unable to load image (xhr.onerror): ${rel.path}`)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// B: Execute request\n\t\t\t\t\t\txhr.open('GET', rel.path)\n\t\t\t\t\t\txhr.responseType = 'blob'\n\t\t\t\t\t\txhr.send()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t)\n\t\t})\n\n\t// B: SVG: base64 data still requires a png to be generated (`isSvgPng` flag this as the preview image, not the SVG itself)\n\tlayout._relsMedia\n\t\t.filter(rel => rel.isSvgPng && rel.data)\n\t\t.forEach(rel => {\n\t\t\tif (fs) {\n\t\t\t\t//console.log('Sorry, SVG is not supported in Node (more info: https://github.com/gitbrent/PptxGenJS/issues/401)')\n\t\t\t\trel.data = IMG_BROKEN\n\t\t\t\timageProms.push(Promise.resolve().then(() => 'done'))\n\t\t\t} else {\n\t\t\t\timageProms.push(createSvgPngPreview(rel))\n\t\t\t}\n\t\t})\n\n\treturn imageProms\n}\n\n/**\n * Create SVG preview image\n * @param {ISlideRelMedia} rel - slide rel\n * @return {Promise} promise\n */\nfunction createSvgPngPreview(rel: ISlideRelMedia): Promise<string> {\n\treturn new Promise((resolve, reject) => {\n\t\t// A: Create\n\t\tlet image = new Image()\n\n\t\t// B: Set onload event\n\t\timage.onload = () => {\n\t\t\t// First: Check for any errors: This is the best method (try/catch wont work, etc.)\n\t\t\tif (image.width + image.height === 0) {\n\t\t\t\timage.onerror('h/w=0')\n\t\t\t}\n\t\t\tlet canvas: HTMLCanvasElement = document.createElement('CANVAS') as HTMLCanvasElement\n\t\t\tlet ctx = canvas.getContext('2d')\n\t\t\tcanvas.width = image.width\n\t\t\tcanvas.height = image.height\n\t\t\tctx.drawImage(image, 0, 0)\n\t\t\t// Users running on local machine will get the following error:\n\t\t\t// \"SecurityError: Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported.\"\n\t\t\t// when the canvas.toDataURL call executes below.\n\t\t\ttry {\n\t\t\t\trel.data = canvas.toDataURL(rel.type)\n\t\t\t\tresolve('done')\n\t\t\t} catch (ex) {\n\t\t\t\timage.onerror(ex)\n\t\t\t}\n\t\t\tcanvas = null\n\t\t}\n\t\timage.onerror = ex => {\n\t\t\trel.data = IMG_BROKEN\n\t\t\treject(`ERROR! Unable to load image (image.onerror): ${rel.path}`)\n\t\t}\n\n\t\t// C: Load image\n\t\timage.src = typeof rel.data === 'string' ? rel.data : IMG_BROKEN\n\t})\n}\n\n/**\n * FIXME: TODO: currently unused\n * TODO: Should return a Promise\n */\nfunction getSizeFromImage(inImgUrl: string): { width: number; height: number } {\n\tconst sizeOf = typeof require !== 'undefined' ? require('sizeof') : null // NodeJS\n\n\tif (sizeOf) {\n\t\ttry {\n\t\t\tlet dimensions = sizeOf(inImgUrl)\n\t\t\treturn { width: dimensions.width, height: dimensions.height }\n\t\t} catch (ex) {\n\t\t\tconsole.error('ERROR: sizeOf: Unable to load image: ' + inImgUrl)\n\t\t\treturn { width: 0, height: 0 }\n\t\t}\n\t} else if (Image && typeof Image === 'function') {\n\t\t// A: Create\n\t\tlet image = new Image()\n\n\t\t// B: Set onload event\n\t\timage.onload = () => {\n\t\t\t// FIRST: Check for any errors: This is the best method (try/catch wont work, etc.)\n\t\t\tif (image.width + image.height === 0) {\n\t\t\t\treturn { width: 0, height: 0 }\n\t\t\t}\n\t\t\tlet obj = { width: image.width, height: image.height }\n\t\t\treturn obj\n\t\t}\n\t\timage.onerror = () => {\n\t\t\tconsole.error(`ERROR: image.onload: Unable to load image: ${inImgUrl}`)\n\t\t}\n\n\t\t// C: Load image\n\t\timage.src = inImgUrl\n\t}\n}\n","/*\\\n|*|  :: pptxgen.ts ::\n|*|\n|*|  JavaScript framework that creates PowerPoint (pptx) presentations\n|*|  https://github.com/gitbrent/PptxGenJS\n|*|\n|*|  This framework is released under the MIT Public License (MIT)\n|*|\n|*|  PptxGenJS (C) 2015-2020 Brent Ely -- https://github.com/gitbrent\n|*|\n|*|  Some code derived from the OfficeGen project:\n|*|  github.com/Ziv-Barber/officegen/ (Copyright 2013 Ziv Barber)\n|*|\n|*|  Permission is hereby granted, free of charge, to any person obtaining a copy\n|*|  of this software and associated documentation files (the \"Software\"), to deal\n|*|  in the Software without restriction, including without limitation the rights\n|*|  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n|*|  copies of the Software, and to permit persons to whom the Software is\n|*|  furnished to do so, subject to the following conditions:\n|*|\n|*|  The above copyright notice and this permission notice shall be included in all\n|*|  copies or substantial portions of the Software.\n|*|\n|*|  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n|*|  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n|*|  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n|*|  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n|*|  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n|*|  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n|*|  SOFTWARE.\n\\*/\n\n/**\n * Units of Measure used in PowerPoint documents\n *\n * PowerPoint units are in `DXA` (except for font sizing)\n * - 1 inch is 1440 DXA\n * - 1 inch is 72 points\n * - 1 DXA is 1/20th's of a point\n * - 20 DXA is 1 point\n *\n * Another form of measurement using is an `EMU`\n * - 914400 EMUs is 1 inch\n * 12700 EMUs is 1 point\n *\n * @see https://startbigthinksmall.wordpress.com/2010/01/04/points-inches-and-emus-measuring-units-in-office-open-xml/\n */\n\n/**\n * Object Layouts\n *\n * - 16x9 (10\" x 5.625\")\n * - 16x10 (10\" x 6.25\")\n * - 4x3 (10\" x 7.5\")\n * - Wide (13.33\" x 7.5\")\n * - [custom] (any size)\n *\n * @see https://docs.microsoft.com/en-us/office/open-xml/structure-of-a-presentationml-document\n * @see https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2010/hh273476(v=office.14)\n */\n\nimport * as JSZip from 'jszip'\nimport Slide from './slide'\nimport {\n\tAlignH,\n\tAlignV,\n\tCHART_TYPE,\n\tChartType,\n\tDEF_PRES_LAYOUT,\n\tDEF_PRES_LAYOUT_NAME,\n\tDEF_SLIDE_MARGIN_IN,\n\tEMU,\n\tJSZIP_OUTPUT_TYPE,\n\tOutputType,\n\tSCHEME_COLOR_NAMES,\n\tSHAPE_TYPE,\n\tSchemeColor,\n\tShapeType,\n\tWRITE_OUTPUT_TYPE,\n} from './core-enums'\nimport { AddSlideProps, IPresentationProps, PresLayout, PresSlide, SectionProps, SlideLayout, SlideMasterProps, SlideNumberProps, TableToSlidesProps } from './core-interfaces'\nimport * as genCharts from './gen-charts'\nimport * as genObj from './gen-objects'\nimport * as genMedia from './gen-media'\nimport * as genTable from './gen-tables'\nimport * as genXml from './gen-xml'\n\nconst VERSION = '3.4.0-beta-20201011-1607'\n\nexport default class PptxGenJS implements IPresentationProps {\n\t// Property getters/setters\n\n\t/**\n\t * Presentation layout name\n\t * Standard layouts:\n\t * - 'LAYOUT_4x3'   (10\"    x 7.5\")\n\t * - 'LAYOUT_16x9'  (10\"    x 5.625\")\n\t * - 'LAYOUT_16x10' (10\"    x 6.25\")\n\t * - 'LAYOUT_WIDE'  (13.33\" x 7.5\")\n\t * Custom layouts:\n\t * Use `pptx.defineLayout()` to create custom layouts (e.g.: 'A4')\n\t * @type {string}\n\t * @see https://support.office.com/en-us/article/Change-the-size-of-your-slides-040a811c-be43-40b9-8d04-0de5ed79987e\n\t */\n\tprivate _layout: string\n\tpublic set layout(value: string) {\n\t\tlet newLayout: PresLayout = this.LAYOUTS[value]\n\n\t\tif (newLayout) {\n\t\t\tthis._layout = value\n\t\t\tthis._presLayout = newLayout\n\t\t} else {\n\t\t\tthrow new Error('UNKNOWN-LAYOUT')\n\t\t}\n\t}\n\tpublic get layout(): string {\n\t\treturn this._layout\n\t}\n\n\t/**\n\t * PptxGenJS Library Version\n\t */\n\tprivate _version: string = VERSION\n\tpublic get version(): string {\n\t\treturn this._version\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tprivate _author: string\n\tpublic set author(value: string) {\n\t\tthis._author = value\n\t}\n\tpublic get author(): string {\n\t\treturn this._author\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tprivate _company: string\n\tpublic set company(value: string) {\n\t\tthis._company = value\n\t}\n\tpublic get company(): string {\n\t\treturn this._company\n\t}\n\n\t/**\n\t * @type {string}\n\t * @note the `revision` value must be a whole number only (without \".\" or \",\" - otherwise, PPT will throw errors upon opening!)\n\t */\n\tprivate _revision: string\n\tpublic set revision(value: string) {\n\t\tthis._revision = value\n\t}\n\tpublic get revision(): string {\n\t\treturn this._revision\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tprivate _subject: string\n\tpublic set subject(value: string) {\n\t\tthis._subject = value\n\t}\n\tpublic get subject(): string {\n\t\treturn this._subject\n\t}\n\n\t/**\n\t * @type {string}\n\t */\n\tprivate _title: string\n\tpublic set title(value: string) {\n\t\tthis._title = value\n\t}\n\tpublic get title(): string {\n\t\treturn this._title\n\t}\n\n\t/**\n\t * Whether Right-to-Left (RTL) mode is enabled\n\t * @type {boolean}\n\t */\n\tprivate _rtlMode: boolean\n\tpublic set rtlMode(value: boolean) {\n\t\tthis._rtlMode = value\n\t}\n\tpublic get rtlMode(): boolean {\n\t\treturn this._rtlMode\n\t}\n\n\t/** master slide layout object */\n\tprivate _masterSlide: PresSlide\n\tpublic get masterSlide(): PresSlide {\n\t\treturn this._masterSlide\n\t}\n\n\t/** this Presentation's Slide objects */\n\tprivate _slides: PresSlide[]\n\tpublic get slides(): PresSlide[] {\n\t\treturn this._slides\n\t}\n\n\t/** this Presentation's sections */\n\tprivate _sections: SectionProps[]\n\tpublic get sections(): SectionProps[] {\n\t\treturn this._sections\n\t}\n\n\t/** slide layout definition objects, used for generating slide layout files */\n\tprivate _slideLayouts: SlideLayout[]\n\tpublic get slideLayouts(): SlideLayout[] {\n\t\treturn this._slideLayouts\n\t}\n\n\tprivate LAYOUTS: { [key: string]: PresLayout }\n\n\t// Exposed class props\n\tprivate _alignH = AlignH\n\tpublic get AlignH(): typeof AlignH {\n\t\treturn this._alignH\n\t}\n\tprivate _alignV = AlignV\n\tpublic get AlignV(): typeof AlignV {\n\t\treturn this._alignV\n\t}\n\tprivate _chartType = ChartType\n\tpublic get ChartType(): typeof ChartType {\n\t\treturn this._chartType\n\t}\n\tprivate _outputType = OutputType\n\tpublic get OutputType(): typeof OutputType {\n\t\treturn this._outputType\n\t}\n\tprivate _presLayout: PresLayout\n\tpublic get presLayout(): PresLayout {\n\t\treturn this._presLayout\n\t}\n\tprivate _schemeColor = SchemeColor\n\tpublic get SchemeColor(): typeof SchemeColor {\n\t\treturn this._schemeColor\n\t}\n\tprivate _shapeType = ShapeType\n\tpublic get ShapeType(): typeof ShapeType {\n\t\treturn this._shapeType\n\t}\n\n\t/**\n\t * @depricated use `ChartType`\n\t */\n\tprivate _charts = CHART_TYPE\n\tpublic get charts(): typeof CHART_TYPE {\n\t\treturn this._charts\n\t}\n\t/**\n\t * @depricated use `SchemeColor`\n\t */\n\tprivate _colors = SCHEME_COLOR_NAMES\n\tpublic get colors(): typeof SCHEME_COLOR_NAMES {\n\t\treturn this._colors\n\t}\n\t/**\n\t * @depricated use `ShapeType`\n\t */\n\tprivate _shapes = SHAPE_TYPE\n\tpublic get shapes(): typeof SHAPE_TYPE {\n\t\treturn this._shapes\n\t}\n\n\tconstructor() {\n\t\t// Set available layouts\n\t\tthis.LAYOUTS = {\n\t\t\tLAYOUT_4x3: { name: 'screen4x3', width: 9144000, height: 6858000 } as PresLayout,\n\t\t\tLAYOUT_16x9: { name: 'screen16x9', width: 9144000, height: 5143500 } as PresLayout,\n\t\t\tLAYOUT_16x10: { name: 'screen16x10', width: 9144000, height: 5715000 } as PresLayout,\n\t\t\tLAYOUT_WIDE: { name: 'custom', width: 12192000, height: 6858000 } as PresLayout,\n\t\t}\n\n\t\t// Core\n\t\tthis._author = 'PptxGenJS'\n\t\tthis._company = 'PptxGenJS'\n\t\tthis._revision = '1' // Note: Must be a whole number\n\t\tthis._subject = 'PptxGenJS Presentation'\n\t\tthis._title = 'PptxGenJS Presentation'\n\t\t// PptxGenJS props\n\t\tthis._presLayout = {\n\t\t\tname: this.LAYOUTS[DEF_PRES_LAYOUT].name,\n\t\t\t_sizeW: this.LAYOUTS[DEF_PRES_LAYOUT].width,\n\t\t\t_sizeH: this.LAYOUTS[DEF_PRES_LAYOUT].height,\n\t\t\twidth: this.LAYOUTS[DEF_PRES_LAYOUT].width,\n\t\t\theight: this.LAYOUTS[DEF_PRES_LAYOUT].height,\n\t\t}\n\t\tthis._rtlMode = false\n\t\t//\n\t\tthis._slideLayouts = [\n\t\t\t{\n\t\t\t\t_margin: DEF_SLIDE_MARGIN_IN,\n\t\t\t\t_name: DEF_PRES_LAYOUT_NAME,\n\t\t\t\t_presLayout: this._presLayout,\n\t\t\t\t_rels: [],\n\t\t\t\t_relsChart: [],\n\t\t\t\t_relsMedia: [],\n\t\t\t\t_slide: null,\n\t\t\t\t_slideNum: 1000,\n\t\t\t\t_slideNumberProps: null,\n\t\t\t\t_slideObjects: [],\n\t\t\t},\n\t\t]\n\t\tthis._slides = []\n\t\tthis._sections = []\n\t\tthis._masterSlide = {\n\t\t\taddChart: null,\n\t\t\taddImage: null,\n\t\t\taddMedia: null,\n\t\t\taddNotes: null,\n\t\t\taddShape: null,\n\t\t\taddTable: null,\n\t\t\taddText: null,\n\t\t\t//\n\t\t\t_name: null,\n\t\t\t_presLayout: this._presLayout,\n\t\t\t_rId: null,\n\t\t\t_rels: [],\n\t\t\t_relsChart: [],\n\t\t\t_relsMedia: [],\n\t\t\t_slideId: null,\n\t\t\t_slideLayout: null,\n\t\t\t_slideNum: null,\n\t\t\t_slideNumberProps: null,\n\t\t\t_slideObjects: [],\n\t\t}\n\t}\n\n\t/**\n\t * Provides an API for `addTableDefinition` to create slides as needed for auto-paging\n\t * @param {string} masterName - slide master name\n\t * @return {PresSlide} new Slide\n\t */\n\tprivate addNewSlide = (masterName: string): PresSlide => {\n\t\t// Continue using sections if the first slide using auto-paging has a Section\n\t\tlet sectAlreadyInUse =\n\t\t\tthis.sections.length > 0 &&\n\t\t\tthis.sections[this.sections.length - 1]._slides.filter(slide => slide._slideNum === this.slides[this.slides.length - 1]._slideNum).length > 0\n\n\t\treturn this.addSlide({\n\t\t\tmasterName: masterName,\n\t\t\tsectionTitle: sectAlreadyInUse ? this.sections[this.sections.length - 1].title : null,\n\t\t})\n\t}\n\n\t/**\n\t * Provides an API for `addTableDefinition` to get slide reference by number\n\t * @param {number} slideNum - slide number\n\t * @return {PresSlide} Slide\n\t * @since 3.0.0\n\t */\n\tprivate getSlide = (slideNum: number): PresSlide => this.slides.filter(slide => slide._slideNum === slideNum)[0]\n\n\t/**\n\t * Enables the `Slide` class to set PptxGenJS [Presentation] master/layout slidenumbers\n\t * @param {SlideNumberProps} slideNum - slide number config\n\t */\n\tprivate setSlideNumber = (slideNum: SlideNumberProps) => {\n\t\t// 1: Add slideNumber to slideMaster1.xml\n\t\tthis.masterSlide._slideNumberProps = slideNum\n\n\t\t// 2: Add slideNumber to DEF_PRES_LAYOUT_NAME layout\n\t\tthis.slideLayouts.filter(layout => layout._name === DEF_PRES_LAYOUT_NAME)[0]._slideNumberProps = slideNum\n\t}\n\n\t/**\n\t * Create all chart and media rels for this Presentation\n\t * @param {PresSlide | SlideLayout} slide - slide with rels\n\t * @param {JSZip} zip - JSZip instance\n\t * @param {Promise<any>[]} chartPromises - promise array\n\t */\n\tprivate createChartMediaRels = (slide: PresSlide | SlideLayout, zip: JSZip, chartPromises: Promise<any>[]) => {\n\t\tslide._relsChart.forEach(rel => chartPromises.push(genCharts.createExcelWorksheet(rel, zip)))\n\t\tslide._relsMedia.forEach(rel => {\n\t\t\tif (rel.type !== 'online' && rel.type !== 'hyperlink') {\n\t\t\t\t// A: Loop vars\n\t\t\t\tlet data: string = rel.data && typeof rel.data === 'string' ? rel.data : ''\n\n\t\t\t\t// B: Users will undoubtedly pass various string formats, so correct prefixes as needed\n\t\t\t\tif (data.indexOf(',') === -1 && data.indexOf(';') === -1) data = 'image/png;base64,' + data\n\t\t\t\telse if (data.indexOf(',') === -1) data = 'image/png;base64,' + data\n\t\t\t\telse if (data.indexOf(';') === -1) data = 'image/png;' + data\n\n\t\t\t\t// C: Add media\n\t\t\t\tzip.file(rel.Target.replace('..', 'ppt'), data.split(',').pop(), { base64: true })\n\t\t\t}\n\t\t})\n\t}\n\n\t/**\n\t * Create and export the .pptx file\n\t * @param {string} exportName - output file type\n\t * @param {Blob} blobContent - Blob content\n\t * @return {Promise<string>} Promise with file name\n\t */\n\tprivate writeFileToBrowser = (exportName: string, blobContent: Blob): Promise<string> => {\n\t\t// STEP 1: Create element\n\t\tlet eleLink = document.createElement('a')\n\t\teleLink.setAttribute('style', 'display:none;')\n\t\teleLink.dataset.interception = 'off' // @see https://docs.microsoft.com/en-us/sharepoint/dev/spfx/hyperlinking\n\t\tdocument.body.appendChild(eleLink)\n\n\t\t// STEP 2: Download file to browser\n\t\t// DESIGN: Use `createObjectURL()` (or MS-specific func for IE11) to D/L files in client browsers (FYI: synchronously executed)\n\t\tif (window.navigator.msSaveOrOpenBlob) {\n\t\t\t// @see https://docs.microsoft.com/en-us/microsoft-edge/dev-guide/html5/file-api/blob\n\t\t\tlet blob = new Blob([blobContent], { type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' })\n\t\t\teleLink.onclick = function () {\n\t\t\t\twindow.navigator.msSaveOrOpenBlob(blob, exportName)\n\t\t\t}\n\t\t\teleLink.click()\n\n\t\t\t// Clean-up\n\t\t\tdocument.body.removeChild(eleLink)\n\n\t\t\t// Done\n\t\t\treturn Promise.resolve(exportName)\n\t\t} else if (window.URL.createObjectURL) {\n\t\t\tlet url = window.URL.createObjectURL(new Blob([blobContent], { type: 'application/vnd.openxmlformats-officedocument.presentationml.presentation' }))\n\t\t\teleLink.href = url\n\t\t\teleLink.download = exportName\n\t\t\teleLink.click()\n\n\t\t\t// Clean-up (NOTE: Add a slight delay before removing to avoid 'blob:null' error in Firefox Issue#81)\n\t\t\tsetTimeout(() => {\n\t\t\t\twindow.URL.revokeObjectURL(url)\n\t\t\t\tdocument.body.removeChild(eleLink)\n\t\t\t}, 100)\n\n\t\t\t// Done\n\t\t\treturn Promise.resolve(exportName)\n\t\t}\n\t}\n\n\t/**\n\t * Create and export the .pptx file\n\t * @param {WRITE_OUTPUT_TYPE} outputType - output file type\n\t * @return {Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array>} Promise with data or stream (node) or filename (browser)\n\t */\n\tprivate exportPresentation = (outputType?: WRITE_OUTPUT_TYPE): Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array> => {\n\t\tlet arrChartPromises: Promise<string>[] = []\n\t\tlet arrMediaPromises: Promise<string>[] = []\n\t\tlet zip = new JSZip()\n\n\t\t// STEP 1: Read/Encode all Media before zip as base64 content, etc. is required\n\t\tthis.slides.forEach(slide => {\n\t\t\tarrMediaPromises = arrMediaPromises.concat(genMedia.encodeSlideMediaRels(slide))\n\t\t})\n\t\tthis.slideLayouts.forEach(layout => {\n\t\t\tarrMediaPromises = arrMediaPromises.concat(genMedia.encodeSlideMediaRels(layout))\n\t\t})\n\t\tarrMediaPromises = arrMediaPromises.concat(genMedia.encodeSlideMediaRels(this.masterSlide))\n\n\t\t// STEP 2: Wait for Promises (if any) then generate the PPTX file\n\t\treturn Promise.all(arrMediaPromises).then(() => {\n\t\t\t// A: Add empty placeholder objects to slides that don't already have them\n\t\t\tthis.slides.forEach(slide => {\n\t\t\t\tif (slide._slideLayout) genObj.addPlaceholdersToSlideLayouts(slide)\n\t\t\t})\n\n\t\t\t// B: Add all required folders and files\n\t\t\tzip.folder('_rels')\n\t\t\tzip.folder('docProps')\n\t\t\tzip.folder('ppt').folder('_rels')\n\t\t\tzip.folder('ppt/charts').folder('_rels')\n\t\t\tzip.folder('ppt/embeddings')\n\t\t\tzip.folder('ppt/media')\n\t\t\tzip.folder('ppt/slideLayouts').folder('_rels')\n\t\t\tzip.folder('ppt/slideMasters').folder('_rels')\n\t\t\tzip.folder('ppt/slides').folder('_rels')\n\t\t\tzip.folder('ppt/theme')\n\t\t\tzip.folder('ppt/notesMasters').folder('_rels')\n\t\t\tzip.folder('ppt/notesSlides').folder('_rels')\n\t\t\tzip.file('[Content_Types].xml', genXml.makeXmlContTypes(this.slides, this.slideLayouts, this.masterSlide)) // TODO: pass only `this` like below! 20200206\n\t\t\tzip.file('_rels/.rels', genXml.makeXmlRootRels())\n\t\t\tzip.file('docProps/app.xml', genXml.makeXmlApp(this.slides, this.company)) // TODO: pass only `this` like below! 20200206\n\t\t\tzip.file('docProps/core.xml', genXml.makeXmlCore(this.title, this.subject, this.author, this.revision)) // TODO: pass only `this` like below! 20200206\n\t\t\tzip.file('ppt/_rels/presentation.xml.rels', genXml.makeXmlPresentationRels(this.slides))\n\t\t\tzip.file('ppt/theme/theme1.xml', genXml.makeXmlTheme())\n\t\t\tzip.file('ppt/presentation.xml', genXml.makeXmlPresentation(this))\n\t\t\tzip.file('ppt/presProps.xml', genXml.makeXmlPresProps())\n\t\t\tzip.file('ppt/tableStyles.xml', genXml.makeXmlTableStyles())\n\t\t\tzip.file('ppt/viewProps.xml', genXml.makeXmlViewProps())\n\n\t\t\t// C: Create a Layout/Master/Rel/Slide file for each SlideLayout and Slide\n\t\t\tthis.slideLayouts.forEach((layout, idx) => {\n\t\t\t\tzip.file('ppt/slideLayouts/slideLayout' + (idx + 1) + '.xml', genXml.makeXmlLayout(layout))\n\t\t\t\tzip.file('ppt/slideLayouts/_rels/slideLayout' + (idx + 1) + '.xml.rels', genXml.makeXmlSlideLayoutRel(idx + 1, this.slideLayouts))\n\t\t\t})\n\t\t\tthis.slides.forEach((slide, idx) => {\n\t\t\t\tzip.file('ppt/slides/slide' + (idx + 1) + '.xml', genXml.makeXmlSlide(slide))\n\t\t\t\tzip.file('ppt/slides/_rels/slide' + (idx + 1) + '.xml.rels', genXml.makeXmlSlideRel(this.slides, this.slideLayouts, idx + 1))\n\t\t\t\t// Create all slide notes related items. Notes of empty strings are created for slides which do not have notes specified, to keep track of _rels.\n\t\t\t\tzip.file('ppt/notesSlides/notesSlide' + (idx + 1) + '.xml', genXml.makeXmlNotesSlide(slide))\n\t\t\t\tzip.file('ppt/notesSlides/_rels/notesSlide' + (idx + 1) + '.xml.rels', genXml.makeXmlNotesSlideRel(idx + 1))\n\t\t\t})\n\t\t\tzip.file('ppt/slideMasters/slideMaster1.xml', genXml.makeXmlMaster(this.masterSlide, this.slideLayouts))\n\t\t\tzip.file('ppt/slideMasters/_rels/slideMaster1.xml.rels', genXml.makeXmlMasterRel(this.masterSlide, this.slideLayouts))\n\t\t\tzip.file('ppt/notesMasters/notesMaster1.xml', genXml.makeXmlNotesMaster())\n\t\t\tzip.file('ppt/notesMasters/_rels/notesMaster1.xml.rels', genXml.makeXmlNotesMasterRel())\n\n\t\t\t// D: Create all Rels (images, media, chart data)\n\t\t\tthis.slideLayouts.forEach(layout => {\n\t\t\t\tthis.createChartMediaRels(layout, zip, arrChartPromises)\n\t\t\t})\n\t\t\tthis.slides.forEach(slide => {\n\t\t\t\tthis.createChartMediaRels(slide, zip, arrChartPromises)\n\t\t\t})\n\t\t\tthis.createChartMediaRels(this.masterSlide, zip, arrChartPromises)\n\n\t\t\t// E: Wait for Promises (if any) then generate the PPTX file\n\t\t\treturn Promise.all(arrChartPromises).then(() => {\n\t\t\t\tif (outputType === 'STREAM') {\n\t\t\t\t\t// A: stream file\n\t\t\t\t\treturn zip.generateAsync({ type: 'nodebuffer' })\n\t\t\t\t} else if (outputType) {\n\t\t\t\t\t// B: Node [fs]: Output type user option or default\n\t\t\t\t\treturn zip.generateAsync({ type: outputType })\n\t\t\t\t} else {\n\t\t\t\t\t// C: Browser: Output blob as app/ms-pptx\n\t\t\t\t\treturn zip.generateAsync({ type: 'blob' })\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\t}\n\n\t// EXPORT METHODS\n\n\t/**\n\t * Export the current Presentation to stream\n\t * @returns {Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array>} file stream\n\t */\n\tstream(): Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array> {\n\t\treturn this.exportPresentation('STREAM')\n\t}\n\n\t/**\n\t * Export the current Presentation as JSZip content with the selected type\n\t * @param {JSZIP_OUTPUT_TYPE} outputType - 'arraybuffer' | 'base64' | 'binarystring' | 'blob' | 'nodebuffer' | 'uint8array'\n\t * @returns {Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array>} file content in selected type\n\t */\n\twrite(outputType: JSZIP_OUTPUT_TYPE): Promise<string | ArrayBuffer | Blob | Buffer | Uint8Array> {\n\t\treturn this.exportPresentation(outputType)\n\t}\n\n\t/**\n\t * Export the current Presentation. Writes file to local file system if `fs` exists, otherwise, initiates download in browsers\n\t * @param {string} exportName - file name\n\t * @returns {Promise<string>} the presentation name\n\t */\n\twriteFile(exportName?: string): Promise<string> {\n\t\tconst fs = typeof require !== 'undefined' && typeof window === 'undefined' ? require('fs') : null // NodeJS\n\t\tlet fileName = exportName ? (exportName.toString().toLowerCase().endsWith('.pptx') ? exportName : exportName + '.pptx') : 'Presentation.pptx'\n\n\t\treturn this.exportPresentation(fs ? 'nodebuffer' : null).then(content => {\n\t\t\tif (fs) {\n\t\t\t\t// Node: Output\n\t\t\t\treturn new Promise<string>((resolve, reject) => {\n\t\t\t\t\tfs.writeFile(fileName, content, err => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treject(err)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(fileName)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\t// Browser: Output blob as app/ms-pptx\n\t\t\t\treturn this.writeFileToBrowser(fileName, content as Blob)\n\t\t\t}\n\t\t})\n\t}\n\n\t// PRESENTATION METHODS\n\n\t/**\n\t * Add a new Section to Presentation\n\t * @param {ISectionProps} section - section properties\n\t * @example pptx.addSection({ title:'Charts' });\n\t */\n\taddSection(section: SectionProps) {\n\t\tif (!section) console.warn('addSection requires an argument')\n\t\telse if (!section.title) console.warn('addSection requires a title')\n\n\t\tlet newSection: SectionProps = {\n\t\t\t_type: 'user',\n\t\t\t_slides: [],\n\t\t\ttitle: section.title,\n\t\t}\n\n\t\tif (section.order) this.sections.splice(section.order, 0, newSection)\n\t\telse this._sections.push(newSection)\n\t}\n\n\t/**\n\t * Add a new Slide to Presentation\n\t * @param {AddSlideProps} options - slide options\n\t * @returns {PresSlide} the new Slide\n\t */\n\taddSlide(options?: AddSlideProps): PresSlide {\n\t\t// TODO: DEPRECATED: arg0 string \"masterSlideName\" dep as of 3.2.0\n\t\tlet masterSlideName = typeof options === 'string' ? options : options && options.masterName ? options.masterName : ''\n\t\tlet slideLayout: SlideLayout = {\n\t\t\t_name: this.LAYOUTS[DEF_PRES_LAYOUT].name,\n\t\t\t_presLayout : this.presLayout,\n\t\t\t_rels: [],\n\t\t\t_relsChart: [],\n\t\t\t_relsMedia: [],\n\t\t\t_slideNum: this.slides.length + 1,\n\t\t}\n\n\t\tif (masterSlideName) {\n\t\t\tlet tmpLayout = this.slideLayouts.filter(layout => layout._name === masterSlideName)[0]\n\t\t\tif (tmpLayout) slideLayout = tmpLayout\n\t\t}\n\n\t\tlet newSlide = new Slide({\n\t\t\taddSlide: this.addNewSlide,\n\t\t\tgetSlide: this.getSlide,\n\t\t\tpresLayout: this.presLayout,\n\t\t\tsetSlideNum: this.setSlideNumber,\n\t\t\tslideId: this.slides.length + 256,\n\t\t\tslideRId: this.slides.length + 2,\n\t\t\tslideNumber: this.slides.length + 1,\n\t\t\tslideLayout: slideLayout\n\t\t})\n\n\t\t// A: Add slide to pres\n\t\tthis._slides.push(newSlide)\n\n\t\t// B: Sections\n\t\t// B-1: Add slide to section (if any provided)\n\t\tif (options && options.sectionTitle) {\n\t\t\tlet sect = this.sections.filter(section => section.title === options.sectionTitle)[0]\n\t\t\tif (!sect) console.warn(`addSlide: unable to find section with title: \"${options.sectionTitle}\"`)\n\t\t\telse sect._slides.push(newSlide)\n\t\t}\n\t\t// B-2: Handle slides without a section when sections are already is use (\"loose\" slides arent allowed, they all need a section)\n\t\telse if (this.sections && this.sections.length > 0 && (!options || !options.sectionTitle)) {\n\t\t\tlet lastSect = this._sections[this.sections.length - 1]\n\n\t\t\t// CASE 1: The latest section is a default type - just add this one\n\t\t\tif (lastSect._type === 'default') lastSect._slides.push(newSlide)\n\t\t\t// CASE 2: There latest section is NOT a default type - create the defualt, add this slide\n\t\t\telse\n\t\t\t\tthis._sections.push({\n\t\t\t\t\ttitle: `Default-${this.sections.filter(sect => sect._type === 'default').length + 1}`,\n\t\t\t\t\t_type: 'default',\n\t\t\t\t\t_slides: [newSlide],\n\t\t\t\t})\n\t\t}\n\n\t\treturn newSlide\n\t}\n\n\t/**\n\t * Create a custom Slide Layout in any size\n\t * @param {PresLayout} layout - layout properties\n\t * @example pptx.defineLayout({ name:'A3', width:16.5, height:11.7 });\n\t */\n\tdefineLayout(layout: PresLayout) {\n\t\t// @see https://support.office.com/en-us/article/Change-the-size-of-your-slides-040a811c-be43-40b9-8d04-0de5ed79987e\n\t\tif (!layout) console.warn('defineLayout requires `{name, width, height}`')\n\t\telse if (!layout.name) console.warn('defineLayout requires `name`')\n\t\telse if (!layout.width) console.warn('defineLayout requires `width`')\n\t\telse if (!layout.height) console.warn('defineLayout requires `height`')\n\t\telse if (typeof layout.height !== 'number') console.warn('defineLayout `height` should be a number (inches)')\n\t\telse if (typeof layout.width !== 'number') console.warn('defineLayout `width` should be a number (inches)')\n\n\t\tthis.LAYOUTS[layout.name] = {\n\t\t\tname: layout.name,\n\t\t\t_sizeW: Math.round(Number(layout.width) * EMU),\n\t\t\t_sizeH: Math.round(Number(layout.height) * EMU),\n\t\t\twidth: Math.round(Number(layout.width) * EMU),\n\t\t\theight: Math.round(Number(layout.height) * EMU),\n\t\t}\n\t}\n\n\t/**\n\t * Create a new slide master [layout] for the Presentation\n\t * @param {SlideMasterProps} props - layout properties\n\t */\n\tdefineSlideMaster(props: SlideMasterProps) {\n\t\tif (!props.title) throw Error('defineSlideMaster() object argument requires a `title` value. (https://gitbrent.github.io/PptxGenJS/docs/masters.html)')\n\n\t\tlet newLayout: SlideLayout = {\n\t\t\t_margin: props.margin || DEF_SLIDE_MARGIN_IN,\n\t\t\t_name: props.title,\n\t\t\t_presLayout: this.presLayout,\n\t\t\t_rels: [],\n\t\t\t_relsChart: [],\n\t\t\t_relsMedia: [],\n\t\t\t_slide: null,\n\t\t\t_slideNum: 1000 + this.slideLayouts.length + 1,\n\t\t\t_slideNumberProps: props.slideNumber || null,\n\t\t\t_slideObjects: [],\n\t\t}\n\n\t\t// DEPRECATED:\n\t\tif (props.bkgd && !props.background) {\n\t\t\tprops.background = {}\n\t\t\tif (typeof props.bkgd === 'string') props.background.fill = props.bkgd\n\t\t\telse {\n\t\t\t\tif (props.bkgd.data) props.background.data = props.bkgd.data\n\t\t\t\tif (props.bkgd.path) props.background.path = props.bkgd.path\n\t\t\t\tif (props.bkgd['src']) props.background.path = props.bkgd['src'] // @deprecated (drop in 4.x)\n\t\t\t}\n\t\t\tdelete props.bkgd\n\t\t}\n\n\t\t// STEP 1: Create the Slide Master/Layout\n\t\tgenObj.createSlideObject(props, newLayout)\n\n\t\t// STEP 2: Add it to layout defs\n\t\tthis.slideLayouts.push(newLayout)\n\n\t\t// STEP 3: Add slideNumber to master slide (if any)\n\t\tif (newLayout._slideNumberProps && !this.masterSlide._slideNumberProps) this.masterSlide._slideNumberProps = newLayout._slideNumberProps\n\t}\n\n\t// HTML-TO-SLIDES METHODS\n\n\t/**\n\t * Reproduces an HTML table as a PowerPoint table - including column widths, style, etc. - creates 1 or more slides as needed\n\t * @param {string} eleId - table HTML element ID\n\t * @param {TableToSlidesProps} options - generation options\n\t */\n\ttableToSlides(eleId: string, options: TableToSlidesProps = {}) {\n\t\t// @note `verbose` option is undocumented; used for verbose output of layout process\n\t\tgenTable.genTableToSlides(\n\t\t\tthis,\n\t\t\teleId,\n\t\t\toptions,\n\t\t\toptions && options.masterSlideName ? this.slideLayouts.filter(layout => layout._name === options.masterSlideName)[0] : null\n\t\t)\n\t}\n}\n"],"names":["genObj.addBackgroundDefinition","genObj.addChartDefinition","genObj.addImageDefinition","genObj.addMediaDefinition","genObj.addNotesDefinition","genObj.addShapeDefinition","genObj.addTableDefinition","genObj.addTextDefinition","genCharts.createExcelWorksheet","genMedia.encodeSlideMediaRels","genObj.addPlaceholdersToSlideLayouts","genXml.makeXmlContTypes","genXml.makeXmlRootRels","genXml.makeXmlApp","genXml.makeXmlCore","genXml.makeXmlPresentationRels","genXml.makeXmlTheme","genXml.makeXmlPresentation","genXml.makeXmlPresProps","genXml.makeXmlTableStyles","genXml.makeXmlViewProps","genXml.makeXmlLayout","genXml.makeXmlSlideLayoutRel","genXml.makeXmlSlide","genXml.makeXmlSlideRel","genXml.makeXmlNotesSlide","genXml.makeXmlNotesSlideRel","genXml.makeXmlMaster","genXml.makeXmlMasterRel","genXml.makeXmlNotesMaster","genXml.makeXmlNotesMasterRel","genObj.createSlideObject","genTable.genTableToSlides"],"mappings":"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"}